<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Appendix C — Cate S. – Analysis of the 2025 WNBA Season</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../wa/wa-member2.html" rel="next">
<link href="../appx/case-study.html" rel="prev">
<script src="../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-b53751a350365c71b6c909e95f209ed1.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-463f7e572b85bff0cfe833e89a202fa4.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-2b27489b1280a247593da265a4955406.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"implied",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary","functionality","tracking","targeting"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  ,
"language":"en"
  });
});
</script> 
  
<style>html{ scroll-behavior: smooth; }</style>
<script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">


<link rel="stylesheet" href="../style/custom.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../appx/proposal.html">Appendices</a></li><li class="breadcrumb-item"><a href="../wa/wa-member1.html"><span class="chapter-title">Cate S.</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../assets/wnba_logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Data Science Ballers</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Performance Analysis of the 2025 WNBA Season</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">EDA</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../eda/eda-member1.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Cate S.</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../eda/eda-member2.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Karyna S.</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appx/proposal.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Proposal</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appx/case-study.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Case Study</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../wa/wa-member1.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Cate S.</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../wa/wa-member2.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Karyna S.</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#player-dataset" id="toc-player-dataset" class="nav-link active" data-scroll-target="#player-dataset">Player Dataset</a></li>
  <li><a href="#team-dataset" id="toc-team-dataset" class="nav-link" data-scroll-target="#team-dataset">Team Dataset</a></li>
  <li><a href="#play-by-play-dataset" id="toc-play-by-play-dataset" class="nav-link" data-scroll-target="#play-by-play-dataset">Play-By-Play Dataset</a></li>
  <li><a href="#salary-data" id="toc-salary-data" class="nav-link" data-scroll-target="#salary-data">Salary Data</a></li>
  <li><a href="#machine-learning" id="toc-machine-learning" class="nav-link" data-scroll-target="#machine-learning">Machine Learning</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../appx/proposal.html">Appendices</a></li><li class="breadcrumb-item"><a href="../wa/wa-member1.html"><span class="chapter-title">Cate S.</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Appendix C — Cate S.</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header>


<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(wehoop)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">library</span>(glmnet)</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="fu">tidymodels_prefer</span>()</span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="fu">library</span>(robotstxt)</span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="fu">library</span>(rvest)</span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="fu">library</span>(rpart)</span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="fu">library</span>(rpart.plot)</span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="fu">library</span>(gt)</span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-18"><a href="#cb1-18"></a></span>
<span id="cb1-19"><a href="#cb1-19"></a>wnba_pbp <span class="ot">&lt;-</span> wehoop<span class="sc">::</span><span class="fu">load_wnba_pbp</span>()</span>
<span id="cb1-20"><a href="#cb1-20"></a>wnba_team_box <span class="ot">&lt;-</span> wehoop<span class="sc">::</span><span class="fu">load_wnba_team_box</span>()</span>
<span id="cb1-21"><a href="#cb1-21"></a>wnba_player_box <span class="ot">&lt;-</span> wehoop<span class="sc">::</span><span class="fu">load_wnba_player_box</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="player-dataset" class="level3">
<h3 class="anchored" data-anchor-id="player-dataset">Player Dataset</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># get dimensions</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="fu">dim</span>(wnba_player_box)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7140   57</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># find the league's best players</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>top_players <span class="ot">&lt;-</span> wnba_player_box <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3"></a>  <span class="fu">filter</span>(game_id <span class="sc">!=</span> <span class="dv">401781604</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>  <span class="fu">group_by</span>(athlete_display_name, team_name) <span class="sc">%&gt;%</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>  <span class="fu">summarize</span>(</span>
<span id="cb4-6"><a href="#cb4-6"></a>    <span class="at">avg_ppg =</span> <span class="fu">mean</span>(points, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-7"><a href="#cb4-7"></a>    <span class="at">avg_blocks =</span> <span class="fu">mean</span>(blocks, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-8"><a href="#cb4-8"></a>    <span class="at">avg_rebounds =</span> <span class="fu">mean</span>((offensive_rebounds <span class="sc">+</span> defensive_rebounds), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-9"><a href="#cb4-9"></a>    <span class="at">avg_assists =</span> <span class="fu">mean</span>(assists, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-10"><a href="#cb4-10"></a>    <span class="at">avg_steals =</span> <span class="fu">mean</span>(steals, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-11"><a href="#cb4-11"></a>    )</span>
<span id="cb4-12"><a href="#cb4-12"></a></span>
<span id="cb4-13"><a href="#cb4-13"></a>top_players <span class="sc">%&gt;%</span></span>
<span id="cb4-14"><a href="#cb4-14"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(avg_ppg)) <span class="sc">%&gt;%</span></span>
<span id="cb4-15"><a href="#cb4-15"></a>  <span class="fu">head</span>(<span class="dv">10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 7
# Groups:   athlete_display_name [10]
   athlete_display_name team_name avg_ppg avg_blocks avg_rebounds avg_assists
   &lt;chr&gt;                &lt;chr&gt;       &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
 1 A'ja Wilson          Aces         24.2     2.35          10.1         3.12
 2 Napheesa Collier     Lynx         22.3     1.44           7.28        3.08
 3 Kelsey Mitchell      Fever        20.4     0.170          1.70        3.34
 4 Kelsey Plum          Sparks       19.5     0.0930         3.07        5.74
 5 Paige Bueckers       Wings        19.2     0.5            3.94        5.39
 6 Dearica Hamby        Sparks       18.4     0.477          7.93        3.27
 7 Allisha Gray         Dream        18.2     0.378          5.51        3.42
 8 Breanna Stewart      Liberty      18.2     1.32           6.47        3.44
 9 Nneka Ogwumike       Storm        18.2     0.383          7.15        2.28
10 Sabrina Ionescu      Liberty      18.0     0.463          4.90        5.61
# ℹ 1 more variable: avg_steals &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>game_totals <span class="ot">&lt;-</span> wnba_team_box <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>  <span class="fu">filter</span>(game_id <span class="sc">!=</span> <span class="dv">401781604</span>)<span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>  <span class="fu">group_by</span>(game_id) <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4"></a>  <span class="fu">summarize</span>(</span>
<span id="cb6-5"><a href="#cb6-5"></a>    <span class="at">total_points =</span> <span class="fu">sum</span>(team_score),</span>
<span id="cb6-6"><a href="#cb6-6"></a>    <span class="at">total_field_goals_made =</span> <span class="fu">sum</span>(field_goals_made),</span>
<span id="cb6-7"><a href="#cb6-7"></a>    <span class="at">total_free_throws_made =</span> <span class="fu">sum</span>(free_throws_made),</span>
<span id="cb6-8"><a href="#cb6-8"></a>    <span class="at">total_field_goals_attempted =</span> <span class="fu">sum</span>(field_goals_attempted),</span>
<span id="cb6-9"><a href="#cb6-9"></a>    <span class="at">total_free_throws_attempted =</span> <span class="fu">sum</span>(free_throws_attempted),</span>
<span id="cb6-10"><a href="#cb6-10"></a>    <span class="at">total_defensive_rebounds =</span> <span class="fu">sum</span>(defensive_rebounds),</span>
<span id="cb6-11"><a href="#cb6-11"></a>    <span class="at">total_offensive_rebounds =</span> <span class="fu">sum</span>(offensive_rebounds),</span>
<span id="cb6-12"><a href="#cb6-12"></a>    <span class="at">total_assists =</span> <span class="fu">sum</span>(assists),</span>
<span id="cb6-13"><a href="#cb6-13"></a>    <span class="at">total_steals =</span> <span class="fu">sum</span>(steals),</span>
<span id="cb6-14"><a href="#cb6-14"></a>    <span class="at">total_blocks =</span> <span class="fu">sum</span>(blocks),</span>
<span id="cb6-15"><a href="#cb6-15"></a>    <span class="at">total_fouls =</span> <span class="fu">sum</span>(fouls),</span>
<span id="cb6-16"><a href="#cb6-16"></a>    <span class="at">total_turnovers =</span> <span class="fu">sum</span>(turnovers)</span>
<span id="cb6-17"><a href="#cb6-17"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb6-18"><a href="#cb6-18"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb6-19"><a href="#cb6-19"></a></span>
<span id="cb6-20"><a href="#cb6-20"></a>player_game_totals <span class="ot">&lt;-</span> wnba_player_box <span class="sc">%&gt;%</span></span>
<span id="cb6-21"><a href="#cb6-21"></a>  <span class="fu">full_join</span>(game_totals, <span class="at">by =</span> <span class="st">"game_id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-22"><a href="#cb6-22"></a>  <span class="fu">select</span>(<span class="st">"game_id"</span>, <span class="st">"game_date"</span>, <span class="st">"athlete_id"</span>, <span class="st">"athlete_display_name"</span>, <span class="st">"team_id"</span>, <span class="st">"team_name"</span>, <span class="st">"points"</span>, <span class="st">"field_goals_made"</span>, <span class="st">"free_throws_made"</span>, <span class="st">"field_goals_attempted"</span>, <span class="st">"free_throws_attempted"</span>, <span class="st">"defensive_rebounds"</span>, <span class="st">"offensive_rebounds"</span>, <span class="st">"assists"</span>, <span class="st">"steals"</span>, <span class="st">"blocks"</span>, <span class="st">"fouls"</span>, <span class="st">"turnovers"</span>, <span class="st">"total_points"</span>, <span class="st">"total_field_goals_made"</span>, <span class="st">"total_free_throws_made"</span>, <span class="st">"total_field_goals_attempted"</span>, <span class="st">"total_free_throws_attempted"</span>, <span class="st">"total_defensive_rebounds"</span>, <span class="st">"total_offensive_rebounds"</span>, <span class="st">"total_assists"</span>, <span class="st">"total_steals"</span>, <span class="st">"total_blocks"</span>, <span class="st">"total_fouls"</span>, <span class="st">"total_turnovers"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-23"><a href="#cb6-23"></a>  <span class="fu">group_by</span>(game_id, game_date, athlete_id, athlete_display_name, team_id, team_name) <span class="sc">%&gt;%</span></span>
<span id="cb6-24"><a href="#cb6-24"></a>  <span class="fu">summarize</span>(<span class="at">player_PIE =</span> ((points <span class="sc">+</span> field_goals_made <span class="sc">+</span> free_throws_made <span class="sc">-</span> field_goals_attempted <span class="sc">-</span> free_throws_attempted <span class="sc">+</span> defensive_rebounds <span class="sc">+</span> (offensive_rebounds<span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span> assists <span class="sc">+</span> steals <span class="sc">+</span> (blocks<span class="sc">/</span><span class="dv">2</span>) <span class="sc">-</span> fouls <span class="sc">-</span> turnovers) <span class="sc">/</span> (total_points <span class="sc">+</span> total_field_goals_made <span class="sc">+</span> total_free_throws_made <span class="sc">-</span> total_field_goals_attempted <span class="sc">-</span> total_free_throws_attempted <span class="sc">+</span> total_defensive_rebounds <span class="sc">+</span> (total_offensive_rebounds<span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span> total_assists <span class="sc">+</span> total_steals <span class="sc">+</span> (total_blocks<span class="sc">/</span><span class="dv">2</span>) <span class="sc">-</span> total_fouls <span class="sc">-</span> total_turnovers)) <span class="sc">*</span> <span class="dv">100</span>) </span>
<span id="cb6-25"><a href="#cb6-25"></a></span>
<span id="cb6-26"><a href="#cb6-26"></a>top10_pie <span class="ot">&lt;-</span> player_game_totals <span class="sc">%&gt;%</span></span>
<span id="cb6-27"><a href="#cb6-27"></a>  <span class="fu">group_by</span>(athlete_display_name, team_name) <span class="sc">%&gt;%</span></span>
<span id="cb6-28"><a href="#cb6-28"></a>  <span class="fu">summarize</span>(<span class="at">avg_PIE =</span> <span class="fu">mean</span>(player_PIE, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-29"><a href="#cb6-29"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(avg_PIE)) <span class="sc">%&gt;%</span></span>
<span id="cb6-30"><a href="#cb6-30"></a>  <span class="fu">head</span>(<span class="dv">10</span>) </span>
<span id="cb6-31"><a href="#cb6-31"></a></span>
<span id="cb6-32"><a href="#cb6-32"></a>top10_pie <span class="sc">%&gt;%</span></span>
<span id="cb6-33"><a href="#cb6-33"></a>  <span class="fu">kable</span>(</span>
<span id="cb6-34"><a href="#cb6-34"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Player"</span>, <span class="st">"Team"</span>, <span class="st">"PIE"</span>),</span>
<span id="cb6-35"><a href="#cb6-35"></a>    <span class="at">align =</span> <span class="st">"lll"</span></span>
<span id="cb6-36"><a href="#cb6-36"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb6-37"><a href="#cb6-37"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Player</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Team</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">PIE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">A'ja Wilson</td>
<td style="text-align: left;">Aces</td>
<td style="text-align: left;">17.71041</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alyssa Thomas</td>
<td style="text-align: left;">Mercury</td>
<td style="text-align: left;">15.58577</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Napheesa Collier</td>
<td style="text-align: left;">Lynx</td>
<td style="text-align: left;">15.01744</td>
</tr>
<tr class="even">
<td style="text-align: left;">Breanna Stewart</td>
<td style="text-align: left;">Liberty</td>
<td style="text-align: left;">12.69479</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Nneka Ogwumike</td>
<td style="text-align: left;">Storm</td>
<td style="text-align: left;">12.19748</td>
</tr>
<tr class="even">
<td style="text-align: left;">Aliyah Boston</td>
<td style="text-align: left;">Fever</td>
<td style="text-align: left;">12.05483</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Paige Bueckers</td>
<td style="text-align: left;">Wings</td>
<td style="text-align: left;">11.90871</td>
</tr>
<tr class="even">
<td style="text-align: left;">Angel Reese</td>
<td style="text-align: left;">Sky</td>
<td style="text-align: left;">11.55406</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dearica Hamby</td>
<td style="text-align: left;">Sparks</td>
<td style="text-align: left;">11.44762</td>
</tr>
<tr class="even">
<td style="text-align: left;">Jackie Young</td>
<td style="text-align: left;">Aces</td>
<td style="text-align: left;">11.29745</td>
</tr>
</tbody>
</table>


</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>player_game_totals <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="fu">filter</span>(athlete_id<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">"3149391"</span>, <span class="st">"2529140"</span>, <span class="st">"3917450"</span>, <span class="st">"2998928"</span>, <span class="st">"1068"</span>, <span class="st">"4432831"</span>, <span class="st">"4433730"</span>, <span class="st">"4433402"</span>,</span>
<span id="cb7-3"><a href="#cb7-3"></a>    <span class="st">"2566106"</span>, <span class="st">"4065870"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> game_date, <span class="at">y =</span> player_PIE, <span class="at">color =</span> athlete_display_name)) <span class="sc">+</span> <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="wa-member1_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="team-dataset" class="level3">
<h3 class="anchored" data-anchor-id="team-dataset">Team Dataset</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># get dimensions</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="fu">dim</span>(wnba_team_box)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 624  57</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># determine records for each team</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>wnba_team_records <span class="ot">&lt;-</span> wnba_team_box <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>  <span class="fu">filter</span>(team_name <span class="sc">!=</span> <span class="st">"TEAM CLARK"</span>, team_name <span class="sc">!=</span> <span class="st">"TEAM COLLIER"</span>) <span class="sc">%&gt;%</span> <span class="co"># remove All Star teams</span></span>
<span id="cb10-4"><a href="#cb10-4"></a>  <span class="fu">mutate</span>(</span>
<span id="cb10-5"><a href="#cb10-5"></a>    <span class="at">win =</span> <span class="fu">ifelse</span>(team_winner <span class="sc">==</span> <span class="cn">TRUE</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb10-6"><a href="#cb10-6"></a>    <span class="at">loss =</span> <span class="fu">ifelse</span>(team_winner <span class="sc">==</span> <span class="cn">FALSE</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb10-7"><a href="#cb10-7"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb10-8"><a href="#cb10-8"></a>  <span class="fu">group_by</span>(team_name) <span class="sc">%&gt;%</span></span>
<span id="cb10-9"><a href="#cb10-9"></a>  <span class="fu">arrange</span>(team_name, game_date) <span class="sc">%&gt;%</span> </span>
<span id="cb10-10"><a href="#cb10-10"></a>  <span class="fu">mutate</span>(</span>
<span id="cb10-11"><a href="#cb10-11"></a>    <span class="at">cumulative_wins =</span> <span class="fu">cumsum</span>(win),</span>
<span id="cb10-12"><a href="#cb10-12"></a>    <span class="at">cumulative_losses =</span> <span class="fu">cumsum</span>(loss),</span>
<span id="cb10-13"><a href="#cb10-13"></a>    <span class="at">record =</span> <span class="fu">paste0</span>(cumulative_wins, <span class="st">"-"</span>, cumulative_losses),</span>
<span id="cb10-14"><a href="#cb10-14"></a>    <span class="at">win_pct =</span> cumulative_wins<span class="sc">/</span>(cumulative_wins <span class="sc">+</span> cumulative_losses)</span>
<span id="cb10-15"><a href="#cb10-15"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb10-16"><a href="#cb10-16"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb10-17"><a href="#cb10-17"></a>  <span class="fu">mutate</span>(<span class="at">team_color =</span> <span class="fu">paste0</span>(<span class="st">"#"</span>, team_color))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>team_colors <span class="ot">&lt;-</span> wnba_team_box <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>  <span class="fu">distinct</span>(team_name, team_color) <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3"></a>  <span class="fu">mutate</span>(<span class="at">team_color =</span> <span class="fu">paste0</span>(<span class="st">"#"</span>, team_color)) <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4"></a>  <span class="fu">deframe</span>()</span>
<span id="cb11-5"><a href="#cb11-5"></a></span>
<span id="cb11-6"><a href="#cb11-6"></a>df_labels <span class="ot">&lt;-</span> wnba_team_records <span class="sc">%&gt;%</span></span>
<span id="cb11-7"><a href="#cb11-7"></a>  <span class="fu">group_by</span>(team_name) <span class="sc">%&gt;%</span></span>
<span id="cb11-8"><a href="#cb11-8"></a>  <span class="fu">filter</span>(game_date <span class="sc">==</span> <span class="fu">max</span>(game_date)) <span class="sc">%&gt;%</span></span>
<span id="cb11-9"><a href="#cb11-9"></a>  <span class="fu">ungroup</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># visualize records</span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="fu">ggplot</span>(wnba_team_records, <span class="fu">aes</span>(<span class="at">x =</span> game_date, <span class="at">y =</span> cumulative_wins, </span>
<span id="cb12-3"><a href="#cb12-3"></a>  <span class="at">group =</span> team_name, <span class="at">color =</span> team_color)) <span class="sc">+</span></span>
<span id="cb12-4"><a href="#cb12-4"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb12-5"><a href="#cb12-5"></a>  <span class="fu">scale_color_identity</span>() <span class="sc">+</span> </span>
<span id="cb12-6"><a href="#cb12-6"></a>  <span class="fu">geom_text_repel</span>(</span>
<span id="cb12-7"><a href="#cb12-7"></a>    <span class="at">data =</span> df_labels,</span>
<span id="cb12-8"><a href="#cb12-8"></a>    <span class="fu">aes</span>(<span class="at">label =</span> team_name),</span>
<span id="cb12-9"><a href="#cb12-9"></a>    <span class="at">nudge_x =</span> <span class="dv">3</span>, </span>
<span id="cb12-10"><a href="#cb12-10"></a>    <span class="at">hjust =</span> <span class="dv">0</span>,</span>
<span id="cb12-11"><a href="#cb12-11"></a>    <span class="at">direction =</span> <span class="st">"y"</span>,</span>
<span id="cb12-12"><a href="#cb12-12"></a>    <span class="at">segment.color =</span> <span class="cn">NA</span>, </span>
<span id="cb12-13"><a href="#cb12-13"></a>    <span class="at">size =</span> <span class="fl">3.5</span>,</span>
<span id="cb12-14"><a href="#cb12-14"></a>    <span class="at">fontface =</span> <span class="st">"bold"</span></span>
<span id="cb12-15"><a href="#cb12-15"></a>  ) <span class="sc">+</span></span>
<span id="cb12-16"><a href="#cb12-16"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb12-17"><a href="#cb12-17"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="fu">max</span>(wnba_team_records<span class="sc">$</span>game_date) <span class="sc">+</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb12-18"><a href="#cb12-18"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb12-19"><a href="#cb12-19"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">as.Date</span>(<span class="st">"2025-09-11"</span>), </span>
<span id="cb12-20"><a href="#cb12-20"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"darkgrey"</span>) <span class="sc">+</span></span>
<span id="cb12-21"><a href="#cb12-21"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"cumulative wins"</span>) <span class="sc">+</span></span>
<span id="cb12-22"><a href="#cb12-22"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">as.Date</span>(<span class="st">"2025-09-9"</span>), <span class="at">y =</span> <span class="dv">38</span>, </span>
<span id="cb12-23"><a href="#cb12-23"></a>    <span class="at">label =</span> <span class="fu">str_wrap</span>(<span class="st">"End of Regular Season"</span>, <span class="dv">15</span>), <span class="at">color =</span> <span class="st">"grey40"</span>, </span>
<span id="cb12-24"><a href="#cb12-24"></a>    <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="wa-member1_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># determine teams with the best avg shot percentages</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>shot_percentages <span class="ot">&lt;-</span> wnba_team_records <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3"></a>  <span class="fu">select</span>(field_goal_pct, free_throw_pct, three_point_field_goal_pct, team_name) <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4"></a>  <span class="fu">group_by</span>(team_name) <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5"></a>  <span class="fu">summarise</span>(</span>
<span id="cb13-6"><a href="#cb13-6"></a>    <span class="at">avg_field_goal =</span> <span class="fu">mean</span>(field_goal_pct),</span>
<span id="cb13-7"><a href="#cb13-7"></a>    <span class="at">avg_free_throw =</span> <span class="fu">mean</span>(free_throw_pct),</span>
<span id="cb13-8"><a href="#cb13-8"></a>    <span class="at">avg_three =</span> <span class="fu">mean</span>(three_point_field_goal_pct),</span>
<span id="cb13-9"><a href="#cb13-9"></a>  )</span>
<span id="cb13-10"><a href="#cb13-10"></a></span>
<span id="cb13-11"><a href="#cb13-11"></a>shot_percentages <span class="sc">%&gt;%</span></span>
<span id="cb13-12"><a href="#cb13-12"></a>  <span class="fu">select</span>(team_name, avg_field_goal) <span class="sc">%&gt;%</span></span>
<span id="cb13-13"><a href="#cb13-13"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(avg_field_goal)) <span class="sc">%&gt;%</span></span>
<span id="cb13-14"><a href="#cb13-14"></a>  <span class="fu">slice</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  team_name avg_field_goal
  &lt;chr&gt;              &lt;dbl&gt;
1 Lynx                46.8</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>shot_percentages <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>  <span class="fu">select</span>(team_name, avg_free_throw) <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(avg_free_throw)) <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4"></a>  <span class="fu">slice</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  team_name avg_free_throw
  &lt;chr&gt;              &lt;dbl&gt;
1 Liberty             82.5</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>shot_percentages <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>  <span class="fu">select</span>(team_name, avg_three) <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(avg_three)) <span class="sc">%&gt;%</span></span>
<span id="cb17-4"><a href="#cb17-4"></a>  <span class="fu">slice</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  team_name avg_three
  &lt;chr&gt;         &lt;dbl&gt;
1 Lynx           36.7</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># determine game margins for different performance stats</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>margins <span class="ot">&lt;-</span> wnba_team_records <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3"></a>  <span class="fu">group_by</span>(game_id) <span class="sc">%&gt;%</span></span>
<span id="cb19-4"><a href="#cb19-4"></a>  <span class="fu">mutate</span>(</span>
<span id="cb19-5"><a href="#cb19-5"></a>    <span class="at">field_margin =</span> field_goals_made <span class="sc">-</span> <span class="fu">rev</span>(field_goals_made),</span>
<span id="cb19-6"><a href="#cb19-6"></a>    <span class="at">free_margin =</span> free_throws_made <span class="sc">-</span> <span class="fu">rev</span>(free_throws_made),</span>
<span id="cb19-7"><a href="#cb19-7"></a>    <span class="at">three_margin =</span> three_point_field_goals_made <span class="sc">-</span> <span class="fu">rev</span>(three_point_field_goals_made),</span>
<span id="cb19-8"><a href="#cb19-8"></a>    <span class="at">turnover_margin =</span> turnovers <span class="sc">-</span> <span class="fu">rev</span>(turnovers),</span>
<span id="cb19-9"><a href="#cb19-9"></a>    <span class="at">foul_margin =</span> fouls <span class="sc">-</span> <span class="fu">rev</span>(fouls)</span>
<span id="cb19-10"><a href="#cb19-10"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb19-11"><a href="#cb19-11"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-12"><a href="#cb19-12"></a>  <span class="fu">select</span>(game_id, team_name, field_margin, free_margin, three_margin, turnover_margin, foul_margin, cumulative_wins) <span class="sc">%&gt;%</span></span>
<span id="cb19-13"><a href="#cb19-13"></a>  <span class="fu">arrange</span>(game_id) </span>
<span id="cb19-14"><a href="#cb19-14"></a></span>
<span id="cb19-15"><a href="#cb19-15"></a><span class="co"># calculate average margins by team</span></span>
<span id="cb19-16"><a href="#cb19-16"></a>margin_avgs <span class="ot">&lt;-</span> margins <span class="sc">%&gt;%</span></span>
<span id="cb19-17"><a href="#cb19-17"></a>  <span class="fu">group_by</span>(team_name) <span class="sc">%&gt;%</span></span>
<span id="cb19-18"><a href="#cb19-18"></a>  <span class="fu">summarize</span>(</span>
<span id="cb19-19"><a href="#cb19-19"></a>    <span class="at">avg_field_margin =</span> <span class="fu">mean</span>(field_margin),</span>
<span id="cb19-20"><a href="#cb19-20"></a>    <span class="at">avg_free_margin =</span> <span class="fu">mean</span>(free_margin),</span>
<span id="cb19-21"><a href="#cb19-21"></a>    <span class="at">avg_three_margin =</span> <span class="fu">mean</span>(three_margin),</span>
<span id="cb19-22"><a href="#cb19-22"></a>    <span class="at">avg_turnover_margin =</span> <span class="fu">mean</span>(turnover_margin),</span>
<span id="cb19-23"><a href="#cb19-23"></a>    <span class="at">avg_foul_margin =</span> <span class="fu">mean</span>(foul_margin),</span>
<span id="cb19-24"><a href="#cb19-24"></a>    <span class="at">cumulative_wins =</span> <span class="fu">max</span>(cumulative_wins)</span>
<span id="cb19-25"><a href="#cb19-25"></a>  ) </span>
<span id="cb19-26"><a href="#cb19-26"></a></span>
<span id="cb19-27"><a href="#cb19-27"></a>margin_avgs_pivoted <span class="ot">&lt;-</span> margin_avgs <span class="sc">%&gt;%</span></span>
<span id="cb19-28"><a href="#cb19-28"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb19-29"><a href="#cb19-29"></a>    <span class="at">cols =</span> <span class="fu">c</span>(avg_field_margin, avg_free_margin, avg_three_margin, avg_turnover_margin, avg_foul_margin),</span>
<span id="cb19-30"><a href="#cb19-30"></a>    <span class="at">names_to =</span> <span class="st">"margin_type"</span>,</span>
<span id="cb19-31"><a href="#cb19-31"></a>    <span class="at">values_to =</span> <span class="st">"margin_value"</span></span>
<span id="cb19-32"><a href="#cb19-32"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb19-33"><a href="#cb19-33"></a>  <span class="fu">mutate</span>(</span>
<span id="cb19-34"><a href="#cb19-34"></a>    <span class="at">margin_type =</span> <span class="fu">fct_relevel</span>(margin_type, <span class="st">"avg_field_margin"</span>, <span class="st">"avg_free_margin"</span>, <span class="st">"avg_three_margin"</span>, <span class="st">"avg_turnover_margin"</span>, <span class="st">"avg_foul_margin"</span>)</span>
<span id="cb19-35"><a href="#cb19-35"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb19-36"><a href="#cb19-36"></a>  <span class="fu">mutate</span>(</span>
<span id="cb19-37"><a href="#cb19-37"></a>    <span class="at">team_name =</span> <span class="fu">fct_reorder</span>(team_name, <span class="fu">desc</span>(cumulative_wins))</span>
<span id="cb19-38"><a href="#cb19-38"></a>  )</span>
<span id="cb19-39"><a href="#cb19-39"></a></span>
<span id="cb19-40"><a href="#cb19-40"></a>margin_avgs <span class="sc">%&gt;%</span></span>
<span id="cb19-41"><a href="#cb19-41"></a>  <span class="fu">select</span>(team_name, avg_field_margin) <span class="sc">%&gt;%</span></span>
<span id="cb19-42"><a href="#cb19-42"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(avg_field_margin)) <span class="sc">%&gt;%</span></span>
<span id="cb19-43"><a href="#cb19-43"></a>  <span class="fu">slice</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  team_name avg_field_margin
  &lt;chr&gt;                &lt;dbl&gt;
1 Lynx                  3.59</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>margin_avgs <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>  <span class="fu">select</span>(team_name, avg_free_margin) <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(avg_free_margin)) <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4"></a>  <span class="fu">slice</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  team_name avg_free_margin
  &lt;chr&gt;               &lt;dbl&gt;
1 Liberty              2.66</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>margin_avgs <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>  <span class="fu">select</span>(team_name, avg_three_margin) <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(avg_three_margin)) <span class="sc">%&gt;%</span></span>
<span id="cb23-4"><a href="#cb23-4"></a>  <span class="fu">slice</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  team_name avg_three_margin
  &lt;chr&gt;                &lt;dbl&gt;
1 Dream                 2.83</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>margin_avgs <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>  <span class="fu">select</span>(team_name, avg_turnover_margin) <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3"></a>  <span class="fu">arrange</span>(avg_turnover_margin) <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="#cb25-4"></a>  <span class="fu">slice</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  team_name avg_turnover_margin
  &lt;chr&gt;                   &lt;dbl&gt;
1 Storm                   -2.98</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>margin_avgs <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2"></a>  <span class="fu">select</span>(team_name, avg_foul_margin) <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3"></a>  <span class="fu">arrange</span>(avg_foul_margin) <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4"></a>  <span class="fu">slice</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  team_name avg_foul_margin
  &lt;chr&gt;               &lt;dbl&gt;
1 Mystics             -1.43</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="co"># visualize margins by team</span></span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="fu">ggplot</span>(margin_avgs_pivoted, <span class="fu">aes</span>(<span class="at">x =</span> margin_type, <span class="at">y =</span> margin_value, <span class="at">fill =</span> margin_type)) <span class="sc">+</span></span>
<span id="cb29-3"><a href="#cb29-3"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb29-5"><a href="#cb29-5"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>team_name, <span class="at">nrow =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb29-6"><a href="#cb29-6"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb29-7"><a href="#cb29-7"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb29-8"><a href="#cb29-8"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb29-9"><a href="#cb29-9"></a>  <span class="fu">theme</span>(</span>
<span id="cb29-10"><a href="#cb29-10"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb29-11"><a href="#cb29-11"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb29-12"><a href="#cb29-12"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb29-13"><a href="#cb29-13"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),   </span>
<span id="cb29-14"><a href="#cb29-14"></a>    <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"cm"</span>)  ) <span class="sc">+</span></span>
<span id="cb29-15"><a href="#cb29-15"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>, <span class="at">fill =</span> <span class="st">"Average Game Margins"</span>) <span class="sc">+</span></span>
<span id="cb29-16"><a href="#cb29-16"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb29-17"><a href="#cb29-17"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"avg_field_margin"</span> <span class="ot">=</span> <span class="st">"#3c286e"</span>, <span class="st">"avg_free_margin"</span> <span class="ot">=</span> <span class="st">"#5091cd"</span>, </span>
<span id="cb29-18"><a href="#cb29-18"></a>      <span class="st">"avg_three_margin"</span> <span class="ot">=</span> <span class="st">"#e31837"</span>, <span class="st">"avg_turnover_margin"</span> <span class="ot">=</span> <span class="st">"#2c5235"</span>, </span>
<span id="cb29-19"><a href="#cb29-19"></a>      <span class="st">"avg_foul_margin"</span> <span class="ot">=</span> <span class="st">"#f05023"</span>),</span>
<span id="cb29-20"><a href="#cb29-20"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"avg_field_margin"</span> <span class="ot">=</span> <span class="st">"Field Goals"</span>, <span class="st">"avg_free_margin"</span> <span class="ot">=</span> <span class="st">"Free Throws"</span>,</span>
<span id="cb29-21"><a href="#cb29-21"></a>      <span class="st">"avg_three_margin"</span> <span class="ot">=</span> <span class="st">"Three Pointers"</span>, <span class="st">"avg_turnover_margin"</span> <span class="ot">=</span> <span class="st">"Turnovers"</span>, </span>
<span id="cb29-22"><a href="#cb29-22"></a>      <span class="st">"avg_foul_margin"</span> <span class="ot">=</span> <span class="st">"Fouls"</span>)</span>
<span id="cb29-23"><a href="#cb29-23"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="wa-member1_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="play-by-play-dataset" class="level3">
<h3 class="anchored" data-anchor-id="play-by-play-dataset">Play-By-Play Dataset</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="co"># get dimensions</span></span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="fu">dim</span>(wnba_pbp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 121342     62</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="co"># create shot type variable</span></span>
<span id="cb32-2"><a href="#cb32-2"></a>wnba_pbp <span class="ot">&lt;-</span> wnba_pbp <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3"></a>  <span class="fu">filter</span>(shooting_play) <span class="sc">%&gt;%</span></span>
<span id="cb32-4"><a href="#cb32-4"></a>  <span class="fu">mutate</span>(<span class="at">shot_type =</span> <span class="fu">case_when</span>(</span>
<span id="cb32-5"><a href="#cb32-5"></a>    <span class="fu">str_detect</span>(type_text, <span class="st">"Jump Shot"</span>) <span class="sc">~</span> <span class="st">"Jump Shot"</span>,</span>
<span id="cb32-6"><a href="#cb32-6"></a>    <span class="fu">str_detect</span>(type_text, <span class="st">"Layup Shot"</span>) <span class="sc">|</span> <span class="fu">str_detect</span>(type_text, <span class="st">"Layup"</span>) <span class="sc">~</span> <span class="st">"Layup Shot"</span>,</span>
<span id="cb32-7"><a href="#cb32-7"></a>    <span class="fu">str_detect</span>(type_text, <span class="st">"Free Throw"</span>) <span class="sc">~</span> <span class="st">"Free Throw"</span>,</span>
<span id="cb32-8"><a href="#cb32-8"></a>    <span class="fu">str_detect</span>(type_text, <span class="st">"Hook Shot"</span>) <span class="sc">|</span> <span class="fu">str_detect</span>(type_text, <span class="st">"Hook"</span>) <span class="sc">~</span> <span class="st">"Hook Shot"</span>,</span>
<span id="cb32-9"><a href="#cb32-9"></a>    <span class="fu">str_detect</span>(type_text, <span class="st">"Tip Shot"</span>) <span class="sc">~</span> <span class="st">"Tip Shot"</span>,</span>
<span id="cb32-10"><a href="#cb32-10"></a>    <span class="fu">str_detect</span>(type_text, <span class="st">"Dunk"</span>) <span class="sc">~</span> <span class="st">"Dunk Shot"</span></span>
<span id="cb32-11"><a href="#cb32-11"></a>  )) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>wnba_pbp <span class="sc">%&gt;%</span>  </span>
<span id="cb33-2"><a href="#cb33-2"></a>  <span class="fu">filter</span>(game_id <span class="sc">!=</span> <span class="dv">401781604</span>, shot_type <span class="sc">!=</span> <span class="st">"Dunk Shot"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3"></a>  <span class="fu">mutate</span>(<span class="at">shot_type =</span> <span class="fu">fct_relevel</span>(shot_type, <span class="st">"Tip Shot"</span>, <span class="st">"Hook Shot"</span>, <span class="st">"Free Throw"</span>, <span class="st">"Layup Shot"</span>, <span class="st">"Jump Shot"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb33-4"><a href="#cb33-4"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> shot_type, <span class="at">fill =</span> scoring_play)) <span class="sc">+</span></span>
<span id="cb33-5"><a href="#cb33-5"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb33-6"><a href="#cb33-6"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb33-7"><a href="#cb33-7"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"count"</span>, <span class="at">y =</span> <span class="st">"shot type"</span>, <span class="at">fill =</span> <span class="st">"scoring play"</span>) <span class="sc">+</span></span>
<span id="cb33-8"><a href="#cb33-8"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"TRUE"</span> <span class="ot">=</span> <span class="st">"#3c286e"</span>, <span class="st">"FALSE"</span> <span class="ot">=</span> <span class="st">"#f05023"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="wa-member1_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="salary-data" class="level1">
<h1>Salary Data</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="fu">get_robotstxt</span>(<span class="at">domain =</span> <span class="st">"https://herhoopstats.com/"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[robots.txt]
--------------------------------------

# robots.txt overwrite by: on_suspect_content

User-agent: *
Allow: /



[events]
--------------------------------------

requested:   https://herhoopstats.com//robots.txt 
downloaded:  https://herhoopstats.com//robots.txt 

$on_not_found
$on_not_found$status_code
[1] 404


$on_file_type_mismatch
$on_file_type_mismatch$content_type
[1] "text/html; charset=utf-8"


$on_suspect_content
$on_suspect_content$parsable
[1] FALSE

$on_suspect_content$content_suspect
[1] TRUE


[attributes]
--------------------------------------

problems, cached, request, class</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>start_url <span class="ot">&lt;-</span> <span class="st">"https://herhoopstats.com/salary-cap-sheet/wnba/team/2025/"</span></span>
<span id="cb36-2"><a href="#cb36-2"></a>team_urls <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb36-3"><a href="#cb36-3"></a>  <span class="st">"atlanta-dream-11eaecc7-356c-1364-b611-2362f5011b0b"</span>,    </span>
<span id="cb36-4"><a href="#cb36-4"></a>  <span class="st">"chicago-sky-11eaecc7-355f-1c4a-b611-2362f5011b0b"</span>,     </span>
<span id="cb36-5"><a href="#cb36-5"></a>  <span class="st">"connecticut-sun-11eaecc7-3562-4a0a-b611-2362f5011b0b"</span>,     </span>
<span id="cb36-6"><a href="#cb36-6"></a>  <span class="st">"dallas-wings-11eaecc7-3583-13fc-b611-2362f5011b0b"</span>,     </span>
<span id="cb36-7"><a href="#cb36-7"></a>  <span class="st">"golden-state-valkyries-11efb2ba-e2c6-f520-8806-9a93b15b3fec"</span>, </span>
<span id="cb36-8"><a href="#cb36-8"></a>  <span class="st">"indiana-fever-11eaecc7-3565-c004-b611-2362f5011b0b"</span>,</span>
<span id="cb36-9"><a href="#cb36-9"></a>  <span class="st">"las-vegas-aces-11eaecc7-3575-e2fe-b611-2362f5011b0b"</span>,</span>
<span id="cb36-10"><a href="#cb36-10"></a>  <span class="st">"los-angeles-sparks-11eaecc7-3579-2ce8-b611-2362f5011b0b"</span>,</span>
<span id="cb36-11"><a href="#cb36-11"></a>  <span class="st">"minnesota-lynx-11eaecc7-357c-772c-b611-2362f5011b0b"</span>,</span>
<span id="cb36-12"><a href="#cb36-12"></a>  <span class="st">"new-york-liberty-11eaecc7-356f-5524-b611-2362f5011b0b"</span>,</span>
<span id="cb36-13"><a href="#cb36-13"></a>  <span class="st">"phoenix-mercury-11eaecc7-357f-c1ca-b611-2362f5011b0b"</span>,</span>
<span id="cb36-14"><a href="#cb36-14"></a>  <span class="st">"seattle-storm-11eaecc7-3572-876c-b611-2362f5011b0b"</span>,</span>
<span id="cb36-15"><a href="#cb36-15"></a>  <span class="st">"washington-mystics-11eaecc7-3568-d154-b611-2362f5011b0b"</span></span>
<span id="cb36-16"><a href="#cb36-16"></a>)</span>
<span id="cb36-17"><a href="#cb36-17"></a>full_urls <span class="ot">&lt;-</span> <span class="fu">str_c</span>(start_url, team_urls, <span class="st">"/"</span>)</span>
<span id="cb36-18"><a href="#cb36-18"></a></span>
<span id="cb36-19"><a href="#cb36-19"></a>salary_info <span class="ot">&lt;-</span> <span class="cf">function</span>(url) {</span>
<span id="cb36-20"><a href="#cb36-20"></a>  <span class="fu">Sys.sleep</span>(<span class="dv">1</span>)</span>
<span id="cb36-21"><a href="#cb36-21"></a>  webpage <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url)</span>
<span id="cb36-22"><a href="#cb36-22"></a></span>
<span id="cb36-23"><a href="#cb36-23"></a>  team <span class="ot">&lt;-</span> webpage <span class="sc">%&gt;%</span></span>
<span id="cb36-24"><a href="#cb36-24"></a>    <span class="fu">html_element</span>(<span class="st">"h1.salary_title"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-25"><a href="#cb36-25"></a>    <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb36-26"><a href="#cb36-26"></a>  </span>
<span id="cb36-27"><a href="#cb36-27"></a>  rows <span class="ot">&lt;-</span> webpage <span class="sc">%&gt;%</span></span>
<span id="cb36-28"><a href="#cb36-28"></a>    <span class="fu">html_elements</span>(<span class="st">"tbody tr"</span>)</span>
<span id="cb36-29"><a href="#cb36-29"></a></span>
<span id="cb36-30"><a href="#cb36-30"></a>  <span class="fu">map_df</span>(rows, <span class="cf">function</span>(row) {</span>
<span id="cb36-31"><a href="#cb36-31"></a></span>
<span id="cb36-32"><a href="#cb36-32"></a>    player <span class="ot">&lt;-</span> row <span class="sc">%&gt;%</span></span>
<span id="cb36-33"><a href="#cb36-33"></a>      <span class="fu">html_element</span>(<span class="st">"td.salary_player_name a"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-34"><a href="#cb36-34"></a>      <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb36-35"><a href="#cb36-35"></a></span>
<span id="cb36-36"><a href="#cb36-36"></a>    salary_cell <span class="ot">&lt;-</span> row <span class="sc">%&gt;%</span></span>
<span id="cb36-37"><a href="#cb36-37"></a>      <span class="fu">html_elements</span>(<span class="st">"td.salary_cap_hit"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-38"><a href="#cb36-38"></a>      .[<span class="dv">1</span>]</span>
<span id="cb36-39"><a href="#cb36-39"></a></span>
<span id="cb36-40"><a href="#cb36-40"></a>    salary <span class="ot">&lt;-</span> salary_cell <span class="sc">%&gt;%</span></span>
<span id="cb36-41"><a href="#cb36-41"></a>      <span class="fu">html_attr</span>(<span class="st">"sorttable_customkey"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-42"><a href="#cb36-42"></a>      <span class="fu">as.numeric</span>()</span>
<span id="cb36-43"><a href="#cb36-43"></a></span>
<span id="cb36-44"><a href="#cb36-44"></a>    contract_type <span class="ot">&lt;-</span> salary_cell <span class="sc">%&gt;%</span></span>
<span id="cb36-45"><a href="#cb36-45"></a>      <span class="fu">html_attr</span>(<span class="st">"title"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-46"><a href="#cb36-46"></a>      <span class="fu">na_if</span>(<span class="st">""</span>)</span>
<span id="cb36-47"><a href="#cb36-47"></a></span>
<span id="cb36-48"><a href="#cb36-48"></a>    <span class="fu">tibble</span>(</span>
<span id="cb36-49"><a href="#cb36-49"></a>      <span class="at">name =</span> player,</span>
<span id="cb36-50"><a href="#cb36-50"></a>      <span class="at">team =</span> team,</span>
<span id="cb36-51"><a href="#cb36-51"></a>      <span class="at">salary =</span> salary,</span>
<span id="cb36-52"><a href="#cb36-52"></a>      <span class="at">contract =</span> contract_type</span>
<span id="cb36-53"><a href="#cb36-53"></a>    )</span>
<span id="cb36-54"><a href="#cb36-54"></a>  })</span>
<span id="cb36-55"><a href="#cb36-55"></a>}</span>
<span id="cb36-56"><a href="#cb36-56"></a></span>
<span id="cb36-57"><a href="#cb36-57"></a>all_pages <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map</span>(full_urls, salary_info)</span>
<span id="cb36-58"><a href="#cb36-58"></a>salary_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(all_pages)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>salary_df<span class="sc">$</span>salary[salary_df<span class="sc">$</span>salary <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb37-2"><a href="#cb37-2"></a></span>
<span id="cb37-3"><a href="#cb37-3"></a>salary_df <span class="ot">&lt;-</span> salary_df <span class="sc">%&gt;%</span></span>
<span id="cb37-4"><a href="#cb37-4"></a>  <span class="fu">mutate</span>(<span class="at">contract =</span> <span class="fu">str_extract</span>(contract, <span class="st">"^[^&lt;]*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb37-5"><a href="#cb37-5"></a>  <span class="fu">mutate</span>(<span class="at">team =</span> <span class="fu">str_extract</span>(team, <span class="st">"(?&lt;=2025 ).*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb37-6"><a href="#cb37-6"></a>  <span class="fu">mutate</span>(<span class="at">team =</span> <span class="fu">str_extract</span>(team, <span class="st">".*(?= Salary Cap Sheet)"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb37-7"><a href="#cb37-7"></a>  <span class="fu">mutate</span>(<span class="at">team_name =</span> <span class="fu">case_when</span>(</span>
<span id="cb37-8"><a href="#cb37-8"></a>    team <span class="sc">==</span> <span class="st">"Atlanta Dream"</span> <span class="sc">~</span> <span class="st">"Dream"</span>,</span>
<span id="cb37-9"><a href="#cb37-9"></a>    team <span class="sc">==</span> <span class="st">"Chicago Sky"</span> <span class="sc">~</span> <span class="st">"Sky"</span>,</span>
<span id="cb37-10"><a href="#cb37-10"></a>    team <span class="sc">==</span> <span class="st">"Connecticut Sun"</span> <span class="sc">~</span> <span class="st">"Sun"</span>,</span>
<span id="cb37-11"><a href="#cb37-11"></a>    team <span class="sc">==</span> <span class="st">"Dallas Wings"</span> <span class="sc">~</span> <span class="st">"Wings"</span>, </span>
<span id="cb37-12"><a href="#cb37-12"></a>    team <span class="sc">==</span> <span class="st">"Golden State Valkyries"</span> <span class="sc">~</span> <span class="st">"Valkyries"</span>,</span>
<span id="cb37-13"><a href="#cb37-13"></a>    team <span class="sc">==</span> <span class="st">"Indiana Fever"</span> <span class="sc">~</span> <span class="st">"Fever"</span>,</span>
<span id="cb37-14"><a href="#cb37-14"></a>    team <span class="sc">==</span> <span class="st">"Las Vegas Aces"</span> <span class="sc">~</span> <span class="st">"Aces"</span>,</span>
<span id="cb37-15"><a href="#cb37-15"></a>    team <span class="sc">==</span> <span class="st">"Los Angeles Sparks"</span> <span class="sc">~</span> <span class="st">"Sparks"</span>,</span>
<span id="cb37-16"><a href="#cb37-16"></a>    team <span class="sc">==</span> <span class="st">"Minnesota Lynx"</span> <span class="sc">~</span> <span class="st">"Lynx"</span>,</span>
<span id="cb37-17"><a href="#cb37-17"></a>    team <span class="sc">==</span> <span class="st">"New York Liberty"</span> <span class="sc">~</span> <span class="st">"Liberty"</span>,</span>
<span id="cb37-18"><a href="#cb37-18"></a>    team <span class="sc">==</span> <span class="st">"Phoenix Mercury"</span> <span class="sc">~</span> <span class="st">"Mercury"</span>,</span>
<span id="cb37-19"><a href="#cb37-19"></a>    team <span class="sc">==</span> <span class="st">"Seattle Storm"</span> <span class="sc">~</span> <span class="st">"Storm"</span>,</span>
<span id="cb37-20"><a href="#cb37-20"></a>    team <span class="sc">==</span> <span class="st">"Washington Mystics"</span> <span class="sc">~</span> <span class="st">"Mystics"</span></span>
<span id="cb37-21"><a href="#cb37-21"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb37-22"><a href="#cb37-22"></a>  <span class="fu">mutate</span>(<span class="at">contract =</span> </span>
<span id="cb37-23"><a href="#cb37-23"></a>    <span class="fu">fct_collapse</span>(contract,</span>
<span id="cb37-24"><a href="#cb37-24"></a>      <span class="st">"Protected Veteran"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Protected Veteran"</span>),</span>
<span id="cb37-25"><a href="#cb37-25"></a>      <span class="st">"Unprotected"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Unprotected"</span>),</span>
<span id="cb37-26"><a href="#cb37-26"></a>      <span class="st">"7-Day Contract"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Complete 7-Day Contract"</span>),</span>
<span id="cb37-27"><a href="#cb37-27"></a>      <span class="st">"Hardship Contract"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Complete Hardship Contract"</span>, <span class="st">"Active Hardship Contract"</span>), </span>
<span id="cb37-28"><a href="#cb37-28"></a>      <span class="st">"Waived"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Waived"</span>, <span class="st">"Waived Protected Veteran"</span>),</span>
<span id="cb37-29"><a href="#cb37-29"></a>      <span class="st">"Protected Rookie Scale"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Protected Rookie Scale"</span>),</span>
<span id="cb37-30"><a href="#cb37-30"></a>      <span class="st">"Buyout"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Buyout"</span>)</span>
<span id="cb37-31"><a href="#cb37-31"></a>    )</span>
<span id="cb37-32"><a href="#cb37-32"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb37-33"><a href="#cb37-33"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">ifelse</span>(<span class="fu">is.nan</span>(.), <span class="cn">NA</span>, .)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>top10_salary <span class="ot">&lt;-</span> salary_df <span class="sc">%&gt;%</span></span>
<span id="cb38-2"><a href="#cb38-2"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(salary)) <span class="sc">%&gt;%</span></span>
<span id="cb38-3"><a href="#cb38-3"></a>  <span class="fu">select</span>(name, team_name, salary, contract) <span class="sc">%&gt;%</span></span>
<span id="cb38-4"><a href="#cb38-4"></a>  <span class="fu">head</span>(<span class="dv">10</span>) </span>
<span id="cb38-5"><a href="#cb38-5"></a></span>
<span id="cb38-6"><a href="#cb38-6"></a>top10_salary <span class="sc">%&gt;%</span></span>
<span id="cb38-7"><a href="#cb38-7"></a>  <span class="fu">kable</span>(</span>
<span id="cb38-8"><a href="#cb38-8"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Player"</span>, <span class="st">"Team"</span>, <span class="st">"Salary"</span>, <span class="st">"Contract"</span>),</span>
<span id="cb38-9"><a href="#cb38-9"></a>    <span class="at">align =</span> <span class="st">"lll"</span></span>
<span id="cb38-10"><a href="#cb38-10"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb38-11"><a href="#cb38-11"></a>  <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Player</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Team</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Salary</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Contract</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Kelsey Mitchell</td>
<td style="text-align: left;">Fever</td>
<td style="text-align: left;">269244</td>
<td style="text-align: left;">Protected Veteran</td>
</tr>
<tr class="even">
<td style="text-align: left;">Arike Ogunbowale</td>
<td style="text-align: left;">Wings</td>
<td style="text-align: left;">249032</td>
<td style="text-align: left;">Protected Veteran</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Jewell Loyd</td>
<td style="text-align: left;">Aces</td>
<td style="text-align: left;">249032</td>
<td style="text-align: left;">Protected Veteran</td>
</tr>
<tr class="even">
<td style="text-align: left;">Kahleah Copper</td>
<td style="text-align: left;">Mercury</td>
<td style="text-align: left;">248134</td>
<td style="text-align: left;">Protected Veteran</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Gabby Williams</td>
<td style="text-align: left;">Storm</td>
<td style="text-align: left;">225000</td>
<td style="text-align: left;">Protected Veteran</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ariel Atkins</td>
<td style="text-align: left;">Sky</td>
<td style="text-align: left;">223000</td>
<td style="text-align: left;">Protected Veteran</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Breanna Stewart</td>
<td style="text-align: left;">Liberty</td>
<td style="text-align: left;">222400</td>
<td style="text-align: left;">Protected Veteran</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sabrina Ionescu</td>
<td style="text-align: left;">Liberty</td>
<td style="text-align: left;">222060</td>
<td style="text-align: left;">Unprotected</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Satou Sabally</td>
<td style="text-align: left;">Mercury</td>
<td style="text-align: left;">215000</td>
<td style="text-align: left;">Protected Veteran</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alyssa Thomas</td>
<td style="text-align: left;">Mercury</td>
<td style="text-align: left;">215000</td>
<td style="text-align: left;">Protected Veteran</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>player_salary <span class="ot">&lt;-</span> top_players <span class="sc">%&gt;%</span></span>
<span id="cb39-2"><a href="#cb39-2"></a>  <span class="fu">left_join</span>(salary_df, <span class="at">by =</span> <span class="fu">join_by</span>(athlete_display_name <span class="sc">==</span> name, team_name <span class="sc">==</span> team_name)) </span>
<span id="cb39-3"><a href="#cb39-3"></a></span>
<span id="cb39-4"><a href="#cb39-4"></a>player_salary <span class="sc">%&gt;%</span></span>
<span id="cb39-5"><a href="#cb39-5"></a>  <span class="fu">select</span>(athlete_display_name, team_name, salary, contract) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 232 × 4
# Groups:   athlete_display_name [185]
   athlete_display_name team_name salary contract         
   &lt;chr&gt;                &lt;chr&gt;      &lt;dbl&gt; &lt;fct&gt;            
 1 A'ja Wilson          Aces      200000 Protected Veteran
 2 Aaliyah Edwards      Mystics       NA &lt;NA&gt;             
 3 Aaliyah Edwards      Sun        74909 Unprotected      
 4 Aaliyah Nye          Aces       69267 Unprotected      
 5 Aari McDonald        Fever      52333 Unprotected      
 6 Aari McDonald        Fever       6459 Hardship Contract
 7 Aerial Powers        Fever       3975 Hardship Contract
 8 Aerial Powers        Fever       9274 7-Day Contract   
 9 Aerial Powers        Valkyries  11924 Waived           
10 Ajae Petty           Wings       1250 Hardship Contract
# ℹ 222 more rows</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>PIE <span class="ot">&lt;-</span> player_game_totals <span class="sc">%&gt;%</span></span>
<span id="cb41-2"><a href="#cb41-2"></a>  <span class="fu">group_by</span>(athlete_display_name, team_name) <span class="sc">%&gt;%</span></span>
<span id="cb41-3"><a href="#cb41-3"></a>  <span class="fu">summarize</span>(<span class="at">avg_PIE =</span> <span class="fu">mean</span>(player_PIE, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) </span>
<span id="cb41-4"><a href="#cb41-4"></a></span>
<span id="cb41-5"><a href="#cb41-5"></a>player_salary_stats <span class="ot">&lt;-</span> player_salary <span class="sc">%&gt;%</span></span>
<span id="cb41-6"><a href="#cb41-6"></a>  <span class="fu">left_join</span>(PIE, <span class="at">by =</span> <span class="fu">join_by</span>(athlete_display_name <span class="sc">==</span> athlete_display_name, team_name <span class="sc">==</span> team_name)) <span class="sc">%&gt;%</span></span>
<span id="cb41-7"><a href="#cb41-7"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span></span>
<span id="cb41-8"><a href="#cb41-8"></a>  <span class="fu">mutate</span>(<span class="at">salary_thousands =</span> salary<span class="sc">/</span><span class="dv">1000</span>)</span>
<span id="cb41-9"><a href="#cb41-9"></a></span>
<span id="cb41-10"><a href="#cb41-10"></a><span class="fu">ggplot</span>(player_salary_stats, <span class="fu">aes</span>(<span class="at">x =</span> avg_PIE, <span class="at">y =</span> salary_thousands, <span class="at">color =</span> contract)) <span class="sc">+</span></span>
<span id="cb41-11"><a href="#cb41-11"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb41-12"><a href="#cb41-12"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb41-13"><a href="#cb41-13"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb41-14"><a href="#cb41-14"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Player Impact Estimate (Season Average)"</span>, <span class="at">y =</span> <span class="st">"Salary in Thousands of Dollars"</span>, </span>
<span id="cb41-15"><a href="#cb41-15"></a>       <span class="at">color =</span> <span class="st">"Contract Type"</span>, <span class="at">title =</span> <span class="st">"2025 WNBA Player Salaries by Player Performance and Contract Type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="wa-member1_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>salary_contract_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(salary_thousands <span class="sc">~</span> avg_PIE <span class="sc">*</span> contract, player_salary_stats)</span>
<span id="cb42-2"><a href="#cb42-2"></a></span>
<span id="cb42-3"><a href="#cb42-3"></a><span class="fu">coef</span>(<span class="fu">summary</span>(salary_contract_mod))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                          Estimate Std. Error     t value
(Intercept)                              4.5062545  12.637385  0.35658124
avg_PIE                                  0.5250086   3.227551  0.16266473
contract7-Day Contract                   3.1322646  15.555447  0.20136127
contractProtected Rookie Scale          80.4917749  36.805332  2.18695959
contractProtected Veteran              130.5928571  17.063034  7.65355448
contractUnprotected                     52.3206999  13.859994  3.77494399
contractWaived                          25.4712932  15.454775  1.64811805
avg_PIE:contract7-Day Contract           0.3912289   4.691556  0.08339002
avg_PIE:contractProtected Rookie Scale  -0.1506974   6.312425 -0.02387313
avg_PIE:contractProtected Veteran        6.1080276   3.525704  1.73242778
avg_PIE:contractUnprotected              4.9977398   3.415837  1.46310860
avg_PIE:contractWaived                   7.3848797   4.815397  1.53359727
                                           Pr(&gt;|t|)
(Intercept)                            7.217850e-01
avg_PIE                                8.709483e-01
contract7-Day Contract                 8.406228e-01
contractProtected Rookie Scale         2.991718e-02
contractProtected Veteran              8.395865e-13
contractUnprotected                    2.114782e-04
contractWaived                         1.009143e-01
avg_PIE:contract7-Day Contract         9.336257e-01
avg_PIE:contractProtected Rookie Scale 9.809778e-01
avg_PIE:contractProtected Veteran      8.475461e-02
avg_PIE:contractUnprotected            1.450233e-01
avg_PIE:contractWaived                 1.267250e-01</code></pre>
</div>
</div>
</section>
<section id="machine-learning" class="level1">
<h1>Machine Learning</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="co"># predicting playoff outcomes using LASSO on team dataset</span></span>
<span id="cb44-2"><a href="#cb44-2"></a>wnba_team_lasso <span class="ot">&lt;-</span> wnba_team_box <span class="sc">%&gt;%</span></span>
<span id="cb44-3"><a href="#cb44-3"></a>  <span class="fu">filter</span>(game_id <span class="sc">!=</span> <span class="dv">401781604</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-4"><a href="#cb44-4"></a>  <span class="fu">select</span>(<span class="sc">-</span>season, <span class="sc">-</span>game_date_time, <span class="sc">-</span>team_id, <span class="sc">-</span>team_uid, <span class="sc">-</span>team_slug, <span class="sc">-</span>team_location, <span class="sc">-</span>team_abbreviation, <span class="sc">-</span>team_display_name, <span class="sc">-</span>team_short_display_name, <span class="sc">-</span>team_color, <span class="sc">-</span>team_alternate_color, <span class="sc">-</span>team_logo, <span class="sc">-</span>team_score, <span class="sc">-</span>opponent_team_id, <span class="sc">-</span>opponent_team_uid, <span class="sc">-</span>opponent_team_slug, <span class="sc">-</span>opponent_team_location, <span class="sc">-</span>opponent_team_abbreviation, <span class="sc">-</span>opponent_team_display_name, <span class="sc">-</span>opponent_team_short_display_name, <span class="sc">-</span>opponent_team_color, <span class="sc">-</span>opponent_team_alternate_color, <span class="sc">-</span>opponent_team_logo, <span class="sc">-</span>opponent_team_score) <span class="sc">%&gt;%</span></span>
<span id="cb44-5"><a href="#cb44-5"></a>  <span class="fu">mutate</span>(</span>
<span id="cb44-6"><a href="#cb44-6"></a>    <span class="at">team_winner =</span> <span class="fu">factor</span>(team_winner),</span>
<span id="cb44-7"><a href="#cb44-7"></a>    <span class="at">largest_lead =</span> <span class="fu">as.numeric</span>(largest_lead),</span>
<span id="cb44-8"><a href="#cb44-8"></a>    <span class="at">fast_break_points =</span> <span class="fu">as.numeric</span>(fast_break_points),</span>
<span id="cb44-9"><a href="#cb44-9"></a>    <span class="at">turnover_points =</span> <span class="fu">as.numeric</span>(turnover_points)) <span class="sc">%&gt;%</span> </span>
<span id="cb44-10"><a href="#cb44-10"></a>  <span class="fu">mutate</span>(<span class="at">season_day =</span> <span class="fu">as.numeric</span>(game_date <span class="sc">-</span> <span class="fu">as.Date</span>(<span class="st">"2025-05-16"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb44-11"><a href="#cb44-11"></a>  <span class="fu">select</span>(<span class="sc">-</span>game_date)</span>
<span id="cb44-12"><a href="#cb44-12"></a></span>
<span id="cb44-13"><a href="#cb44-13"></a>lasso_training <span class="ot">&lt;-</span> wnba_team_lasso <span class="sc">%&gt;%</span></span>
<span id="cb44-14"><a href="#cb44-14"></a>  <span class="fu">filter</span>(season_type <span class="sc">!=</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-15"><a href="#cb44-15"></a>  <span class="fu">select</span>(<span class="sc">-</span>game_id, <span class="sc">-</span>season_type)</span>
<span id="cb44-16"><a href="#cb44-16"></a></span>
<span id="cb44-17"><a href="#cb44-17"></a>lasso_test <span class="ot">&lt;-</span> wnba_team_lasso <span class="sc">%&gt;%</span></span>
<span id="cb44-18"><a href="#cb44-18"></a>  <span class="fu">filter</span>(season_type <span class="sc">==</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-19"><a href="#cb44-19"></a>  <span class="fu">select</span>(<span class="sc">-</span>game_id, <span class="sc">-</span>season_type)</span>
<span id="cb44-20"><a href="#cb44-20"></a></span>
<span id="cb44-21"><a href="#cb44-21"></a><span class="co"># model specification</span></span>
<span id="cb44-22"><a href="#cb44-22"></a><span class="fu">set.seed</span>(<span class="dv">212</span>)</span>
<span id="cb44-23"><a href="#cb44-23"></a>model_spec <span class="ot">&lt;-</span> <span class="fu">logistic_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-24"><a href="#cb44-24"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb44-25"><a href="#cb44-25"></a>  <span class="fu">set_engine</span>(<span class="st">"glmnet"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-26"><a href="#cb44-26"></a>  <span class="fu">set_args</span>(<span class="at">mixture =</span> <span class="dv">1</span>, <span class="at">penalty =</span> <span class="fu">tune</span>())</span>
<span id="cb44-27"><a href="#cb44-27"></a></span>
<span id="cb44-28"><a href="#cb44-28"></a><span class="co"># variable recipe</span></span>
<span id="cb44-29"><a href="#cb44-29"></a>data_rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(team_winner <span class="sc">~</span> . , <span class="at">data =</span> lasso_training) <span class="sc">%&gt;%</span></span>
<span id="cb44-30"><a href="#cb44-30"></a>  <span class="fu">step_novel</span>(<span class="fu">all_nominal_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb44-31"><a href="#cb44-31"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal_predictors</span>())</span>
<span id="cb44-32"><a href="#cb44-32"></a></span>
<span id="cb44-33"><a href="#cb44-33"></a><span class="co"># workflow (algorithm + recipe)</span></span>
<span id="cb44-34"><a href="#cb44-34"></a>model_wf <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb44-35"><a href="#cb44-35"></a>  <span class="fu">add_recipe</span>(data_rec) <span class="sc">%&gt;%</span></span>
<span id="cb44-36"><a href="#cb44-36"></a>  <span class="fu">add_model</span>(model_spec) </span>
<span id="cb44-37"><a href="#cb44-37"></a></span>
<span id="cb44-38"><a href="#cb44-38"></a><span class="co"># estimate 50 LASSO models</span></span>
<span id="cb44-39"><a href="#cb44-39"></a>multiple_models <span class="ot">&lt;-</span> model_wf <span class="sc">%&gt;%</span></span>
<span id="cb44-40"><a href="#cb44-40"></a> <span class="fu">tune_grid</span>(</span>
<span id="cb44-41"><a href="#cb44-41"></a>    <span class="at">grid =</span> <span class="fu">grid_regular</span>(</span>
<span id="cb44-42"><a href="#cb44-42"></a>      <span class="fu">penalty</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">3</span>)),     </span>
<span id="cb44-43"><a href="#cb44-43"></a>      <span class="at">levels =</span> <span class="dv">50</span></span>
<span id="cb44-44"><a href="#cb44-44"></a>    ),</span>
<span id="cb44-45"><a href="#cb44-45"></a>    <span class="at">resamples =</span> <span class="fu">vfold_cv</span>(lasso_training, <span class="at">v =</span> <span class="dv">10</span>),</span>
<span id="cb44-46"><a href="#cb44-46"></a>    <span class="at">metrics =</span> <span class="fu">metric_set</span>(accuracy)</span>
<span id="cb44-47"><a href="#cb44-47"></a> )</span>
<span id="cb44-48"><a href="#cb44-48"></a></span>
<span id="cb44-49"><a href="#cb44-49"></a><span class="co"># determine parsimonious parameter</span></span>
<span id="cb44-50"><a href="#cb44-50"></a>parsimonious_param <span class="ot">&lt;-</span> multiple_models <span class="sc">%&gt;%</span>   </span>
<span id="cb44-51"><a href="#cb44-51"></a>  <span class="fu">select_by_one_std_err</span>(<span class="at">metric =</span> <span class="st">"accuracy"</span>, <span class="fu">desc</span>(penalty))</span>
<span id="cb44-52"><a href="#cb44-52"></a></span>
<span id="cb44-53"><a href="#cb44-53"></a><span class="co"># determine best (highest accuracy) parameter</span></span>
<span id="cb44-54"><a href="#cb44-54"></a>best_param <span class="ot">&lt;-</span> multiple_models <span class="sc">%&gt;%</span>   </span>
<span id="cb44-55"><a href="#cb44-55"></a>  <span class="fu">select_best</span>(<span class="at">metric =</span> <span class="st">"accuracy"</span>)</span>
<span id="cb44-56"><a href="#cb44-56"></a></span>
<span id="cb44-57"><a href="#cb44-57"></a><span class="co"># build final parsimonious model</span></span>
<span id="cb44-58"><a href="#cb44-58"></a>final_model <span class="ot">&lt;-</span> model_wf <span class="sc">%&gt;%</span> </span>
<span id="cb44-59"><a href="#cb44-59"></a>  <span class="fu">finalize_workflow</span>(parsimonious_param) <span class="sc">%&gt;%</span> </span>
<span id="cb44-60"><a href="#cb44-60"></a>  <span class="fu">fit</span>(<span class="at">data =</span> lasso_training)</span>
<span id="cb44-61"><a href="#cb44-61"></a></span>
<span id="cb44-62"><a href="#cb44-62"></a><span class="co"># print coefficients</span></span>
<span id="cb44-63"><a href="#cb44-63"></a>final_model <span class="sc">%&gt;%</span></span>
<span id="cb44-64"><a href="#cb44-64"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-65"><a href="#cb44-65"></a>  <span class="fu">filter</span>(estimate <span class="sc">!=</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 16 × 3
   term                         estimate penalty
   &lt;chr&gt;                           &lt;dbl&gt;   &lt;dbl&gt;
 1 (Intercept)                  -9.21     0.0268
 2 assists                       0.0117   0.0268
 3 blocks                        0.0275   0.0268
 4 defensive_rebounds            0.0283   0.0268
 5 field_goal_pct                0.0949   0.0268
 6 flagrant_fouls               -0.0921   0.0268
 7 fouls                        -0.0333   0.0268
 8 free_throws_made              0.0651   0.0268
 9 largest_lead                  0.169    0.0268
10 steals                        0.0841   0.0268
11 three_point_field_goals_made  0.0525   0.0268
12 total_rebounds                0.0626   0.0268
13 turnover_points              -0.0823   0.0268
14 turnovers                    -0.00620  0.0268
15 team_name_Lynx                0.0463   0.0268
16 team_name_Wings              -0.365    0.0268</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>multiple_models <span class="sc">%&gt;%</span> </span>
<span id="cb46-2"><a href="#cb46-2"></a>  <span class="fu">collect_metrics</span>() <span class="sc">%&gt;%</span></span>
<span id="cb46-3"><a href="#cb46-3"></a>  <span class="fu">filter</span>(penalty <span class="sc">==</span> parsimonious_param<span class="sc">$</span>penalty)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 7
  penalty .metric  .estimator  mean     n std_err .config         
    &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;           
1  0.0268 accuracy binary     0.866    10  0.0132 pre0_mod22_post0</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>multiple_models <span class="sc">%&gt;%</span></span>
<span id="cb48-2"><a href="#cb48-2"></a>  <span class="fu">autoplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="wa-member1_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a>test_classifications <span class="ot">&lt;-</span> final_model <span class="sc">%&gt;%</span> <span class="co"># name of your final model</span></span>
<span id="cb49-2"><a href="#cb49-2"></a>  <span class="fu">augment</span>(<span class="at">new_data =</span> lasso_test) </span>
<span id="cb49-3"><a href="#cb49-3"></a></span>
<span id="cb49-4"><a href="#cb49-4"></a>test_confusion <span class="ot">&lt;-</span> final_model <span class="sc">%&gt;%</span></span>
<span id="cb49-5"><a href="#cb49-5"></a>  <span class="fu">augment</span>(<span class="at">new_data =</span> lasso_test) <span class="sc">%&gt;%</span></span>
<span id="cb49-6"><a href="#cb49-6"></a>  <span class="fu">conf_mat</span>(<span class="at">truth =</span> team_winner, <span class="at">estimate =</span> .pred_class)</span>
<span id="cb49-7"><a href="#cb49-7"></a></span>
<span id="cb49-8"><a href="#cb49-8"></a><span class="fu">summary</span>(test_confusion, <span class="at">event_level =</span> <span class="st">"second"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 3
   .metric              .estimator .estimate
   &lt;chr&gt;                &lt;chr&gt;          &lt;dbl&gt;
 1 accuracy             binary         0.792
 2 kap                  binary         0.583
 3 sens                 binary         0.75 
 4 spec                 binary         0.833
 5 ppv                  binary         0.818
 6 npv                  binary         0.769
 7 mcc                  binary         0.585
 8 j_index              binary         0.583
 9 bal_accuracy         binary         0.792
10 detection_prevalence binary         0.458
11 precision            binary         0.818
12 recall               binary         0.75 
13 f_meas               binary         0.783</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a>test_confusion <span class="sc">%&gt;%</span> </span>
<span id="cb51-2"><a href="#cb51-2"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb51-3"><a href="#cb51-3"></a>  <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">rep</span>(<span class="fu">colnames</span>(test_confusion<span class="sc">$</span>table), <span class="fu">ncol</span>(test_confusion<span class="sc">$</span>table))) <span class="sc">+</span> </span>
<span id="cb51-4"><a href="#cb51-4"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="wa-member1_files/figure-html/unnamed-chunk-21-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="co"># alternative LASSO that combines both teams stats into one row instead of having two rows per game</span></span>
<span id="cb52-2"><a href="#cb52-2"></a>team_lasso <span class="ot">&lt;-</span> wnba_team_box <span class="sc">%&gt;%</span></span>
<span id="cb52-3"><a href="#cb52-3"></a>  <span class="fu">filter</span>(game_id <span class="sc">!=</span> <span class="dv">401781604</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-4"><a href="#cb52-4"></a>  <span class="fu">select</span>(<span class="sc">-</span>season, <span class="sc">-</span>season_type, <span class="sc">-</span>game_date_time, <span class="sc">-</span>team_id, <span class="sc">-</span>team_uid, <span class="sc">-</span>team_slug, <span class="sc">-</span>team_location, <span class="sc">-</span>team_abbreviation, <span class="sc">-</span>team_display_name, <span class="sc">-</span>team_short_display_name, <span class="sc">-</span>team_color, <span class="sc">-</span>team_alternate_color, <span class="sc">-</span>team_logo, <span class="sc">-</span>team_score, <span class="sc">-</span>opponent_team_id, <span class="sc">-</span>opponent_team_uid, <span class="sc">-</span>opponent_team_slug, <span class="sc">-</span>opponent_team_location, <span class="sc">-</span>opponent_team_name, <span class="sc">-</span>opponent_team_abbreviation, <span class="sc">-</span>opponent_team_display_name, <span class="sc">-</span>opponent_team_short_display_name, <span class="sc">-</span>opponent_team_color, <span class="sc">-</span>opponent_team_alternate_color, <span class="sc">-</span>opponent_team_logo, <span class="sc">-</span>opponent_team_score) <span class="sc">%&gt;%</span></span>
<span id="cb52-5"><a href="#cb52-5"></a>  <span class="fu">mutate</span>(<span class="at">team_winner =</span> <span class="fu">factor</span>(team_winner))</span>
<span id="cb52-6"><a href="#cb52-6"></a></span>
<span id="cb52-7"><a href="#cb52-7"></a>team1_lasso <span class="ot">&lt;-</span> team_lasso <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(game_id) <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb52-8"><a href="#cb52-8"></a>team2_lasso <span class="ot">&lt;-</span> team_lasso <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(game_id) <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">2</span>)</span>
<span id="cb52-9"><a href="#cb52-9"></a></span>
<span id="cb52-10"><a href="#cb52-10"></a>team2_lasso <span class="ot">&lt;-</span> team2_lasso <span class="sc">%&gt;%</span> <span class="fu">rename_with</span>(<span class="sc">~</span><span class="fu">paste0</span>(<span class="st">"opponent_"</span>, .x), <span class="sc">-</span>game_id)</span>
<span id="cb52-11"><a href="#cb52-11"></a></span>
<span id="cb52-12"><a href="#cb52-12"></a>both_teams_lasso <span class="ot">&lt;-</span> <span class="fu">left_join</span>(team1_lasso, team2_lasso, <span class="at">by =</span> <span class="st">"game_id"</span>) </span>
<span id="cb52-13"><a href="#cb52-13"></a></span>
<span id="cb52-14"><a href="#cb52-14"></a>both_teams_lasso <span class="ot">&lt;-</span> both_teams_lasso <span class="sc">%&gt;%</span></span>
<span id="cb52-15"><a href="#cb52-15"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb52-16"><a href="#cb52-16"></a>  <span class="fu">mutate</span>(<span class="at">season_day =</span> <span class="fu">as.numeric</span>(game_date <span class="sc">-</span> <span class="fu">as.Date</span>(<span class="st">"2025-05-16"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb52-17"><a href="#cb52-17"></a>  <span class="fu">select</span>(<span class="sc">-</span>opponent_team_winner, <span class="sc">-</span>game_date, <span class="sc">-</span>opponent_game_date)</span>
<span id="cb52-18"><a href="#cb52-18"></a></span>
<span id="cb52-19"><a href="#cb52-19"></a>lasso_training <span class="ot">&lt;-</span> both_teams_lasso <span class="sc">%&gt;%</span></span>
<span id="cb52-20"><a href="#cb52-20"></a>  <span class="fu">filter</span>(<span class="sc">!</span>game_id<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">"401820329"</span>, <span class="st">"401820326"</span>, <span class="st">"401820325"</span>, <span class="st">"401820322"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb52-21"><a href="#cb52-21"></a>  <span class="fu">select</span>(<span class="sc">-</span>game_id)</span>
<span id="cb52-22"><a href="#cb52-22"></a></span>
<span id="cb52-23"><a href="#cb52-23"></a>lasso_test <span class="ot">&lt;-</span> both_teams_lasso <span class="sc">%&gt;%</span></span>
<span id="cb52-24"><a href="#cb52-24"></a>  <span class="fu">filter</span>(game_id<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">"401820329"</span>, <span class="st">"401820326"</span>, <span class="st">"401820325"</span>, <span class="st">"401820322"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb52-25"><a href="#cb52-25"></a>  <span class="fu">select</span>(<span class="sc">-</span>game_id)</span>
<span id="cb52-26"><a href="#cb52-26"></a></span>
<span id="cb52-27"><a href="#cb52-27"></a><span class="co"># Train</span></span>
<span id="cb52-28"><a href="#cb52-28"></a></span>
<span id="cb52-29"><a href="#cb52-29"></a><span class="co"># model specification</span></span>
<span id="cb52-30"><a href="#cb52-30"></a><span class="fu">set.seed</span>(<span class="dv">212</span>)</span>
<span id="cb52-31"><a href="#cb52-31"></a>model_spec <span class="ot">&lt;-</span> <span class="fu">logistic_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb52-32"><a href="#cb52-32"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb52-33"><a href="#cb52-33"></a>  <span class="fu">set_engine</span>(<span class="st">"glmnet"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-34"><a href="#cb52-34"></a>  <span class="fu">set_args</span>(<span class="at">mixture =</span> <span class="dv">1</span>, <span class="at">penalty =</span> <span class="fu">tune</span>())</span>
<span id="cb52-35"><a href="#cb52-35"></a></span>
<span id="cb52-36"><a href="#cb52-36"></a><span class="co"># variable recipe</span></span>
<span id="cb52-37"><a href="#cb52-37"></a>data_rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(team_winner <span class="sc">~</span> . , <span class="at">data =</span> lasso_training) <span class="sc">%&gt;%</span></span>
<span id="cb52-38"><a href="#cb52-38"></a>  <span class="fu">step_novel</span>(<span class="fu">all_nominal_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb52-39"><a href="#cb52-39"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal_predictors</span>())</span>
<span id="cb52-40"><a href="#cb52-40"></a></span>
<span id="cb52-41"><a href="#cb52-41"></a><span class="co"># workflow (algorithm + recipe)</span></span>
<span id="cb52-42"><a href="#cb52-42"></a>model_wf <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb52-43"><a href="#cb52-43"></a>  <span class="fu">add_recipe</span>(data_rec) <span class="sc">%&gt;%</span></span>
<span id="cb52-44"><a href="#cb52-44"></a>  <span class="fu">add_model</span>(model_spec) </span>
<span id="cb52-45"><a href="#cb52-45"></a></span>
<span id="cb52-46"><a href="#cb52-46"></a><span class="co"># estimate 50 LASSO models</span></span>
<span id="cb52-47"><a href="#cb52-47"></a>multiple_models <span class="ot">&lt;-</span> model_wf <span class="sc">%&gt;%</span></span>
<span id="cb52-48"><a href="#cb52-48"></a> <span class="fu">tune_grid</span>(</span>
<span id="cb52-49"><a href="#cb52-49"></a>    <span class="at">grid =</span> <span class="fu">grid_regular</span>(</span>
<span id="cb52-50"><a href="#cb52-50"></a>      <span class="fu">penalty</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">3</span>)),     </span>
<span id="cb52-51"><a href="#cb52-51"></a>      <span class="at">levels =</span> <span class="dv">50</span></span>
<span id="cb52-52"><a href="#cb52-52"></a>    ),</span>
<span id="cb52-53"><a href="#cb52-53"></a>    <span class="at">resamples =</span> <span class="fu">vfold_cv</span>(lasso_training, <span class="at">v =</span> <span class="dv">10</span>),</span>
<span id="cb52-54"><a href="#cb52-54"></a>    <span class="at">metrics =</span> <span class="fu">metric_set</span>(accuracy)</span>
<span id="cb52-55"><a href="#cb52-55"></a> )</span>
<span id="cb52-56"><a href="#cb52-56"></a></span>
<span id="cb52-57"><a href="#cb52-57"></a><span class="co"># determine parsimonious parameter</span></span>
<span id="cb52-58"><a href="#cb52-58"></a>parsimonious_param <span class="ot">&lt;-</span> multiple_models <span class="sc">%&gt;%</span>   </span>
<span id="cb52-59"><a href="#cb52-59"></a>  <span class="fu">select_by_one_std_err</span>(<span class="at">metric =</span> <span class="st">"accuracy"</span>, <span class="fu">desc</span>(penalty))</span>
<span id="cb52-60"><a href="#cb52-60"></a></span>
<span id="cb52-61"><a href="#cb52-61"></a><span class="co"># determine best (highest accuracy) parameter</span></span>
<span id="cb52-62"><a href="#cb52-62"></a>best_param <span class="ot">&lt;-</span> multiple_models <span class="sc">%&gt;%</span>   </span>
<span id="cb52-63"><a href="#cb52-63"></a>  <span class="fu">select_best</span>(<span class="at">metric =</span> <span class="st">"accuracy"</span>)</span>
<span id="cb52-64"><a href="#cb52-64"></a></span>
<span id="cb52-65"><a href="#cb52-65"></a><span class="co"># build final parsimonious model</span></span>
<span id="cb52-66"><a href="#cb52-66"></a>final_model <span class="ot">&lt;-</span> model_wf <span class="sc">%&gt;%</span> </span>
<span id="cb52-67"><a href="#cb52-67"></a>  <span class="fu">finalize_workflow</span>(parsimonious_param) <span class="sc">%&gt;%</span> </span>
<span id="cb52-68"><a href="#cb52-68"></a>  <span class="fu">fit</span>(<span class="at">data =</span> lasso_training)</span>
<span id="cb52-69"><a href="#cb52-69"></a></span>
<span id="cb52-70"><a href="#cb52-70"></a><span class="co"># print coefficients</span></span>
<span id="cb52-71"><a href="#cb52-71"></a>final_model <span class="sc">%&gt;%</span></span>
<span id="cb52-72"><a href="#cb52-72"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span></span>
<span id="cb52-73"><a href="#cb52-73"></a>  <span class="fu">filter</span>(estimate <span class="sc">!=</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 22 × 3
   term                         estimate penalty
   &lt;chr&gt;                           &lt;dbl&gt;   &lt;dbl&gt;
 1 (Intercept)                   -2.38    0.0268
 2 assists                        0.0592  0.0268
 3 field_goal_pct                 0.0365  0.0268
 4 field_goals_made               0.327   0.0268
 5 free_throws_made               0.181   0.0268
 6 three_point_field_goals_made   0.155   0.0268
 7 opponent_assists              -0.0197  0.0268
 8 opponent_field_goal_pct       -0.0253  0.0268
 9 opponent_field_goals_made     -0.285   0.0268
10 opponent_free_throws_made     -0.187   0.0268
# ℹ 12 more rows</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a>multiple_models <span class="sc">%&gt;%</span> </span>
<span id="cb54-2"><a href="#cb54-2"></a>  <span class="fu">collect_metrics</span>() <span class="sc">%&gt;%</span></span>
<span id="cb54-3"><a href="#cb54-3"></a>  <span class="fu">filter</span>(penalty <span class="sc">==</span> parsimonious_param<span class="sc">$</span>penalty)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 7
  penalty .metric  .estimator  mean     n std_err .config         
    &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;           
1  0.0268 accuracy binary     0.964    10  0.0114 pre0_mod22_post0</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a>multiple_models <span class="sc">%&gt;%</span></span>
<span id="cb56-2"><a href="#cb56-2"></a>  <span class="fu">autoplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="wa-member1_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a>final_model <span class="sc">%&gt;%</span> <span class="co"># name of your final model</span></span>
<span id="cb57-2"><a href="#cb57-2"></a>  <span class="fu">augment</span>(<span class="at">new_data =</span> lasso_test) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 61
  .pred_class .pred_FALSE .pred_TRUE team_name team_home_away team_winner
  &lt;fct&gt;             &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;          &lt;fct&gt;      
1 FALSE             0.615      0.385 Mercury   away           FALSE      
2 FALSE             0.864      0.136 Mercury   away           FALSE      
3 TRUE              0.381      0.619 Aces      away           TRUE       
4 TRUE              0.149      0.851 Aces      away           TRUE       
# ℹ 55 more variables: assists &lt;int&gt;, blocks &lt;int&gt;, defensive_rebounds &lt;int&gt;,
#   fast_break_points &lt;chr&gt;, field_goal_pct &lt;dbl&gt;, field_goals_made &lt;int&gt;,
#   field_goals_attempted &lt;int&gt;, flagrant_fouls &lt;int&gt;, fouls &lt;int&gt;,
#   free_throw_pct &lt;dbl&gt;, free_throws_made &lt;int&gt;, free_throws_attempted &lt;int&gt;,
#   largest_lead &lt;chr&gt;, offensive_rebounds &lt;int&gt;, points_in_paint &lt;chr&gt;,
#   steals &lt;int&gt;, team_turnovers &lt;int&gt;, technical_fouls &lt;int&gt;,
#   three_point_field_goal_pct &lt;dbl&gt;, three_point_field_goals_made &lt;int&gt;, …</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a>final_model <span class="sc">%&gt;%</span></span>
<span id="cb59-2"><a href="#cb59-2"></a>  <span class="fu">augment</span>(<span class="at">new_data =</span> lasso_test) <span class="sc">%&gt;%</span></span>
<span id="cb59-3"><a href="#cb59-3"></a>  <span class="fu">accuracy</span>(<span class="at">truth =</span> team_winner, <span class="at">estimate =</span> .pred_class)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  .metric  .estimator .estimate
  &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;
1 accuracy binary             1</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a>final_model <span class="sc">%&gt;%</span></span>
<span id="cb61-2"><a href="#cb61-2"></a>  <span class="fu">augment</span>(<span class="at">new_data =</span> lasso_test) <span class="sc">%&gt;%</span></span>
<span id="cb61-3"><a href="#cb61-3"></a>  <span class="fu">conf_mat</span>(<span class="at">truth =</span> team_winner, <span class="at">estimate =</span> .pred_class)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          Truth
Prediction FALSE TRUE
     FALSE     2    0
     TRUE      0    2</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="co"># predicting teams in the playoffs using random forest</span></span>
<span id="cb63-2"><a href="#cb63-2"></a>wnba_team_lasso <span class="ot">&lt;-</span> wnba_team_box <span class="sc">%&gt;%</span></span>
<span id="cb63-3"><a href="#cb63-3"></a>  <span class="fu">filter</span>(game_id <span class="sc">!=</span> <span class="dv">401781604</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-4"><a href="#cb63-4"></a>  <span class="fu">select</span>(<span class="sc">-</span>season, <span class="sc">-</span>game_date_time, <span class="sc">-</span>team_id, <span class="sc">-</span>team_uid, <span class="sc">-</span>team_slug, <span class="sc">-</span>team_location, <span class="sc">-</span>team_abbreviation, <span class="sc">-</span>team_display_name, <span class="sc">-</span>team_short_display_name, <span class="sc">-</span>team_color, <span class="sc">-</span>team_alternate_color, <span class="sc">-</span>team_logo, <span class="sc">-</span>opponent_team_id, <span class="sc">-</span>opponent_team_uid, <span class="sc">-</span>opponent_team_slug, <span class="sc">-</span>opponent_team_location, <span class="sc">-</span>opponent_team_abbreviation, <span class="sc">-</span>opponent_team_display_name, <span class="sc">-</span>opponent_team_short_display_name, <span class="sc">-</span>opponent_team_color, <span class="sc">-</span>opponent_team_alternate_color, <span class="sc">-</span>opponent_team_logo, <span class="sc">-</span>opponent_team_name) <span class="sc">%&gt;%</span></span>
<span id="cb63-5"><a href="#cb63-5"></a>  <span class="fu">mutate</span>(</span>
<span id="cb63-6"><a href="#cb63-6"></a>    <span class="at">team_winner =</span> <span class="fu">factor</span>(team_winner),</span>
<span id="cb63-7"><a href="#cb63-7"></a>    <span class="at">team_name =</span> <span class="fu">factor</span>(team_name),</span>
<span id="cb63-8"><a href="#cb63-8"></a>    <span class="at">largest_lead =</span> <span class="fu">as.numeric</span>(largest_lead),</span>
<span id="cb63-9"><a href="#cb63-9"></a>    <span class="at">fast_break_points =</span> <span class="fu">as.numeric</span>(fast_break_points),</span>
<span id="cb63-10"><a href="#cb63-10"></a>    <span class="at">turnover_points =</span> <span class="fu">as.numeric</span>(turnover_points)) <span class="sc">%&gt;%</span> </span>
<span id="cb63-11"><a href="#cb63-11"></a>  <span class="fu">mutate</span>(<span class="at">season_day =</span> <span class="fu">as.numeric</span>(game_date <span class="sc">-</span> <span class="fu">as.Date</span>(<span class="st">"2025-05-16"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb63-12"><a href="#cb63-12"></a>  <span class="fu">select</span>(<span class="sc">-</span>game_date)</span>
<span id="cb63-13"><a href="#cb63-13"></a></span>
<span id="cb63-14"><a href="#cb63-14"></a>lasso_training <span class="ot">&lt;-</span> wnba_team_lasso <span class="sc">%&gt;%</span></span>
<span id="cb63-15"><a href="#cb63-15"></a>  <span class="fu">filter</span>(season_type <span class="sc">!=</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-16"><a href="#cb63-16"></a>  <span class="fu">select</span>(<span class="sc">-</span>game_id, <span class="sc">-</span>season_type)</span>
<span id="cb63-17"><a href="#cb63-17"></a></span>
<span id="cb63-18"><a href="#cb63-18"></a>lasso_test <span class="ot">&lt;-</span> wnba_team_lasso <span class="sc">%&gt;%</span></span>
<span id="cb63-19"><a href="#cb63-19"></a>  <span class="fu">filter</span>(season_type <span class="sc">==</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-20"><a href="#cb63-20"></a>  <span class="fu">select</span>(<span class="sc">-</span>game_id, <span class="sc">-</span>season_type)</span>
<span id="cb63-21"><a href="#cb63-21"></a></span>
<span id="cb63-22"><a href="#cb63-22"></a><span class="co"># model specification</span></span>
<span id="cb63-23"><a href="#cb63-23"></a><span class="fu">set.seed</span>(<span class="dv">212</span>)</span>
<span id="cb63-24"><a href="#cb63-24"></a><span class="co"># STEP 1: Model Specification</span></span>
<span id="cb63-25"><a href="#cb63-25"></a>rf_spec <span class="ot">&lt;-</span> <span class="fu">rand_forest</span>()  <span class="sc">%&gt;%</span></span>
<span id="cb63-26"><a href="#cb63-26"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-27"><a href="#cb63-27"></a>  <span class="fu">set_engine</span>(<span class="at">engine =</span> <span class="st">"ranger"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb63-28"><a href="#cb63-28"></a>  <span class="fu">set_args</span>(</span>
<span id="cb63-29"><a href="#cb63-29"></a>    <span class="at">mtry =</span> <span class="cn">NULL</span>,</span>
<span id="cb63-30"><a href="#cb63-30"></a>    <span class="at">trees =</span> <span class="dv">500</span>,</span>
<span id="cb63-31"><a href="#cb63-31"></a>    <span class="at">min_n =</span> <span class="dv">2</span>,</span>
<span id="cb63-32"><a href="#cb63-32"></a>    <span class="at">probability =</span> <span class="cn">FALSE</span>, <span class="co"># give classifications, not probability calculations</span></span>
<span id="cb63-33"><a href="#cb63-33"></a>    <span class="at">importance =</span> <span class="st">"impurity"</span> <span class="co"># use Gini index to measure variable importance</span></span>
<span id="cb63-34"><a href="#cb63-34"></a>  )</span>
<span id="cb63-35"><a href="#cb63-35"></a></span>
<span id="cb63-36"><a href="#cb63-36"></a><span class="co"># STEP 2: Build the forest or bagging model</span></span>
<span id="cb63-37"><a href="#cb63-37"></a><span class="co"># There are no preprocessing steps or tuning, hence no need for a workflow!</span></span>
<span id="cb63-38"><a href="#cb63-38"></a>ensemble_model <span class="ot">&lt;-</span> rf_spec <span class="sc">%&gt;%</span> </span>
<span id="cb63-39"><a href="#cb63-39"></a>  <span class="fu">fit</span>(team_name <span class="sc">~</span> ., <span class="at">data =</span> lasso_training)</span>
<span id="cb63-40"><a href="#cb63-40"></a></span>
<span id="cb63-41"><a href="#cb63-41"></a></span>
<span id="cb63-42"><a href="#cb63-42"></a><span class="co"># Put in a data.frame object with x1 and x2 values (at minimum)</span></span>
<span id="cb63-43"><a href="#cb63-43"></a>ensemble_model <span class="sc">%&gt;%</span> </span>
<span id="cb63-44"><a href="#cb63-44"></a>  <span class="fu">predict</span>(<span class="at">new_data =</span> lasso_test)  </span>
<span id="cb63-45"><a href="#cb63-45"></a></span>
<span id="cb63-46"><a href="#cb63-46"></a><span class="co"># Out-of-bag (OOB) prediction error</span></span>
<span id="cb63-47"><a href="#cb63-47"></a>ensemble_model</span>
<span id="cb63-48"><a href="#cb63-48"></a></span>
<span id="cb63-49"><a href="#cb63-49"></a><span class="co"># OOB confusion matrix</span></span>
<span id="cb63-50"><a href="#cb63-50"></a>ensemble_model <span class="sc">%&gt;%</span> </span>
<span id="cb63-51"><a href="#cb63-51"></a>  <span class="fu">extract_fit_engine</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb63-52"><a href="#cb63-52"></a>  <span class="fu">pluck</span>(<span class="st">"confusion.matrix"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb63-53"><a href="#cb63-53"></a>  <span class="fu">t</span>()</span>
<span id="cb63-54"><a href="#cb63-54"></a></span>
<span id="cb63-55"><a href="#cb63-55"></a>ensemble_model <span class="sc">%&gt;%</span> </span>
<span id="cb63-56"><a href="#cb63-56"></a>  <span class="fu">predict</span>(<span class="at">new_data =</span> lasso_test) <span class="sc">%&gt;%</span> </span>
<span id="cb63-57"><a href="#cb63-57"></a>  <span class="fu">cbind</span>(lasso_test) <span class="sc">%&gt;%</span> </span>
<span id="cb63-58"><a href="#cb63-58"></a>  <span class="fu">conf_mat</span>(</span>
<span id="cb63-59"><a href="#cb63-59"></a>    <span class="at">truth =</span> team_name,</span>
<span id="cb63-60"><a href="#cb63-60"></a>    <span class="at">estimate =</span> .pred_class</span>
<span id="cb63-61"><a href="#cb63-61"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="co"># PCA on player dataset</span></span>
<span id="cb64-2"><a href="#cb64-2"></a>PCA_player <span class="ot">&lt;-</span> wnba_player_box <span class="sc">%&gt;%</span></span>
<span id="cb64-3"><a href="#cb64-3"></a>  <span class="fu">filter</span>(game_id <span class="sc">!=</span> <span class="dv">401781604</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-4"><a href="#cb64-4"></a>  <span class="fu">group_by</span>(athlete_display_name, team_name) <span class="sc">%&gt;%</span></span>
<span id="cb64-5"><a href="#cb64-5"></a>  <span class="fu">mutate</span>(<span class="at">player_unique =</span> <span class="fu">paste0</span>(athlete_display_name, <span class="st">"_"</span>, team_name)) <span class="sc">%&gt;%</span></span>
<span id="cb64-6"><a href="#cb64-6"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb64-7"><a href="#cb64-7"></a>  <span class="fu">group_by</span>(player_unique, team_name) <span class="sc">%&gt;%</span></span>
<span id="cb64-8"><a href="#cb64-8"></a>  <span class="fu">summarize</span>(</span>
<span id="cb64-9"><a href="#cb64-9"></a>    <span class="at">athlete_display_name =</span> <span class="fu">first</span>(athlete_display_name),</span>
<span id="cb64-10"><a href="#cb64-10"></a>    <span class="at">avg_minutes =</span> <span class="fu">mean</span>(minutes, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-11"><a href="#cb64-11"></a>    <span class="at">avg_field_goals_made =</span> <span class="fu">mean</span>(field_goals_made, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-12"><a href="#cb64-12"></a>    <span class="at">avg_field_goals_attempted =</span> <span class="fu">mean</span>(field_goals_attempted, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-13"><a href="#cb64-13"></a>    <span class="at">avg_threes_made =</span> <span class="fu">mean</span>(three_point_field_goals_made, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-14"><a href="#cb64-14"></a>    <span class="at">avg_threes_attempted =</span> <span class="fu">mean</span>(three_point_field_goals_attempted, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-15"><a href="#cb64-15"></a>    <span class="at">avg_free_throws_made =</span> <span class="fu">mean</span>(free_throws_made, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-16"><a href="#cb64-16"></a>    <span class="at">avg_free_throws_attempted =</span> <span class="fu">mean</span>(free_throws_attempted, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-17"><a href="#cb64-17"></a>    <span class="at">avg_free_throws_attempted =</span> <span class="fu">mean</span>(free_throws_attempted, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-18"><a href="#cb64-18"></a>    <span class="at">avg_ppg =</span> <span class="fu">mean</span>(points, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-19"><a href="#cb64-19"></a>    <span class="at">avg_blocks =</span> <span class="fu">mean</span>(blocks, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-20"><a href="#cb64-20"></a>    <span class="at">avg_rebounds =</span> <span class="fu">mean</span>(rebounds, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-21"><a href="#cb64-21"></a>    <span class="at">avg_offensive_rebounds =</span> <span class="fu">mean</span>(offensive_rebounds, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-22"><a href="#cb64-22"></a>    <span class="at">avg_defensive_rebounds =</span> <span class="fu">mean</span>(offensive_rebounds, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-23"><a href="#cb64-23"></a>    <span class="at">avg_assists =</span> <span class="fu">mean</span>(assists, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-24"><a href="#cb64-24"></a>    <span class="at">avg_steals =</span> <span class="fu">mean</span>(steals, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-25"><a href="#cb64-25"></a>    <span class="at">avg_turnovers =</span> <span class="fu">mean</span>(turnovers, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-26"><a href="#cb64-26"></a>    <span class="at">avg_fouls =</span> <span class="fu">mean</span>(fouls, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-27"><a href="#cb64-27"></a>    <span class="at">games_started =</span> <span class="fu">sum</span>(starter, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-28"><a href="#cb64-28"></a>    <span class="at">games_ejected =</span> <span class="fu">sum</span>(ejected, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb64-29"><a href="#cb64-29"></a>    <span class="at">games_did_not_play =</span> <span class="fu">sum</span>(did_not_play, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-30"><a href="#cb64-30"></a>    <span class="at">mean_plus_minus =</span> <span class="fu">mean</span>(<span class="fu">as.numeric</span>(plus_minus), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-31"><a href="#cb64-31"></a>    <span class="at">position =</span> <span class="fu">names</span>(<span class="fu">which.max</span>(<span class="fu">table</span>(athlete_position_name, <span class="at">useNA =</span> <span class="st">"no"</span>))),</span>
<span id="cb64-32"><a href="#cb64-32"></a>    <span class="at">wins =</span> <span class="fu">sum</span>(team_winner),</span>
<span id="cb64-33"><a href="#cb64-33"></a>    <span class="at">avg_team_score =</span> <span class="fu">mean</span>(team_score)</span>
<span id="cb64-34"><a href="#cb64-34"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb64-35"><a href="#cb64-35"></a>  <span class="fu">left_join</span>(salary_df, <span class="at">by =</span> <span class="fu">join_by</span>(athlete_display_name <span class="sc">==</span> name, team_name <span class="sc">==</span> team_name)) <span class="sc">%&gt;%</span></span>
<span id="cb64-36"><a href="#cb64-36"></a>  <span class="fu">left_join</span>(PIE, <span class="at">by =</span> <span class="fu">join_by</span>(athlete_display_name <span class="sc">==</span> athlete_display_name, team_name <span class="sc">==</span> team_name)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-37"><a href="#cb64-37"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">ifelse</span>(<span class="fu">is.nan</span>(.), <span class="cn">NA</span>, .))) <span class="sc">%&gt;%</span></span>
<span id="cb64-38"><a href="#cb64-38"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb64-39"><a href="#cb64-39"></a></span>
<span id="cb64-40"><a href="#cb64-40"></a>PCA_player <span class="ot">&lt;-</span> PCA_player[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">21</span>, <span class="dv">30</span>, <span class="dv">41</span>, <span class="dv">47</span>, <span class="dv">49</span>, <span class="dv">72</span>, <span class="dv">76</span>, <span class="dv">78</span>, <span class="dv">79</span>, <span class="dv">98</span>, <span class="dv">99</span>, <span class="dv">116</span>, <span class="dv">117</span>, <span class="dv">138</span>, <span class="dv">165</span>, <span class="dv">189</span>), ] </span>
<span id="cb64-41"><a href="#cb64-41"></a></span>
<span id="cb64-42"><a href="#cb64-42"></a>PCA_player <span class="ot">&lt;-</span> PCA_player <span class="sc">%&gt;%</span></span>
<span id="cb64-43"><a href="#cb64-43"></a>  <span class="fu">select</span>(<span class="sc">-</span>athlete_display_name) <span class="sc">%&gt;%</span></span>
<span id="cb64-44"><a href="#cb64-44"></a>  <span class="fu">column_to_rownames</span>(<span class="st">"player_unique"</span>)</span>
<span id="cb64-45"><a href="#cb64-45"></a></span>
<span id="cb64-46"><a href="#cb64-46"></a>PCA_player_dummy <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">model.matrix</span>(<span class="sc">~</span> . <span class="sc">-</span> <span class="dv">1</span>, PCA_player))</span>
<span id="cb64-47"><a href="#cb64-47"></a></span>
<span id="cb64-48"><a href="#cb64-48"></a>PCA_player_dummy <span class="ot">&lt;-</span> PCA_player_dummy <span class="sc">%&gt;%</span></span>
<span id="cb64-49"><a href="#cb64-49"></a>  <span class="fu">select</span>(<span class="sc">-</span>contractBuyout, <span class="sc">-</span>games_ejected)</span>
<span id="cb64-50"><a href="#cb64-50"></a></span>
<span id="cb64-51"><a href="#cb64-51"></a><span class="co"># scale = TRUE, center = TRUE first standardizes the features</span></span>
<span id="cb64-52"><a href="#cb64-52"></a>pca_results <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(PCA_player_dummy, <span class="at">scale =</span> <span class="cn">TRUE</span>, <span class="at">center =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="co"># Get the loadings which define the PCs</span></span>
<span id="cb65-2"><a href="#cb65-2"></a><span class="co"># pca_results %&gt;% </span></span>
<span id="cb65-3"><a href="#cb65-3"></a><span class="co">#  pluck("rotation")</span></span>
<span id="cb65-4"><a href="#cb65-4"></a></span>
<span id="cb65-5"><a href="#cb65-5"></a><span class="fu">melt</span>(pca_results<span class="sc">$</span>rotation) <span class="sc">%&gt;%</span></span>
<span id="cb65-6"><a href="#cb65-6"></a>  <span class="fu">filter</span>(Var2 <span class="sc">==</span> <span class="st">"PC1"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb65-7"><a href="#cb65-7"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Var1, <span class="at">y =</span> value, <span class="at">fill =</span> Var1)) <span class="sc">+</span></span>
<span id="cb65-8"><a href="#cb65-8"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb65-9"><a href="#cb65-9"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"loadings"</span>, <span class="at">x =</span> <span class="st">"original features"</span>, <span class="at">fill =</span> <span class="st">"original features"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="wa-member1_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="co"># Plot loadings for first "k" PCs (you pick k)</span></span>
<span id="cb66-2"><a href="#cb66-2"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb66-3"><a href="#cb66-3"></a><span class="fu">melt</span>(pca_results<span class="sc">$</span>rotation[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb66-4"><a href="#cb66-4"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Var1, <span class="at">y =</span> value, <span class="at">fill =</span> Var1)) <span class="sc">+</span></span>
<span id="cb66-5"><a href="#cb66-5"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb66-6"><a href="#cb66-6"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> Var2) <span class="sc">+</span> </span>
<span id="cb66-7"><a href="#cb66-7"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"loadings"</span>, <span class="at">x =</span> <span class="st">"original features"</span>, <span class="at">fill =</span> <span class="st">"original features"</span>) <span class="sc">+</span></span>
<span id="cb66-8"><a href="#cb66-8"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb66-9"><a href="#cb66-9"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="wa-member1_files/figure-html/unnamed-chunk-25-2.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a><span class="co"># Loadings plot for first 2 PCs</span></span>
<span id="cb67-2"><a href="#cb67-2"></a><span class="fu">fviz_pca_var</span>(pca_results, <span class="at">repel =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="wa-member1_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="co"># Numerical summaries: Measure information captured by each PC</span></span>
<span id="cb68-2"><a href="#cb68-2"></a>pca_results <span class="sc">%&gt;%</span> </span>
<span id="cb68-3"><a href="#cb68-3"></a>  <span class="fu">tidy</span>(<span class="at">matrix =</span> <span class="st">"eigenvalues"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 55 × 4
      PC std.dev percent cumulative
   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;
 1     1    3.57  0.232       0.232
 2     2    1.97  0.0705      0.302
 3     3    1.90  0.0656      0.368
 4     4    1.58  0.0455      0.413
 5     5    1.56  0.0441      0.457
 6     6    1.55  0.0434      0.501
 7     7    1.52  0.0419      0.543
 8     8    1.51  0.0417      0.584
 9     9    1.50  0.0407      0.625
10    10    1.48  0.0399      0.665
# ℹ 45 more rows</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a><span class="co"># Graphical summary 1: SCREE PLOT</span></span>
<span id="cb70-2"><a href="#cb70-2"></a><span class="co"># Plot % of variance explained by each PC</span></span>
<span id="cb70-3"><a href="#cb70-3"></a>pca_results <span class="sc">%&gt;%</span> </span>
<span id="cb70-4"><a href="#cb70-4"></a>  <span class="fu">tidy</span>(<span class="at">matrix =</span> <span class="st">"eigenvalues"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb70-5"><a href="#cb70-5"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> percent, <span class="at">x =</span> PC)) <span class="sc">+</span> </span>
<span id="cb70-6"><a href="#cb70-6"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb70-7"><a href="#cb70-7"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb70-8"><a href="#cb70-8"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"% of variance explained"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="wa-member1_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a><span class="co"># Graphical summary 2: Plot cumulative % of variance explained by each PC</span></span>
<span id="cb71-2"><a href="#cb71-2"></a>pca_results <span class="sc">%&gt;%</span> </span>
<span id="cb71-3"><a href="#cb71-3"></a>  <span class="fu">tidy</span>(<span class="at">matrix =</span> <span class="st">"eigenvalues"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb71-4"><a href="#cb71-4"></a>  <span class="fu">rbind</span>(<span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb71-5"><a href="#cb71-5"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> cumulative, <span class="at">x =</span> PC)) <span class="sc">+</span> </span>
<span id="cb71-6"><a href="#cb71-6"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb71-7"><a href="#cb71-7"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb71-8"><a href="#cb71-8"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"CUMULATIVE % of variance explained"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="wa-member1_files/figure-html/unnamed-chunk-27-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a><span class="co"># Numerical summary: check out the scores</span></span>
<span id="cb72-2"><a href="#cb72-2"></a><span class="co"># pca_results %&gt;% </span></span>
<span id="cb72-3"><a href="#cb72-3"></a><span class="co">#  pluck("x")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a><span class="co"># Graphical summary: Score plot</span></span>
<span id="cb73-2"><a href="#cb73-2"></a><span class="co"># Plot PC1 scores (x-axis) vs PC2 scores (y-axis) of all data points</span></span>
<span id="cb73-3"><a href="#cb73-3"></a><span class="fu">fviz_pca_ind</span>(</span>
<span id="cb73-4"><a href="#cb73-4"></a>  pca_results, </span>
<span id="cb73-5"><a href="#cb73-5"></a>  <span class="at">repel =</span> <span class="cn">TRUE</span>, </span>
<span id="cb73-6"><a href="#cb73-6"></a>  <span class="at">label =</span> <span class="st">"none"</span>,</span>
<span id="cb73-7"><a href="#cb73-7"></a>  <span class="at">col.ind =</span> PCA_player<span class="sc">$</span>avg_PIE, </span>
<span id="cb73-8"><a href="#cb73-8"></a>  <span class="at">gradient.cols =</span> <span class="fu">c</span>(<span class="st">"lightyellow"</span>, <span class="st">"red"</span>),</span>
<span id="cb73-9"><a href="#cb73-9"></a>  <span class="at">legend.title =</span> <span class="st">"Average PIE"</span>,</span>
<span id="cb73-10"><a href="#cb73-10"></a>  <span class="at">title =</span> <span class="st">"PCA Score Plot"</span></span>
<span id="cb73-11"><a href="#cb73-11"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="wa-member1_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a><span class="fu">fviz_pca_ind</span>(</span>
<span id="cb74-2"><a href="#cb74-2"></a>  pca_results, </span>
<span id="cb74-3"><a href="#cb74-3"></a>  <span class="at">repel =</span> <span class="cn">TRUE</span>, </span>
<span id="cb74-4"><a href="#cb74-4"></a>  <span class="at">label =</span> <span class="st">"none"</span>,</span>
<span id="cb74-5"><a href="#cb74-5"></a>  <span class="at">col.ind =</span> PCA_player<span class="sc">$</span>wins, </span>
<span id="cb74-6"><a href="#cb74-6"></a>  <span class="at">gradient.cols =</span> <span class="fu">c</span>(<span class="st">"lightyellow"</span>, <span class="st">"red"</span>),</span>
<span id="cb74-7"><a href="#cb74-7"></a>  <span class="at">legend.title =</span> <span class="st">"Number of Wins"</span>,</span>
<span id="cb74-8"><a href="#cb74-8"></a>  <span class="at">title =</span> <span class="st">"PCA Score Plot"</span></span>
<span id="cb74-9"><a href="#cb74-9"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="wa-member1_files/figure-html/unnamed-chunk-28-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a><span class="fu">fviz_pca_ind</span>(</span>
<span id="cb75-2"><a href="#cb75-2"></a>  pca_results, </span>
<span id="cb75-3"><a href="#cb75-3"></a>  <span class="at">repel =</span> <span class="cn">TRUE</span>, </span>
<span id="cb75-4"><a href="#cb75-4"></a>  <span class="at">label =</span> <span class="st">"none"</span>,</span>
<span id="cb75-5"><a href="#cb75-5"></a>  <span class="at">habillage =</span> <span class="fu">factor</span>(PCA_player<span class="sc">$</span>team_name),</span>
<span id="cb75-6"><a href="#cb75-6"></a>  <span class="at">geom =</span> <span class="st">"point"</span>,</span>
<span id="cb75-7"><a href="#cb75-7"></a>  <span class="at">pointshape =</span> <span class="dv">19</span>,</span>
<span id="cb75-8"><a href="#cb75-8"></a>  <span class="at">addEllipses =</span> <span class="cn">TRUE</span>, </span>
<span id="cb75-9"><a href="#cb75-9"></a>  <span class="at">ellipse.level=</span><span class="fl">0.95</span>,</span>
<span id="cb75-10"><a href="#cb75-10"></a>  <span class="at">legend.title =</span> <span class="st">"Team"</span>,</span>
<span id="cb75-11"><a href="#cb75-11"></a>  <span class="at">title =</span> <span class="st">"PCA Score Plot"</span></span>
<span id="cb75-12"><a href="#cb75-12"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="wa-member1_files/figure-html/unnamed-chunk-28-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a><span class="fu">fviz_pca_ind</span>(</span>
<span id="cb76-2"><a href="#cb76-2"></a>  pca_results, </span>
<span id="cb76-3"><a href="#cb76-3"></a>  <span class="at">repel =</span> <span class="cn">TRUE</span>, </span>
<span id="cb76-4"><a href="#cb76-4"></a>  <span class="at">label =</span> <span class="st">"none"</span>,</span>
<span id="cb76-5"><a href="#cb76-5"></a>  <span class="at">habillage =</span> PCA_player<span class="sc">$</span>position,</span>
<span id="cb76-6"><a href="#cb76-6"></a>  <span class="at">geom =</span> <span class="st">"point"</span>,</span>
<span id="cb76-7"><a href="#cb76-7"></a>  <span class="at">pointshape =</span> <span class="dv">19</span>,</span>
<span id="cb76-8"><a href="#cb76-8"></a>  <span class="at">addEllipses =</span> <span class="cn">TRUE</span></span>
<span id="cb76-9"><a href="#cb76-9"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="wa-member1_files/figure-html/unnamed-chunk-28-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a><span class="co"># K Means (from PCA)</span></span>
<span id="cb77-2"><a href="#cb77-2"></a>pca_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pca_results<span class="sc">$</span>x[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb77-3"><a href="#cb77-3"></a></span>
<span id="cb77-4"><a href="#cb77-4"></a><span class="fu">colnames</span>(pca_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"PC1"</span>, <span class="st">"PC2"</span>)</span>
<span id="cb77-5"><a href="#cb77-5"></a></span>
<span id="cb77-6"><a href="#cb77-6"></a><span class="fu">set.seed</span>(<span class="dv">212</span>)</span>
<span id="cb77-7"><a href="#cb77-7"></a>kmeans_pca_model <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(<span class="fu">scale</span>(pca_df), <span class="at">centers =</span> <span class="dv">4</span>)</span>
<span id="cb77-8"><a href="#cb77-8"></a></span>
<span id="cb77-9"><a href="#cb77-9"></a>pca_df <span class="sc">%&gt;%</span> </span>
<span id="cb77-10"><a href="#cb77-10"></a>  <span class="fu">mutate</span>(<span class="at">kmeans_cluster =</span> <span class="fu">as.factor</span>(kmeans_pca_model<span class="sc">$</span>cluster)) <span class="sc">%&gt;%</span></span>
<span id="cb77-11"><a href="#cb77-11"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PC1, <span class="at">y =</span> PC2, <span class="at">color =</span> kmeans_cluster)) <span class="sc">+</span> </span>
<span id="cb77-12"><a href="#cb77-12"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb77-13"><a href="#cb77-13"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb77-14"><a href="#cb77-14"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"K-means with K = 3 (round 2)"</span>) <span class="sc">+</span> </span>
<span id="cb77-15"><a href="#cb77-15"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="wa-member1_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a>k_means_pca_cluster <span class="ot">&lt;-</span> pca_df <span class="sc">%&gt;%</span> </span>
<span id="cb78-2"><a href="#cb78-2"></a>  <span class="fu">mutate</span>(<span class="at">kmean_cluster_k =</span> <span class="fu">as.factor</span>(kmeans_pca_model<span class="sc">$</span>cluster)) <span class="sc">%&gt;%</span></span>
<span id="cb78-3"><a href="#cb78-3"></a>  <span class="fu">group_by</span>(kmean_cluster_k) <span class="sc">%&gt;%</span></span>
<span id="cb78-4"><a href="#cb78-4"></a>  <span class="fu">summarise_all</span>(mean)</span>
<span id="cb78-5"><a href="#cb78-5"></a></span>
<span id="cb78-6"><a href="#cb78-6"></a><span class="fu">head</span>(k_means_pca_cluster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  kmean_cluster_k   PC1   PC2
  &lt;fct&gt;           &lt;dbl&gt; &lt;dbl&gt;
1 1               -1.69 -1.45
2 2                3.41 -2.58
3 3               -2.82  1.29
4 4                4.16  1.58</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a><span class="co"># Get the "the total within- cluster sum of squares"</span></span>
<span id="cb80-2"><a href="#cb80-2"></a><span class="co"># This is the total squared distance of each case from its assigned centroid</span></span>
<span id="cb80-3"><a href="#cb80-3"></a>kmeans_pca_model<span class="sc">$</span>tot.withinss</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 110.6355</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a><span class="co"># K Means (OG data)</span></span>
<span id="cb82-2"><a href="#cb82-2"></a><span class="fu">set.seed</span>(<span class="dv">212</span>)</span>
<span id="cb82-3"><a href="#cb82-3"></a>kmeans_model <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(<span class="fu">scale</span>(PCA_player_dummy), <span class="at">centers =</span> <span class="dv">4</span>)</span>
<span id="cb82-4"><a href="#cb82-4"></a></span>
<span id="cb82-5"><a href="#cb82-5"></a>k_means_cluster <span class="ot">&lt;-</span> PCA_player_dummy <span class="sc">%&gt;%</span> </span>
<span id="cb82-6"><a href="#cb82-6"></a>  <span class="fu">mutate</span>(<span class="at">kmean_cluster_k =</span> <span class="fu">as.factor</span>(kmeans_model<span class="sc">$</span>cluster)) <span class="sc">%&gt;%</span></span>
<span id="cb82-7"><a href="#cb82-7"></a>  <span class="fu">group_by</span>(kmean_cluster_k) <span class="sc">%&gt;%</span></span>
<span id="cb82-8"><a href="#cb82-8"></a>  <span class="fu">summarise_all</span>(mean)</span>
<span id="cb82-9"><a href="#cb82-9"></a></span>
<span id="cb82-10"><a href="#cb82-10"></a><span class="fu">head</span>(k_means_cluster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 56
  kmean_cluster_k team_nameAces team_nameDream team_nameFever team_nameLiberty
  &lt;fct&gt;                   &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;            &lt;dbl&gt;
1 1                      0.130          0.0519         0.104            0.0649
2 2                      0.0345         0.103          0.0690           0.0690
3 3                      0              0.0385         0.115            0.0385
4 4                      0.129          0.0968         0.0645           0.129 
# ℹ 51 more variables: team_nameLynx &lt;dbl&gt;, team_nameMercury &lt;dbl&gt;,
#   team_nameMystics &lt;dbl&gt;, team_nameSky &lt;dbl&gt;, team_nameSparks &lt;dbl&gt;,
#   team_nameStorm &lt;dbl&gt;, team_nameSun &lt;dbl&gt;, team_nameValkyries &lt;dbl&gt;,
#   team_nameWings &lt;dbl&gt;, avg_minutes &lt;dbl&gt;, avg_field_goals_made &lt;dbl&gt;,
#   avg_field_goals_attempted &lt;dbl&gt;, avg_threes_made &lt;dbl&gt;,
#   avg_threes_attempted &lt;dbl&gt;, avg_free_throws_made &lt;dbl&gt;,
#   avg_free_throws_attempted &lt;dbl&gt;, avg_ppg &lt;dbl&gt;, avg_blocks &lt;dbl&gt;, …</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a><span class="co"># Get the "the total within- cluster sum of squares"</span></span>
<span id="cb84-2"><a href="#cb84-2"></a><span class="co"># This is the total squared distance of each case from its assigned centroid</span></span>
<span id="cb84-3"><a href="#cb84-3"></a>kmeans_model<span class="sc">$</span>tot.withinss</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7806.592</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a>cluster_data <span class="ot">&lt;-</span> PCA_player_dummy <span class="sc">%&gt;%</span> </span>
<span id="cb86-2"><a href="#cb86-2"></a>  <span class="fu">mutate</span>(<span class="at">kmeans_cluster =</span> kmeans_model<span class="sc">$</span>cluster) <span class="sc">%&gt;%</span></span>
<span id="cb86-3"><a href="#cb86-3"></a>  <span class="fu">mutate</span>(<span class="at">kmeans_cluster =</span> <span class="fu">as.factor</span>(kmeans_model<span class="sc">$</span>cluster))</span>
<span id="cb86-4"><a href="#cb86-4"></a></span>
<span id="cb86-5"><a href="#cb86-5"></a>PCA_player_dummy <span class="sc">%&gt;%</span> </span>
<span id="cb86-6"><a href="#cb86-6"></a>  <span class="fu">mutate</span>(<span class="at">kmeans_cluster =</span> <span class="fu">as.factor</span>(kmeans_model<span class="sc">$</span>cluster)) <span class="sc">%&gt;%</span></span>
<span id="cb86-7"><a href="#cb86-7"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> avg_PIE, <span class="at">y =</span> salary, <span class="at">color =</span> kmeans_cluster)) <span class="sc">+</span> </span>
<span id="cb86-8"><a href="#cb86-8"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb86-9"><a href="#cb86-9"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb86-10"><a href="#cb86-10"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"K-mean"</span>) <span class="sc">+</span> </span>
<span id="cb86-11"><a href="#cb86-11"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="wa-member1_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a><span class="fu">ggplot</span>(cluster_data, <span class="fu">aes</span>(<span class="at">x =</span> avg_PIE, <span class="at">y =</span> salary, <span class="at">color =</span> kmeans_cluster)) <span class="sc">+</span> </span>
<span id="cb87-2"><a href="#cb87-2"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb87-3"><a href="#cb87-3"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb87-4"><a href="#cb87-4"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"K-means results"</span>) <span class="sc">+</span> </span>
<span id="cb87-5"><a href="#cb87-5"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="wa-member1_files/figure-html/unnamed-chunk-30-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="../appx/case-study.html" class="pagination-link" aria-label="Case Study">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Case Study</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../wa/wa-member2.html" class="pagination-link" aria-label="Karyna S.">
        <span class="nav-page-text"><span class="chapter-title">Karyna S.</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb88" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb88-1"><a href="#cb88-1"></a><span class="co">---</span></span>
<span id="cb88-2"><a href="#cb88-2"></a><span class="an">title:</span><span class="co"> "Cate S."</span></span>
<span id="cb88-3"><a href="#cb88-3"></a><span class="co">---</span></span>
<span id="cb88-4"><a href="#cb88-4"></a></span>
<span id="cb88-7"><a href="#cb88-7"></a><span class="in">```{r}</span></span>
<span id="cb88-8"><a href="#cb88-8"></a><span class="fu">library</span>(wehoop)</span>
<span id="cb88-9"><a href="#cb88-9"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb88-10"><a href="#cb88-10"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb88-11"><a href="#cb88-11"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb88-12"><a href="#cb88-12"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb88-13"><a href="#cb88-13"></a><span class="fu">library</span>(glmnet)</span>
<span id="cb88-14"><a href="#cb88-14"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb88-15"><a href="#cb88-15"></a><span class="fu">tidymodels_prefer</span>()</span>
<span id="cb88-16"><a href="#cb88-16"></a><span class="fu">library</span>(robotstxt)</span>
<span id="cb88-17"><a href="#cb88-17"></a><span class="fu">library</span>(rvest)</span>
<span id="cb88-18"><a href="#cb88-18"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb88-19"><a href="#cb88-19"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb88-20"><a href="#cb88-20"></a><span class="fu">library</span>(rpart)</span>
<span id="cb88-21"><a href="#cb88-21"></a><span class="fu">library</span>(rpart.plot)</span>
<span id="cb88-22"><a href="#cb88-22"></a><span class="fu">library</span>(gt)</span>
<span id="cb88-23"><a href="#cb88-23"></a><span class="fu">library</span>(knitr)</span>
<span id="cb88-24"><a href="#cb88-24"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb88-25"><a href="#cb88-25"></a></span>
<span id="cb88-26"><a href="#cb88-26"></a>wnba_pbp <span class="ot">&lt;-</span> wehoop<span class="sc">::</span><span class="fu">load_wnba_pbp</span>()</span>
<span id="cb88-27"><a href="#cb88-27"></a>wnba_team_box <span class="ot">&lt;-</span> wehoop<span class="sc">::</span><span class="fu">load_wnba_team_box</span>()</span>
<span id="cb88-28"><a href="#cb88-28"></a>wnba_player_box <span class="ot">&lt;-</span> wehoop<span class="sc">::</span><span class="fu">load_wnba_player_box</span>()</span>
<span id="cb88-29"><a href="#cb88-29"></a><span class="in">```</span></span>
<span id="cb88-30"><a href="#cb88-30"></a></span>
<span id="cb88-31"><a href="#cb88-31"></a><span class="fu">### Player Dataset</span></span>
<span id="cb88-32"><a href="#cb88-32"></a></span>
<span id="cb88-35"><a href="#cb88-35"></a><span class="in">```{r}</span></span>
<span id="cb88-36"><a href="#cb88-36"></a><span class="co"># get dimensions</span></span>
<span id="cb88-37"><a href="#cb88-37"></a><span class="fu">dim</span>(wnba_player_box)</span>
<span id="cb88-38"><a href="#cb88-38"></a><span class="in">```</span></span>
<span id="cb88-39"><a href="#cb88-39"></a></span>
<span id="cb88-42"><a href="#cb88-42"></a><span class="in">```{r}</span></span>
<span id="cb88-43"><a href="#cb88-43"></a><span class="co"># find the league's best players</span></span>
<span id="cb88-44"><a href="#cb88-44"></a>top_players <span class="ot">&lt;-</span> wnba_player_box <span class="sc">%&gt;%</span></span>
<span id="cb88-45"><a href="#cb88-45"></a>  <span class="fu">filter</span>(game_id <span class="sc">!=</span> <span class="dv">401781604</span>) <span class="sc">%&gt;%</span></span>
<span id="cb88-46"><a href="#cb88-46"></a>  <span class="fu">group_by</span>(athlete_display_name, team_name) <span class="sc">%&gt;%</span></span>
<span id="cb88-47"><a href="#cb88-47"></a>  <span class="fu">summarize</span>(</span>
<span id="cb88-48"><a href="#cb88-48"></a>    <span class="at">avg_ppg =</span> <span class="fu">mean</span>(points, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb88-49"><a href="#cb88-49"></a>    <span class="at">avg_blocks =</span> <span class="fu">mean</span>(blocks, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb88-50"><a href="#cb88-50"></a>    <span class="at">avg_rebounds =</span> <span class="fu">mean</span>((offensive_rebounds <span class="sc">+</span> defensive_rebounds), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb88-51"><a href="#cb88-51"></a>    <span class="at">avg_assists =</span> <span class="fu">mean</span>(assists, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb88-52"><a href="#cb88-52"></a>    <span class="at">avg_steals =</span> <span class="fu">mean</span>(steals, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb88-53"><a href="#cb88-53"></a>    )</span>
<span id="cb88-54"><a href="#cb88-54"></a></span>
<span id="cb88-55"><a href="#cb88-55"></a>top_players <span class="sc">%&gt;%</span></span>
<span id="cb88-56"><a href="#cb88-56"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(avg_ppg)) <span class="sc">%&gt;%</span></span>
<span id="cb88-57"><a href="#cb88-57"></a>  <span class="fu">head</span>(<span class="dv">10</span>) </span>
<span id="cb88-58"><a href="#cb88-58"></a><span class="in">```</span></span>
<span id="cb88-59"><a href="#cb88-59"></a></span>
<span id="cb88-62"><a href="#cb88-62"></a><span class="in">```{r}</span></span>
<span id="cb88-63"><a href="#cb88-63"></a>game_totals <span class="ot">&lt;-</span> wnba_team_box <span class="sc">%&gt;%</span></span>
<span id="cb88-64"><a href="#cb88-64"></a>  <span class="fu">filter</span>(game_id <span class="sc">!=</span> <span class="dv">401781604</span>)<span class="sc">%&gt;%</span></span>
<span id="cb88-65"><a href="#cb88-65"></a>  <span class="fu">group_by</span>(game_id) <span class="sc">%&gt;%</span></span>
<span id="cb88-66"><a href="#cb88-66"></a>  <span class="fu">summarize</span>(</span>
<span id="cb88-67"><a href="#cb88-67"></a>    <span class="at">total_points =</span> <span class="fu">sum</span>(team_score),</span>
<span id="cb88-68"><a href="#cb88-68"></a>    <span class="at">total_field_goals_made =</span> <span class="fu">sum</span>(field_goals_made),</span>
<span id="cb88-69"><a href="#cb88-69"></a>    <span class="at">total_free_throws_made =</span> <span class="fu">sum</span>(free_throws_made),</span>
<span id="cb88-70"><a href="#cb88-70"></a>    <span class="at">total_field_goals_attempted =</span> <span class="fu">sum</span>(field_goals_attempted),</span>
<span id="cb88-71"><a href="#cb88-71"></a>    <span class="at">total_free_throws_attempted =</span> <span class="fu">sum</span>(free_throws_attempted),</span>
<span id="cb88-72"><a href="#cb88-72"></a>    <span class="at">total_defensive_rebounds =</span> <span class="fu">sum</span>(defensive_rebounds),</span>
<span id="cb88-73"><a href="#cb88-73"></a>    <span class="at">total_offensive_rebounds =</span> <span class="fu">sum</span>(offensive_rebounds),</span>
<span id="cb88-74"><a href="#cb88-74"></a>    <span class="at">total_assists =</span> <span class="fu">sum</span>(assists),</span>
<span id="cb88-75"><a href="#cb88-75"></a>    <span class="at">total_steals =</span> <span class="fu">sum</span>(steals),</span>
<span id="cb88-76"><a href="#cb88-76"></a>    <span class="at">total_blocks =</span> <span class="fu">sum</span>(blocks),</span>
<span id="cb88-77"><a href="#cb88-77"></a>    <span class="at">total_fouls =</span> <span class="fu">sum</span>(fouls),</span>
<span id="cb88-78"><a href="#cb88-78"></a>    <span class="at">total_turnovers =</span> <span class="fu">sum</span>(turnovers)</span>
<span id="cb88-79"><a href="#cb88-79"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb88-80"><a href="#cb88-80"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb88-81"><a href="#cb88-81"></a></span>
<span id="cb88-82"><a href="#cb88-82"></a>player_game_totals <span class="ot">&lt;-</span> wnba_player_box <span class="sc">%&gt;%</span></span>
<span id="cb88-83"><a href="#cb88-83"></a>  <span class="fu">full_join</span>(game_totals, <span class="at">by =</span> <span class="st">"game_id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb88-84"><a href="#cb88-84"></a>  <span class="fu">select</span>(<span class="st">"game_id"</span>, <span class="st">"game_date"</span>, <span class="st">"athlete_id"</span>, <span class="st">"athlete_display_name"</span>, <span class="st">"team_id"</span>, <span class="st">"team_name"</span>, <span class="st">"points"</span>, <span class="st">"field_goals_made"</span>, <span class="st">"free_throws_made"</span>, <span class="st">"field_goals_attempted"</span>, <span class="st">"free_throws_attempted"</span>, <span class="st">"defensive_rebounds"</span>, <span class="st">"offensive_rebounds"</span>, <span class="st">"assists"</span>, <span class="st">"steals"</span>, <span class="st">"blocks"</span>, <span class="st">"fouls"</span>, <span class="st">"turnovers"</span>, <span class="st">"total_points"</span>, <span class="st">"total_field_goals_made"</span>, <span class="st">"total_free_throws_made"</span>, <span class="st">"total_field_goals_attempted"</span>, <span class="st">"total_free_throws_attempted"</span>, <span class="st">"total_defensive_rebounds"</span>, <span class="st">"total_offensive_rebounds"</span>, <span class="st">"total_assists"</span>, <span class="st">"total_steals"</span>, <span class="st">"total_blocks"</span>, <span class="st">"total_fouls"</span>, <span class="st">"total_turnovers"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb88-85"><a href="#cb88-85"></a>  <span class="fu">group_by</span>(game_id, game_date, athlete_id, athlete_display_name, team_id, team_name) <span class="sc">%&gt;%</span></span>
<span id="cb88-86"><a href="#cb88-86"></a>  <span class="fu">summarize</span>(<span class="at">player_PIE =</span> ((points <span class="sc">+</span> field_goals_made <span class="sc">+</span> free_throws_made <span class="sc">-</span> field_goals_attempted <span class="sc">-</span> free_throws_attempted <span class="sc">+</span> defensive_rebounds <span class="sc">+</span> (offensive_rebounds<span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span> assists <span class="sc">+</span> steals <span class="sc">+</span> (blocks<span class="sc">/</span><span class="dv">2</span>) <span class="sc">-</span> fouls <span class="sc">-</span> turnovers) <span class="sc">/</span> (total_points <span class="sc">+</span> total_field_goals_made <span class="sc">+</span> total_free_throws_made <span class="sc">-</span> total_field_goals_attempted <span class="sc">-</span> total_free_throws_attempted <span class="sc">+</span> total_defensive_rebounds <span class="sc">+</span> (total_offensive_rebounds<span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span> total_assists <span class="sc">+</span> total_steals <span class="sc">+</span> (total_blocks<span class="sc">/</span><span class="dv">2</span>) <span class="sc">-</span> total_fouls <span class="sc">-</span> total_turnovers)) <span class="sc">*</span> <span class="dv">100</span>) </span>
<span id="cb88-87"><a href="#cb88-87"></a></span>
<span id="cb88-88"><a href="#cb88-88"></a>top10_pie <span class="ot">&lt;-</span> player_game_totals <span class="sc">%&gt;%</span></span>
<span id="cb88-89"><a href="#cb88-89"></a>  <span class="fu">group_by</span>(athlete_display_name, team_name) <span class="sc">%&gt;%</span></span>
<span id="cb88-90"><a href="#cb88-90"></a>  <span class="fu">summarize</span>(<span class="at">avg_PIE =</span> <span class="fu">mean</span>(player_PIE, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb88-91"><a href="#cb88-91"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(avg_PIE)) <span class="sc">%&gt;%</span></span>
<span id="cb88-92"><a href="#cb88-92"></a>  <span class="fu">head</span>(<span class="dv">10</span>) </span>
<span id="cb88-93"><a href="#cb88-93"></a></span>
<span id="cb88-94"><a href="#cb88-94"></a>top10_pie <span class="sc">%&gt;%</span></span>
<span id="cb88-95"><a href="#cb88-95"></a>  <span class="fu">kable</span>(</span>
<span id="cb88-96"><a href="#cb88-96"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Player"</span>, <span class="st">"Team"</span>, <span class="st">"PIE"</span>),</span>
<span id="cb88-97"><a href="#cb88-97"></a>    <span class="at">align =</span> <span class="st">"lll"</span></span>
<span id="cb88-98"><a href="#cb88-98"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb88-99"><a href="#cb88-99"></a>  <span class="fu">kable_styling</span>()</span>
<span id="cb88-100"><a href="#cb88-100"></a></span>
<span id="cb88-101"><a href="#cb88-101"></a>player_game_totals <span class="sc">%&gt;%</span></span>
<span id="cb88-102"><a href="#cb88-102"></a>  <span class="fu">filter</span>(athlete_id<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">"3149391"</span>, <span class="st">"2529140"</span>, <span class="st">"3917450"</span>, <span class="st">"2998928"</span>, <span class="st">"1068"</span>, <span class="st">"4432831"</span>, <span class="st">"4433730"</span>, <span class="st">"4433402"</span>,</span>
<span id="cb88-103"><a href="#cb88-103"></a>    <span class="st">"2566106"</span>, <span class="st">"4065870"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb88-104"><a href="#cb88-104"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> game_date, <span class="at">y =</span> player_PIE, <span class="at">color =</span> athlete_display_name)) <span class="sc">+</span> <span class="fu">geom_line</span>()</span>
<span id="cb88-105"><a href="#cb88-105"></a><span class="in">```</span></span>
<span id="cb88-106"><a href="#cb88-106"></a></span>
<span id="cb88-107"><a href="#cb88-107"></a><span class="fu">### Team Dataset</span></span>
<span id="cb88-108"><a href="#cb88-108"></a></span>
<span id="cb88-111"><a href="#cb88-111"></a><span class="in">```{r}</span></span>
<span id="cb88-112"><a href="#cb88-112"></a><span class="co"># get dimensions</span></span>
<span id="cb88-113"><a href="#cb88-113"></a><span class="fu">dim</span>(wnba_team_box)</span>
<span id="cb88-114"><a href="#cb88-114"></a><span class="in">```</span></span>
<span id="cb88-115"><a href="#cb88-115"></a></span>
<span id="cb88-118"><a href="#cb88-118"></a><span class="in">```{r}</span></span>
<span id="cb88-119"><a href="#cb88-119"></a><span class="co"># determine records for each team</span></span>
<span id="cb88-120"><a href="#cb88-120"></a>wnba_team_records <span class="ot">&lt;-</span> wnba_team_box <span class="sc">%&gt;%</span></span>
<span id="cb88-121"><a href="#cb88-121"></a>  <span class="fu">filter</span>(team_name <span class="sc">!=</span> <span class="st">"TEAM CLARK"</span>, team_name <span class="sc">!=</span> <span class="st">"TEAM COLLIER"</span>) <span class="sc">%&gt;%</span> <span class="co"># remove All Star teams</span></span>
<span id="cb88-122"><a href="#cb88-122"></a>  <span class="fu">mutate</span>(</span>
<span id="cb88-123"><a href="#cb88-123"></a>    <span class="at">win =</span> <span class="fu">ifelse</span>(team_winner <span class="sc">==</span> <span class="cn">TRUE</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb88-124"><a href="#cb88-124"></a>    <span class="at">loss =</span> <span class="fu">ifelse</span>(team_winner <span class="sc">==</span> <span class="cn">FALSE</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb88-125"><a href="#cb88-125"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb88-126"><a href="#cb88-126"></a>  <span class="fu">group_by</span>(team_name) <span class="sc">%&gt;%</span></span>
<span id="cb88-127"><a href="#cb88-127"></a>  <span class="fu">arrange</span>(team_name, game_date) <span class="sc">%&gt;%</span> </span>
<span id="cb88-128"><a href="#cb88-128"></a>  <span class="fu">mutate</span>(</span>
<span id="cb88-129"><a href="#cb88-129"></a>    <span class="at">cumulative_wins =</span> <span class="fu">cumsum</span>(win),</span>
<span id="cb88-130"><a href="#cb88-130"></a>    <span class="at">cumulative_losses =</span> <span class="fu">cumsum</span>(loss),</span>
<span id="cb88-131"><a href="#cb88-131"></a>    <span class="at">record =</span> <span class="fu">paste0</span>(cumulative_wins, <span class="st">"-"</span>, cumulative_losses),</span>
<span id="cb88-132"><a href="#cb88-132"></a>    <span class="at">win_pct =</span> cumulative_wins<span class="sc">/</span>(cumulative_wins <span class="sc">+</span> cumulative_losses)</span>
<span id="cb88-133"><a href="#cb88-133"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb88-134"><a href="#cb88-134"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb88-135"><a href="#cb88-135"></a>  <span class="fu">mutate</span>(<span class="at">team_color =</span> <span class="fu">paste0</span>(<span class="st">"#"</span>, team_color))</span>
<span id="cb88-136"><a href="#cb88-136"></a><span class="in">```</span></span>
<span id="cb88-137"><a href="#cb88-137"></a></span>
<span id="cb88-140"><a href="#cb88-140"></a><span class="in">```{r}</span></span>
<span id="cb88-141"><a href="#cb88-141"></a>team_colors <span class="ot">&lt;-</span> wnba_team_box <span class="sc">%&gt;%</span></span>
<span id="cb88-142"><a href="#cb88-142"></a>  <span class="fu">distinct</span>(team_name, team_color) <span class="sc">%&gt;%</span></span>
<span id="cb88-143"><a href="#cb88-143"></a>  <span class="fu">mutate</span>(<span class="at">team_color =</span> <span class="fu">paste0</span>(<span class="st">"#"</span>, team_color)) <span class="sc">%&gt;%</span></span>
<span id="cb88-144"><a href="#cb88-144"></a>  <span class="fu">deframe</span>()</span>
<span id="cb88-145"><a href="#cb88-145"></a></span>
<span id="cb88-146"><a href="#cb88-146"></a>df_labels <span class="ot">&lt;-</span> wnba_team_records <span class="sc">%&gt;%</span></span>
<span id="cb88-147"><a href="#cb88-147"></a>  <span class="fu">group_by</span>(team_name) <span class="sc">%&gt;%</span></span>
<span id="cb88-148"><a href="#cb88-148"></a>  <span class="fu">filter</span>(game_date <span class="sc">==</span> <span class="fu">max</span>(game_date)) <span class="sc">%&gt;%</span></span>
<span id="cb88-149"><a href="#cb88-149"></a>  <span class="fu">ungroup</span>() </span>
<span id="cb88-150"><a href="#cb88-150"></a><span class="in">```</span></span>
<span id="cb88-151"><a href="#cb88-151"></a></span>
<span id="cb88-154"><a href="#cb88-154"></a><span class="in">```{r}</span></span>
<span id="cb88-155"><a href="#cb88-155"></a><span class="co"># visualize records</span></span>
<span id="cb88-156"><a href="#cb88-156"></a><span class="fu">ggplot</span>(wnba_team_records, <span class="fu">aes</span>(<span class="at">x =</span> game_date, <span class="at">y =</span> cumulative_wins, </span>
<span id="cb88-157"><a href="#cb88-157"></a>  <span class="at">group =</span> team_name, <span class="at">color =</span> team_color)) <span class="sc">+</span></span>
<span id="cb88-158"><a href="#cb88-158"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb88-159"><a href="#cb88-159"></a>  <span class="fu">scale_color_identity</span>() <span class="sc">+</span> </span>
<span id="cb88-160"><a href="#cb88-160"></a>  <span class="fu">geom_text_repel</span>(</span>
<span id="cb88-161"><a href="#cb88-161"></a>    <span class="at">data =</span> df_labels,</span>
<span id="cb88-162"><a href="#cb88-162"></a>    <span class="fu">aes</span>(<span class="at">label =</span> team_name),</span>
<span id="cb88-163"><a href="#cb88-163"></a>    <span class="at">nudge_x =</span> <span class="dv">3</span>, </span>
<span id="cb88-164"><a href="#cb88-164"></a>    <span class="at">hjust =</span> <span class="dv">0</span>,</span>
<span id="cb88-165"><a href="#cb88-165"></a>    <span class="at">direction =</span> <span class="st">"y"</span>,</span>
<span id="cb88-166"><a href="#cb88-166"></a>    <span class="at">segment.color =</span> <span class="cn">NA</span>, </span>
<span id="cb88-167"><a href="#cb88-167"></a>    <span class="at">size =</span> <span class="fl">3.5</span>,</span>
<span id="cb88-168"><a href="#cb88-168"></a>    <span class="at">fontface =</span> <span class="st">"bold"</span></span>
<span id="cb88-169"><a href="#cb88-169"></a>  ) <span class="sc">+</span></span>
<span id="cb88-170"><a href="#cb88-170"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb88-171"><a href="#cb88-171"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="fu">max</span>(wnba_team_records<span class="sc">$</span>game_date) <span class="sc">+</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb88-172"><a href="#cb88-172"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb88-173"><a href="#cb88-173"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">as.Date</span>(<span class="st">"2025-09-11"</span>), </span>
<span id="cb88-174"><a href="#cb88-174"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"darkgrey"</span>) <span class="sc">+</span></span>
<span id="cb88-175"><a href="#cb88-175"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"cumulative wins"</span>) <span class="sc">+</span></span>
<span id="cb88-176"><a href="#cb88-176"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">as.Date</span>(<span class="st">"2025-09-9"</span>), <span class="at">y =</span> <span class="dv">38</span>, </span>
<span id="cb88-177"><a href="#cb88-177"></a>    <span class="at">label =</span> <span class="fu">str_wrap</span>(<span class="st">"End of Regular Season"</span>, <span class="dv">15</span>), <span class="at">color =</span> <span class="st">"grey40"</span>, </span>
<span id="cb88-178"><a href="#cb88-178"></a>    <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb88-179"><a href="#cb88-179"></a><span class="in">```</span></span>
<span id="cb88-180"><a href="#cb88-180"></a></span>
<span id="cb88-183"><a href="#cb88-183"></a><span class="in">```{r}</span></span>
<span id="cb88-184"><a href="#cb88-184"></a><span class="co"># determine teams with the best avg shot percentages</span></span>
<span id="cb88-185"><a href="#cb88-185"></a>shot_percentages <span class="ot">&lt;-</span> wnba_team_records <span class="sc">%&gt;%</span></span>
<span id="cb88-186"><a href="#cb88-186"></a>  <span class="fu">select</span>(field_goal_pct, free_throw_pct, three_point_field_goal_pct, team_name) <span class="sc">%&gt;%</span></span>
<span id="cb88-187"><a href="#cb88-187"></a>  <span class="fu">group_by</span>(team_name) <span class="sc">%&gt;%</span></span>
<span id="cb88-188"><a href="#cb88-188"></a>  <span class="fu">summarise</span>(</span>
<span id="cb88-189"><a href="#cb88-189"></a>    <span class="at">avg_field_goal =</span> <span class="fu">mean</span>(field_goal_pct),</span>
<span id="cb88-190"><a href="#cb88-190"></a>    <span class="at">avg_free_throw =</span> <span class="fu">mean</span>(free_throw_pct),</span>
<span id="cb88-191"><a href="#cb88-191"></a>    <span class="at">avg_three =</span> <span class="fu">mean</span>(three_point_field_goal_pct),</span>
<span id="cb88-192"><a href="#cb88-192"></a>  )</span>
<span id="cb88-193"><a href="#cb88-193"></a></span>
<span id="cb88-194"><a href="#cb88-194"></a>shot_percentages <span class="sc">%&gt;%</span></span>
<span id="cb88-195"><a href="#cb88-195"></a>  <span class="fu">select</span>(team_name, avg_field_goal) <span class="sc">%&gt;%</span></span>
<span id="cb88-196"><a href="#cb88-196"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(avg_field_goal)) <span class="sc">%&gt;%</span></span>
<span id="cb88-197"><a href="#cb88-197"></a>  <span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb88-198"><a href="#cb88-198"></a></span>
<span id="cb88-199"><a href="#cb88-199"></a>shot_percentages <span class="sc">%&gt;%</span></span>
<span id="cb88-200"><a href="#cb88-200"></a>  <span class="fu">select</span>(team_name, avg_free_throw) <span class="sc">%&gt;%</span></span>
<span id="cb88-201"><a href="#cb88-201"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(avg_free_throw)) <span class="sc">%&gt;%</span></span>
<span id="cb88-202"><a href="#cb88-202"></a>  <span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb88-203"><a href="#cb88-203"></a></span>
<span id="cb88-204"><a href="#cb88-204"></a>shot_percentages <span class="sc">%&gt;%</span></span>
<span id="cb88-205"><a href="#cb88-205"></a>  <span class="fu">select</span>(team_name, avg_three) <span class="sc">%&gt;%</span></span>
<span id="cb88-206"><a href="#cb88-206"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(avg_three)) <span class="sc">%&gt;%</span></span>
<span id="cb88-207"><a href="#cb88-207"></a>  <span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb88-208"><a href="#cb88-208"></a><span class="in">```</span></span>
<span id="cb88-209"><a href="#cb88-209"></a></span>
<span id="cb88-212"><a href="#cb88-212"></a><span class="in">```{r}</span></span>
<span id="cb88-213"><a href="#cb88-213"></a><span class="co"># determine game margins for different performance stats</span></span>
<span id="cb88-214"><a href="#cb88-214"></a>margins <span class="ot">&lt;-</span> wnba_team_records <span class="sc">%&gt;%</span></span>
<span id="cb88-215"><a href="#cb88-215"></a>  <span class="fu">group_by</span>(game_id) <span class="sc">%&gt;%</span></span>
<span id="cb88-216"><a href="#cb88-216"></a>  <span class="fu">mutate</span>(</span>
<span id="cb88-217"><a href="#cb88-217"></a>    <span class="at">field_margin =</span> field_goals_made <span class="sc">-</span> <span class="fu">rev</span>(field_goals_made),</span>
<span id="cb88-218"><a href="#cb88-218"></a>    <span class="at">free_margin =</span> free_throws_made <span class="sc">-</span> <span class="fu">rev</span>(free_throws_made),</span>
<span id="cb88-219"><a href="#cb88-219"></a>    <span class="at">three_margin =</span> three_point_field_goals_made <span class="sc">-</span> <span class="fu">rev</span>(three_point_field_goals_made),</span>
<span id="cb88-220"><a href="#cb88-220"></a>    <span class="at">turnover_margin =</span> turnovers <span class="sc">-</span> <span class="fu">rev</span>(turnovers),</span>
<span id="cb88-221"><a href="#cb88-221"></a>    <span class="at">foul_margin =</span> fouls <span class="sc">-</span> <span class="fu">rev</span>(fouls)</span>
<span id="cb88-222"><a href="#cb88-222"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb88-223"><a href="#cb88-223"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb88-224"><a href="#cb88-224"></a>  <span class="fu">select</span>(game_id, team_name, field_margin, free_margin, three_margin, turnover_margin, foul_margin, cumulative_wins) <span class="sc">%&gt;%</span></span>
<span id="cb88-225"><a href="#cb88-225"></a>  <span class="fu">arrange</span>(game_id) </span>
<span id="cb88-226"><a href="#cb88-226"></a></span>
<span id="cb88-227"><a href="#cb88-227"></a><span class="co"># calculate average margins by team</span></span>
<span id="cb88-228"><a href="#cb88-228"></a>margin_avgs <span class="ot">&lt;-</span> margins <span class="sc">%&gt;%</span></span>
<span id="cb88-229"><a href="#cb88-229"></a>  <span class="fu">group_by</span>(team_name) <span class="sc">%&gt;%</span></span>
<span id="cb88-230"><a href="#cb88-230"></a>  <span class="fu">summarize</span>(</span>
<span id="cb88-231"><a href="#cb88-231"></a>    <span class="at">avg_field_margin =</span> <span class="fu">mean</span>(field_margin),</span>
<span id="cb88-232"><a href="#cb88-232"></a>    <span class="at">avg_free_margin =</span> <span class="fu">mean</span>(free_margin),</span>
<span id="cb88-233"><a href="#cb88-233"></a>    <span class="at">avg_three_margin =</span> <span class="fu">mean</span>(three_margin),</span>
<span id="cb88-234"><a href="#cb88-234"></a>    <span class="at">avg_turnover_margin =</span> <span class="fu">mean</span>(turnover_margin),</span>
<span id="cb88-235"><a href="#cb88-235"></a>    <span class="at">avg_foul_margin =</span> <span class="fu">mean</span>(foul_margin),</span>
<span id="cb88-236"><a href="#cb88-236"></a>    <span class="at">cumulative_wins =</span> <span class="fu">max</span>(cumulative_wins)</span>
<span id="cb88-237"><a href="#cb88-237"></a>  ) </span>
<span id="cb88-238"><a href="#cb88-238"></a></span>
<span id="cb88-239"><a href="#cb88-239"></a>margin_avgs_pivoted <span class="ot">&lt;-</span> margin_avgs <span class="sc">%&gt;%</span></span>
<span id="cb88-240"><a href="#cb88-240"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb88-241"><a href="#cb88-241"></a>    <span class="at">cols =</span> <span class="fu">c</span>(avg_field_margin, avg_free_margin, avg_three_margin, avg_turnover_margin, avg_foul_margin),</span>
<span id="cb88-242"><a href="#cb88-242"></a>    <span class="at">names_to =</span> <span class="st">"margin_type"</span>,</span>
<span id="cb88-243"><a href="#cb88-243"></a>    <span class="at">values_to =</span> <span class="st">"margin_value"</span></span>
<span id="cb88-244"><a href="#cb88-244"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb88-245"><a href="#cb88-245"></a>  <span class="fu">mutate</span>(</span>
<span id="cb88-246"><a href="#cb88-246"></a>    <span class="at">margin_type =</span> <span class="fu">fct_relevel</span>(margin_type, <span class="st">"avg_field_margin"</span>, <span class="st">"avg_free_margin"</span>, <span class="st">"avg_three_margin"</span>, <span class="st">"avg_turnover_margin"</span>, <span class="st">"avg_foul_margin"</span>)</span>
<span id="cb88-247"><a href="#cb88-247"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb88-248"><a href="#cb88-248"></a>  <span class="fu">mutate</span>(</span>
<span id="cb88-249"><a href="#cb88-249"></a>    <span class="at">team_name =</span> <span class="fu">fct_reorder</span>(team_name, <span class="fu">desc</span>(cumulative_wins))</span>
<span id="cb88-250"><a href="#cb88-250"></a>  )</span>
<span id="cb88-251"><a href="#cb88-251"></a></span>
<span id="cb88-252"><a href="#cb88-252"></a>margin_avgs <span class="sc">%&gt;%</span></span>
<span id="cb88-253"><a href="#cb88-253"></a>  <span class="fu">select</span>(team_name, avg_field_margin) <span class="sc">%&gt;%</span></span>
<span id="cb88-254"><a href="#cb88-254"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(avg_field_margin)) <span class="sc">%&gt;%</span></span>
<span id="cb88-255"><a href="#cb88-255"></a>  <span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb88-256"><a href="#cb88-256"></a></span>
<span id="cb88-257"><a href="#cb88-257"></a>margin_avgs <span class="sc">%&gt;%</span></span>
<span id="cb88-258"><a href="#cb88-258"></a>  <span class="fu">select</span>(team_name, avg_free_margin) <span class="sc">%&gt;%</span></span>
<span id="cb88-259"><a href="#cb88-259"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(avg_free_margin)) <span class="sc">%&gt;%</span></span>
<span id="cb88-260"><a href="#cb88-260"></a>  <span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb88-261"><a href="#cb88-261"></a></span>
<span id="cb88-262"><a href="#cb88-262"></a>margin_avgs <span class="sc">%&gt;%</span></span>
<span id="cb88-263"><a href="#cb88-263"></a>  <span class="fu">select</span>(team_name, avg_three_margin) <span class="sc">%&gt;%</span></span>
<span id="cb88-264"><a href="#cb88-264"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(avg_three_margin)) <span class="sc">%&gt;%</span></span>
<span id="cb88-265"><a href="#cb88-265"></a>  <span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb88-266"><a href="#cb88-266"></a></span>
<span id="cb88-267"><a href="#cb88-267"></a>margin_avgs <span class="sc">%&gt;%</span></span>
<span id="cb88-268"><a href="#cb88-268"></a>  <span class="fu">select</span>(team_name, avg_turnover_margin) <span class="sc">%&gt;%</span></span>
<span id="cb88-269"><a href="#cb88-269"></a>  <span class="fu">arrange</span>(avg_turnover_margin) <span class="sc">%&gt;%</span></span>
<span id="cb88-270"><a href="#cb88-270"></a>  <span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb88-271"><a href="#cb88-271"></a></span>
<span id="cb88-272"><a href="#cb88-272"></a>margin_avgs <span class="sc">%&gt;%</span></span>
<span id="cb88-273"><a href="#cb88-273"></a>  <span class="fu">select</span>(team_name, avg_foul_margin) <span class="sc">%&gt;%</span></span>
<span id="cb88-274"><a href="#cb88-274"></a>  <span class="fu">arrange</span>(avg_foul_margin) <span class="sc">%&gt;%</span></span>
<span id="cb88-275"><a href="#cb88-275"></a>  <span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb88-276"><a href="#cb88-276"></a><span class="in">```</span></span>
<span id="cb88-277"><a href="#cb88-277"></a></span>
<span id="cb88-280"><a href="#cb88-280"></a><span class="in">```{r}</span></span>
<span id="cb88-281"><a href="#cb88-281"></a><span class="co"># visualize margins by team</span></span>
<span id="cb88-282"><a href="#cb88-282"></a><span class="fu">ggplot</span>(margin_avgs_pivoted, <span class="fu">aes</span>(<span class="at">x =</span> margin_type, <span class="at">y =</span> margin_value, <span class="at">fill =</span> margin_type)) <span class="sc">+</span></span>
<span id="cb88-283"><a href="#cb88-283"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb88-284"><a href="#cb88-284"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb88-285"><a href="#cb88-285"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>team_name, <span class="at">nrow =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb88-286"><a href="#cb88-286"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb88-287"><a href="#cb88-287"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb88-288"><a href="#cb88-288"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb88-289"><a href="#cb88-289"></a>  <span class="fu">theme</span>(</span>
<span id="cb88-290"><a href="#cb88-290"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb88-291"><a href="#cb88-291"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb88-292"><a href="#cb88-292"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb88-293"><a href="#cb88-293"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),   </span>
<span id="cb88-294"><a href="#cb88-294"></a>    <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">"cm"</span>)  ) <span class="sc">+</span></span>
<span id="cb88-295"><a href="#cb88-295"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>, <span class="at">fill =</span> <span class="st">"Average Game Margins"</span>) <span class="sc">+</span></span>
<span id="cb88-296"><a href="#cb88-296"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb88-297"><a href="#cb88-297"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"avg_field_margin"</span> <span class="ot">=</span> <span class="st">"#3c286e"</span>, <span class="st">"avg_free_margin"</span> <span class="ot">=</span> <span class="st">"#5091cd"</span>, </span>
<span id="cb88-298"><a href="#cb88-298"></a>      <span class="st">"avg_three_margin"</span> <span class="ot">=</span> <span class="st">"#e31837"</span>, <span class="st">"avg_turnover_margin"</span> <span class="ot">=</span> <span class="st">"#2c5235"</span>, </span>
<span id="cb88-299"><a href="#cb88-299"></a>      <span class="st">"avg_foul_margin"</span> <span class="ot">=</span> <span class="st">"#f05023"</span>),</span>
<span id="cb88-300"><a href="#cb88-300"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"avg_field_margin"</span> <span class="ot">=</span> <span class="st">"Field Goals"</span>, <span class="st">"avg_free_margin"</span> <span class="ot">=</span> <span class="st">"Free Throws"</span>,</span>
<span id="cb88-301"><a href="#cb88-301"></a>      <span class="st">"avg_three_margin"</span> <span class="ot">=</span> <span class="st">"Three Pointers"</span>, <span class="st">"avg_turnover_margin"</span> <span class="ot">=</span> <span class="st">"Turnovers"</span>, </span>
<span id="cb88-302"><a href="#cb88-302"></a>      <span class="st">"avg_foul_margin"</span> <span class="ot">=</span> <span class="st">"Fouls"</span>)</span>
<span id="cb88-303"><a href="#cb88-303"></a>  )</span>
<span id="cb88-304"><a href="#cb88-304"></a><span class="in">```</span></span>
<span id="cb88-305"><a href="#cb88-305"></a></span>
<span id="cb88-306"><a href="#cb88-306"></a><span class="fu">### Play-By-Play Dataset</span></span>
<span id="cb88-307"><a href="#cb88-307"></a></span>
<span id="cb88-310"><a href="#cb88-310"></a><span class="in">```{r}</span></span>
<span id="cb88-311"><a href="#cb88-311"></a><span class="co"># get dimensions</span></span>
<span id="cb88-312"><a href="#cb88-312"></a><span class="fu">dim</span>(wnba_pbp)</span>
<span id="cb88-313"><a href="#cb88-313"></a><span class="in">```</span></span>
<span id="cb88-314"><a href="#cb88-314"></a></span>
<span id="cb88-317"><a href="#cb88-317"></a><span class="in">```{r}</span></span>
<span id="cb88-318"><a href="#cb88-318"></a><span class="co"># create shot type variable</span></span>
<span id="cb88-319"><a href="#cb88-319"></a>wnba_pbp <span class="ot">&lt;-</span> wnba_pbp <span class="sc">%&gt;%</span></span>
<span id="cb88-320"><a href="#cb88-320"></a>  <span class="fu">filter</span>(shooting_play) <span class="sc">%&gt;%</span></span>
<span id="cb88-321"><a href="#cb88-321"></a>  <span class="fu">mutate</span>(<span class="at">shot_type =</span> <span class="fu">case_when</span>(</span>
<span id="cb88-322"><a href="#cb88-322"></a>    <span class="fu">str_detect</span>(type_text, <span class="st">"Jump Shot"</span>) <span class="sc">~</span> <span class="st">"Jump Shot"</span>,</span>
<span id="cb88-323"><a href="#cb88-323"></a>    <span class="fu">str_detect</span>(type_text, <span class="st">"Layup Shot"</span>) <span class="sc">|</span> <span class="fu">str_detect</span>(type_text, <span class="st">"Layup"</span>) <span class="sc">~</span> <span class="st">"Layup Shot"</span>,</span>
<span id="cb88-324"><a href="#cb88-324"></a>    <span class="fu">str_detect</span>(type_text, <span class="st">"Free Throw"</span>) <span class="sc">~</span> <span class="st">"Free Throw"</span>,</span>
<span id="cb88-325"><a href="#cb88-325"></a>    <span class="fu">str_detect</span>(type_text, <span class="st">"Hook Shot"</span>) <span class="sc">|</span> <span class="fu">str_detect</span>(type_text, <span class="st">"Hook"</span>) <span class="sc">~</span> <span class="st">"Hook Shot"</span>,</span>
<span id="cb88-326"><a href="#cb88-326"></a>    <span class="fu">str_detect</span>(type_text, <span class="st">"Tip Shot"</span>) <span class="sc">~</span> <span class="st">"Tip Shot"</span>,</span>
<span id="cb88-327"><a href="#cb88-327"></a>    <span class="fu">str_detect</span>(type_text, <span class="st">"Dunk"</span>) <span class="sc">~</span> <span class="st">"Dunk Shot"</span></span>
<span id="cb88-328"><a href="#cb88-328"></a>  )) </span>
<span id="cb88-329"><a href="#cb88-329"></a><span class="in">```</span></span>
<span id="cb88-330"><a href="#cb88-330"></a></span>
<span id="cb88-333"><a href="#cb88-333"></a><span class="in">```{r}</span></span>
<span id="cb88-334"><a href="#cb88-334"></a>wnba_pbp <span class="sc">%&gt;%</span>  </span>
<span id="cb88-335"><a href="#cb88-335"></a>  <span class="fu">filter</span>(game_id <span class="sc">!=</span> <span class="dv">401781604</span>, shot_type <span class="sc">!=</span> <span class="st">"Dunk Shot"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb88-336"><a href="#cb88-336"></a>  <span class="fu">mutate</span>(<span class="at">shot_type =</span> <span class="fu">fct_relevel</span>(shot_type, <span class="st">"Tip Shot"</span>, <span class="st">"Hook Shot"</span>, <span class="st">"Free Throw"</span>, <span class="st">"Layup Shot"</span>, <span class="st">"Jump Shot"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb88-337"><a href="#cb88-337"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> shot_type, <span class="at">fill =</span> scoring_play)) <span class="sc">+</span></span>
<span id="cb88-338"><a href="#cb88-338"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb88-339"><a href="#cb88-339"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb88-340"><a href="#cb88-340"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"count"</span>, <span class="at">y =</span> <span class="st">"shot type"</span>, <span class="at">fill =</span> <span class="st">"scoring play"</span>) <span class="sc">+</span></span>
<span id="cb88-341"><a href="#cb88-341"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"TRUE"</span> <span class="ot">=</span> <span class="st">"#3c286e"</span>, <span class="st">"FALSE"</span> <span class="ot">=</span> <span class="st">"#f05023"</span>))</span>
<span id="cb88-342"><a href="#cb88-342"></a><span class="in">```</span></span>
<span id="cb88-343"><a href="#cb88-343"></a></span>
<span id="cb88-344"><a href="#cb88-344"></a></span>
<span id="cb88-345"><a href="#cb88-345"></a><span class="fu"># Salary Data</span></span>
<span id="cb88-346"><a href="#cb88-346"></a></span>
<span id="cb88-349"><a href="#cb88-349"></a><span class="in">```{r}</span></span>
<span id="cb88-350"><a href="#cb88-350"></a><span class="fu">get_robotstxt</span>(<span class="at">domain =</span> <span class="st">"https://herhoopstats.com/"</span>)</span>
<span id="cb88-351"><a href="#cb88-351"></a><span class="in">```</span></span>
<span id="cb88-352"><a href="#cb88-352"></a></span>
<span id="cb88-355"><a href="#cb88-355"></a><span class="in">```{r}</span></span>
<span id="cb88-356"><a href="#cb88-356"></a>start_url <span class="ot">&lt;-</span> <span class="st">"https://herhoopstats.com/salary-cap-sheet/wnba/team/2025/"</span></span>
<span id="cb88-357"><a href="#cb88-357"></a>team_urls <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb88-358"><a href="#cb88-358"></a>  <span class="st">"atlanta-dream-11eaecc7-356c-1364-b611-2362f5011b0b"</span>,    </span>
<span id="cb88-359"><a href="#cb88-359"></a>  <span class="st">"chicago-sky-11eaecc7-355f-1c4a-b611-2362f5011b0b"</span>,     </span>
<span id="cb88-360"><a href="#cb88-360"></a>  <span class="st">"connecticut-sun-11eaecc7-3562-4a0a-b611-2362f5011b0b"</span>,     </span>
<span id="cb88-361"><a href="#cb88-361"></a>  <span class="st">"dallas-wings-11eaecc7-3583-13fc-b611-2362f5011b0b"</span>,     </span>
<span id="cb88-362"><a href="#cb88-362"></a>  <span class="st">"golden-state-valkyries-11efb2ba-e2c6-f520-8806-9a93b15b3fec"</span>, </span>
<span id="cb88-363"><a href="#cb88-363"></a>  <span class="st">"indiana-fever-11eaecc7-3565-c004-b611-2362f5011b0b"</span>,</span>
<span id="cb88-364"><a href="#cb88-364"></a>  <span class="st">"las-vegas-aces-11eaecc7-3575-e2fe-b611-2362f5011b0b"</span>,</span>
<span id="cb88-365"><a href="#cb88-365"></a>  <span class="st">"los-angeles-sparks-11eaecc7-3579-2ce8-b611-2362f5011b0b"</span>,</span>
<span id="cb88-366"><a href="#cb88-366"></a>  <span class="st">"minnesota-lynx-11eaecc7-357c-772c-b611-2362f5011b0b"</span>,</span>
<span id="cb88-367"><a href="#cb88-367"></a>  <span class="st">"new-york-liberty-11eaecc7-356f-5524-b611-2362f5011b0b"</span>,</span>
<span id="cb88-368"><a href="#cb88-368"></a>  <span class="st">"phoenix-mercury-11eaecc7-357f-c1ca-b611-2362f5011b0b"</span>,</span>
<span id="cb88-369"><a href="#cb88-369"></a>  <span class="st">"seattle-storm-11eaecc7-3572-876c-b611-2362f5011b0b"</span>,</span>
<span id="cb88-370"><a href="#cb88-370"></a>  <span class="st">"washington-mystics-11eaecc7-3568-d154-b611-2362f5011b0b"</span></span>
<span id="cb88-371"><a href="#cb88-371"></a>)</span>
<span id="cb88-372"><a href="#cb88-372"></a>full_urls <span class="ot">&lt;-</span> <span class="fu">str_c</span>(start_url, team_urls, <span class="st">"/"</span>)</span>
<span id="cb88-373"><a href="#cb88-373"></a></span>
<span id="cb88-374"><a href="#cb88-374"></a>salary_info <span class="ot">&lt;-</span> <span class="cf">function</span>(url) {</span>
<span id="cb88-375"><a href="#cb88-375"></a>  <span class="fu">Sys.sleep</span>(<span class="dv">1</span>)</span>
<span id="cb88-376"><a href="#cb88-376"></a>  webpage <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url)</span>
<span id="cb88-377"><a href="#cb88-377"></a></span>
<span id="cb88-378"><a href="#cb88-378"></a>  team <span class="ot">&lt;-</span> webpage <span class="sc">%&gt;%</span></span>
<span id="cb88-379"><a href="#cb88-379"></a>    <span class="fu">html_element</span>(<span class="st">"h1.salary_title"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb88-380"><a href="#cb88-380"></a>    <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb88-381"><a href="#cb88-381"></a>  </span>
<span id="cb88-382"><a href="#cb88-382"></a>  rows <span class="ot">&lt;-</span> webpage <span class="sc">%&gt;%</span></span>
<span id="cb88-383"><a href="#cb88-383"></a>    <span class="fu">html_elements</span>(<span class="st">"tbody tr"</span>)</span>
<span id="cb88-384"><a href="#cb88-384"></a></span>
<span id="cb88-385"><a href="#cb88-385"></a>  <span class="fu">map_df</span>(rows, <span class="cf">function</span>(row) {</span>
<span id="cb88-386"><a href="#cb88-386"></a></span>
<span id="cb88-387"><a href="#cb88-387"></a>    player <span class="ot">&lt;-</span> row <span class="sc">%&gt;%</span></span>
<span id="cb88-388"><a href="#cb88-388"></a>      <span class="fu">html_element</span>(<span class="st">"td.salary_player_name a"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb88-389"><a href="#cb88-389"></a>      <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb88-390"><a href="#cb88-390"></a></span>
<span id="cb88-391"><a href="#cb88-391"></a>    salary_cell <span class="ot">&lt;-</span> row <span class="sc">%&gt;%</span></span>
<span id="cb88-392"><a href="#cb88-392"></a>      <span class="fu">html_elements</span>(<span class="st">"td.salary_cap_hit"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb88-393"><a href="#cb88-393"></a>      .[<span class="dv">1</span>]</span>
<span id="cb88-394"><a href="#cb88-394"></a></span>
<span id="cb88-395"><a href="#cb88-395"></a>    salary <span class="ot">&lt;-</span> salary_cell <span class="sc">%&gt;%</span></span>
<span id="cb88-396"><a href="#cb88-396"></a>      <span class="fu">html_attr</span>(<span class="st">"sorttable_customkey"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb88-397"><a href="#cb88-397"></a>      <span class="fu">as.numeric</span>()</span>
<span id="cb88-398"><a href="#cb88-398"></a></span>
<span id="cb88-399"><a href="#cb88-399"></a>    contract_type <span class="ot">&lt;-</span> salary_cell <span class="sc">%&gt;%</span></span>
<span id="cb88-400"><a href="#cb88-400"></a>      <span class="fu">html_attr</span>(<span class="st">"title"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb88-401"><a href="#cb88-401"></a>      <span class="fu">na_if</span>(<span class="st">""</span>)</span>
<span id="cb88-402"><a href="#cb88-402"></a></span>
<span id="cb88-403"><a href="#cb88-403"></a>    <span class="fu">tibble</span>(</span>
<span id="cb88-404"><a href="#cb88-404"></a>      <span class="at">name =</span> player,</span>
<span id="cb88-405"><a href="#cb88-405"></a>      <span class="at">team =</span> team,</span>
<span id="cb88-406"><a href="#cb88-406"></a>      <span class="at">salary =</span> salary,</span>
<span id="cb88-407"><a href="#cb88-407"></a>      <span class="at">contract =</span> contract_type</span>
<span id="cb88-408"><a href="#cb88-408"></a>    )</span>
<span id="cb88-409"><a href="#cb88-409"></a>  })</span>
<span id="cb88-410"><a href="#cb88-410"></a>}</span>
<span id="cb88-411"><a href="#cb88-411"></a></span>
<span id="cb88-412"><a href="#cb88-412"></a>all_pages <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map</span>(full_urls, salary_info)</span>
<span id="cb88-413"><a href="#cb88-413"></a>salary_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(all_pages)</span>
<span id="cb88-414"><a href="#cb88-414"></a></span>
<span id="cb88-415"><a href="#cb88-415"></a><span class="in">```</span></span>
<span id="cb88-416"><a href="#cb88-416"></a></span>
<span id="cb88-419"><a href="#cb88-419"></a><span class="in">```{r}</span></span>
<span id="cb88-420"><a href="#cb88-420"></a>salary_df<span class="sc">$</span>salary[salary_df<span class="sc">$</span>salary <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb88-421"><a href="#cb88-421"></a></span>
<span id="cb88-422"><a href="#cb88-422"></a>salary_df <span class="ot">&lt;-</span> salary_df <span class="sc">%&gt;%</span></span>
<span id="cb88-423"><a href="#cb88-423"></a>  <span class="fu">mutate</span>(<span class="at">contract =</span> <span class="fu">str_extract</span>(contract, <span class="st">"^[^&lt;]*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb88-424"><a href="#cb88-424"></a>  <span class="fu">mutate</span>(<span class="at">team =</span> <span class="fu">str_extract</span>(team, <span class="st">"(?&lt;=2025 ).*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb88-425"><a href="#cb88-425"></a>  <span class="fu">mutate</span>(<span class="at">team =</span> <span class="fu">str_extract</span>(team, <span class="st">".*(?= Salary Cap Sheet)"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb88-426"><a href="#cb88-426"></a>  <span class="fu">mutate</span>(<span class="at">team_name =</span> <span class="fu">case_when</span>(</span>
<span id="cb88-427"><a href="#cb88-427"></a>    team <span class="sc">==</span> <span class="st">"Atlanta Dream"</span> <span class="sc">~</span> <span class="st">"Dream"</span>,</span>
<span id="cb88-428"><a href="#cb88-428"></a>    team <span class="sc">==</span> <span class="st">"Chicago Sky"</span> <span class="sc">~</span> <span class="st">"Sky"</span>,</span>
<span id="cb88-429"><a href="#cb88-429"></a>    team <span class="sc">==</span> <span class="st">"Connecticut Sun"</span> <span class="sc">~</span> <span class="st">"Sun"</span>,</span>
<span id="cb88-430"><a href="#cb88-430"></a>    team <span class="sc">==</span> <span class="st">"Dallas Wings"</span> <span class="sc">~</span> <span class="st">"Wings"</span>, </span>
<span id="cb88-431"><a href="#cb88-431"></a>    team <span class="sc">==</span> <span class="st">"Golden State Valkyries"</span> <span class="sc">~</span> <span class="st">"Valkyries"</span>,</span>
<span id="cb88-432"><a href="#cb88-432"></a>    team <span class="sc">==</span> <span class="st">"Indiana Fever"</span> <span class="sc">~</span> <span class="st">"Fever"</span>,</span>
<span id="cb88-433"><a href="#cb88-433"></a>    team <span class="sc">==</span> <span class="st">"Las Vegas Aces"</span> <span class="sc">~</span> <span class="st">"Aces"</span>,</span>
<span id="cb88-434"><a href="#cb88-434"></a>    team <span class="sc">==</span> <span class="st">"Los Angeles Sparks"</span> <span class="sc">~</span> <span class="st">"Sparks"</span>,</span>
<span id="cb88-435"><a href="#cb88-435"></a>    team <span class="sc">==</span> <span class="st">"Minnesota Lynx"</span> <span class="sc">~</span> <span class="st">"Lynx"</span>,</span>
<span id="cb88-436"><a href="#cb88-436"></a>    team <span class="sc">==</span> <span class="st">"New York Liberty"</span> <span class="sc">~</span> <span class="st">"Liberty"</span>,</span>
<span id="cb88-437"><a href="#cb88-437"></a>    team <span class="sc">==</span> <span class="st">"Phoenix Mercury"</span> <span class="sc">~</span> <span class="st">"Mercury"</span>,</span>
<span id="cb88-438"><a href="#cb88-438"></a>    team <span class="sc">==</span> <span class="st">"Seattle Storm"</span> <span class="sc">~</span> <span class="st">"Storm"</span>,</span>
<span id="cb88-439"><a href="#cb88-439"></a>    team <span class="sc">==</span> <span class="st">"Washington Mystics"</span> <span class="sc">~</span> <span class="st">"Mystics"</span></span>
<span id="cb88-440"><a href="#cb88-440"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb88-441"><a href="#cb88-441"></a>  <span class="fu">mutate</span>(<span class="at">contract =</span> </span>
<span id="cb88-442"><a href="#cb88-442"></a>    <span class="fu">fct_collapse</span>(contract,</span>
<span id="cb88-443"><a href="#cb88-443"></a>      <span class="st">"Protected Veteran"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Protected Veteran"</span>),</span>
<span id="cb88-444"><a href="#cb88-444"></a>      <span class="st">"Unprotected"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Unprotected"</span>),</span>
<span id="cb88-445"><a href="#cb88-445"></a>      <span class="st">"7-Day Contract"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Complete 7-Day Contract"</span>),</span>
<span id="cb88-446"><a href="#cb88-446"></a>      <span class="st">"Hardship Contract"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Complete Hardship Contract"</span>, <span class="st">"Active Hardship Contract"</span>), </span>
<span id="cb88-447"><a href="#cb88-447"></a>      <span class="st">"Waived"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Waived"</span>, <span class="st">"Waived Protected Veteran"</span>),</span>
<span id="cb88-448"><a href="#cb88-448"></a>      <span class="st">"Protected Rookie Scale"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Protected Rookie Scale"</span>),</span>
<span id="cb88-449"><a href="#cb88-449"></a>      <span class="st">"Buyout"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Buyout"</span>)</span>
<span id="cb88-450"><a href="#cb88-450"></a>    )</span>
<span id="cb88-451"><a href="#cb88-451"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb88-452"><a href="#cb88-452"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">ifelse</span>(<span class="fu">is.nan</span>(.), <span class="cn">NA</span>, .)))</span>
<span id="cb88-453"><a href="#cb88-453"></a><span class="in">```</span></span>
<span id="cb88-454"><a href="#cb88-454"></a></span>
<span id="cb88-457"><a href="#cb88-457"></a><span class="in">```{r}</span></span>
<span id="cb88-458"><a href="#cb88-458"></a>top10_salary <span class="ot">&lt;-</span> salary_df <span class="sc">%&gt;%</span></span>
<span id="cb88-459"><a href="#cb88-459"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(salary)) <span class="sc">%&gt;%</span></span>
<span id="cb88-460"><a href="#cb88-460"></a>  <span class="fu">select</span>(name, team_name, salary, contract) <span class="sc">%&gt;%</span></span>
<span id="cb88-461"><a href="#cb88-461"></a>  <span class="fu">head</span>(<span class="dv">10</span>) </span>
<span id="cb88-462"><a href="#cb88-462"></a></span>
<span id="cb88-463"><a href="#cb88-463"></a>top10_salary <span class="sc">%&gt;%</span></span>
<span id="cb88-464"><a href="#cb88-464"></a>  <span class="fu">kable</span>(</span>
<span id="cb88-465"><a href="#cb88-465"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Player"</span>, <span class="st">"Team"</span>, <span class="st">"Salary"</span>, <span class="st">"Contract"</span>),</span>
<span id="cb88-466"><a href="#cb88-466"></a>    <span class="at">align =</span> <span class="st">"lll"</span></span>
<span id="cb88-467"><a href="#cb88-467"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb88-468"><a href="#cb88-468"></a>  <span class="fu">kable_styling</span>()</span>
<span id="cb88-469"><a href="#cb88-469"></a><span class="in">```</span></span>
<span id="cb88-470"><a href="#cb88-470"></a></span>
<span id="cb88-471"><a href="#cb88-471"></a></span>
<span id="cb88-474"><a href="#cb88-474"></a><span class="in">```{r}</span></span>
<span id="cb88-475"><a href="#cb88-475"></a>player_salary <span class="ot">&lt;-</span> top_players <span class="sc">%&gt;%</span></span>
<span id="cb88-476"><a href="#cb88-476"></a>  <span class="fu">left_join</span>(salary_df, <span class="at">by =</span> <span class="fu">join_by</span>(athlete_display_name <span class="sc">==</span> name, team_name <span class="sc">==</span> team_name)) </span>
<span id="cb88-477"><a href="#cb88-477"></a></span>
<span id="cb88-478"><a href="#cb88-478"></a>player_salary <span class="sc">%&gt;%</span></span>
<span id="cb88-479"><a href="#cb88-479"></a>  <span class="fu">select</span>(athlete_display_name, team_name, salary, contract) </span>
<span id="cb88-480"><a href="#cb88-480"></a><span class="in">```</span></span>
<span id="cb88-481"><a href="#cb88-481"></a></span>
<span id="cb88-484"><a href="#cb88-484"></a><span class="in">```{r}</span></span>
<span id="cb88-485"><a href="#cb88-485"></a>PIE <span class="ot">&lt;-</span> player_game_totals <span class="sc">%&gt;%</span></span>
<span id="cb88-486"><a href="#cb88-486"></a>  <span class="fu">group_by</span>(athlete_display_name, team_name) <span class="sc">%&gt;%</span></span>
<span id="cb88-487"><a href="#cb88-487"></a>  <span class="fu">summarize</span>(<span class="at">avg_PIE =</span> <span class="fu">mean</span>(player_PIE, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) </span>
<span id="cb88-488"><a href="#cb88-488"></a></span>
<span id="cb88-489"><a href="#cb88-489"></a>player_salary_stats <span class="ot">&lt;-</span> player_salary <span class="sc">%&gt;%</span></span>
<span id="cb88-490"><a href="#cb88-490"></a>  <span class="fu">left_join</span>(PIE, <span class="at">by =</span> <span class="fu">join_by</span>(athlete_display_name <span class="sc">==</span> athlete_display_name, team_name <span class="sc">==</span> team_name)) <span class="sc">%&gt;%</span></span>
<span id="cb88-491"><a href="#cb88-491"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span></span>
<span id="cb88-492"><a href="#cb88-492"></a>  <span class="fu">mutate</span>(<span class="at">salary_thousands =</span> salary<span class="sc">/</span><span class="dv">1000</span>)</span>
<span id="cb88-493"><a href="#cb88-493"></a></span>
<span id="cb88-494"><a href="#cb88-494"></a><span class="fu">ggplot</span>(player_salary_stats, <span class="fu">aes</span>(<span class="at">x =</span> avg_PIE, <span class="at">y =</span> salary_thousands, <span class="at">color =</span> contract)) <span class="sc">+</span></span>
<span id="cb88-495"><a href="#cb88-495"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb88-496"><a href="#cb88-496"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb88-497"><a href="#cb88-497"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb88-498"><a href="#cb88-498"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Player Impact Estimate (Season Average)"</span>, <span class="at">y =</span> <span class="st">"Salary in Thousands of Dollars"</span>, </span>
<span id="cb88-499"><a href="#cb88-499"></a>       <span class="at">color =</span> <span class="st">"Contract Type"</span>, <span class="at">title =</span> <span class="st">"2025 WNBA Player Salaries by Player Performance and Contract Type"</span>)</span>
<span id="cb88-500"><a href="#cb88-500"></a></span>
<span id="cb88-501"><a href="#cb88-501"></a>salary_contract_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(salary_thousands <span class="sc">~</span> avg_PIE <span class="sc">*</span> contract, player_salary_stats)</span>
<span id="cb88-502"><a href="#cb88-502"></a></span>
<span id="cb88-503"><a href="#cb88-503"></a><span class="fu">coef</span>(<span class="fu">summary</span>(salary_contract_mod))</span>
<span id="cb88-504"><a href="#cb88-504"></a><span class="in">```</span></span>
<span id="cb88-505"><a href="#cb88-505"></a></span>
<span id="cb88-506"><a href="#cb88-506"></a><span class="fu"># Machine Learning</span></span>
<span id="cb88-507"><a href="#cb88-507"></a></span>
<span id="cb88-510"><a href="#cb88-510"></a><span class="in">```{r}</span></span>
<span id="cb88-511"><a href="#cb88-511"></a><span class="co"># predicting playoff outcomes using LASSO on team dataset</span></span>
<span id="cb88-512"><a href="#cb88-512"></a>wnba_team_lasso <span class="ot">&lt;-</span> wnba_team_box <span class="sc">%&gt;%</span></span>
<span id="cb88-513"><a href="#cb88-513"></a>  <span class="fu">filter</span>(game_id <span class="sc">!=</span> <span class="dv">401781604</span>) <span class="sc">%&gt;%</span></span>
<span id="cb88-514"><a href="#cb88-514"></a>  <span class="fu">select</span>(<span class="sc">-</span>season, <span class="sc">-</span>game_date_time, <span class="sc">-</span>team_id, <span class="sc">-</span>team_uid, <span class="sc">-</span>team_slug, <span class="sc">-</span>team_location, <span class="sc">-</span>team_abbreviation, <span class="sc">-</span>team_display_name, <span class="sc">-</span>team_short_display_name, <span class="sc">-</span>team_color, <span class="sc">-</span>team_alternate_color, <span class="sc">-</span>team_logo, <span class="sc">-</span>team_score, <span class="sc">-</span>opponent_team_id, <span class="sc">-</span>opponent_team_uid, <span class="sc">-</span>opponent_team_slug, <span class="sc">-</span>opponent_team_location, <span class="sc">-</span>opponent_team_abbreviation, <span class="sc">-</span>opponent_team_display_name, <span class="sc">-</span>opponent_team_short_display_name, <span class="sc">-</span>opponent_team_color, <span class="sc">-</span>opponent_team_alternate_color, <span class="sc">-</span>opponent_team_logo, <span class="sc">-</span>opponent_team_score) <span class="sc">%&gt;%</span></span>
<span id="cb88-515"><a href="#cb88-515"></a>  <span class="fu">mutate</span>(</span>
<span id="cb88-516"><a href="#cb88-516"></a>    <span class="at">team_winner =</span> <span class="fu">factor</span>(team_winner),</span>
<span id="cb88-517"><a href="#cb88-517"></a>    <span class="at">largest_lead =</span> <span class="fu">as.numeric</span>(largest_lead),</span>
<span id="cb88-518"><a href="#cb88-518"></a>    <span class="at">fast_break_points =</span> <span class="fu">as.numeric</span>(fast_break_points),</span>
<span id="cb88-519"><a href="#cb88-519"></a>    <span class="at">turnover_points =</span> <span class="fu">as.numeric</span>(turnover_points)) <span class="sc">%&gt;%</span> </span>
<span id="cb88-520"><a href="#cb88-520"></a>  <span class="fu">mutate</span>(<span class="at">season_day =</span> <span class="fu">as.numeric</span>(game_date <span class="sc">-</span> <span class="fu">as.Date</span>(<span class="st">"2025-05-16"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb88-521"><a href="#cb88-521"></a>  <span class="fu">select</span>(<span class="sc">-</span>game_date)</span>
<span id="cb88-522"><a href="#cb88-522"></a></span>
<span id="cb88-523"><a href="#cb88-523"></a>lasso_training <span class="ot">&lt;-</span> wnba_team_lasso <span class="sc">%&gt;%</span></span>
<span id="cb88-524"><a href="#cb88-524"></a>  <span class="fu">filter</span>(season_type <span class="sc">!=</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb88-525"><a href="#cb88-525"></a>  <span class="fu">select</span>(<span class="sc">-</span>game_id, <span class="sc">-</span>season_type)</span>
<span id="cb88-526"><a href="#cb88-526"></a></span>
<span id="cb88-527"><a href="#cb88-527"></a>lasso_test <span class="ot">&lt;-</span> wnba_team_lasso <span class="sc">%&gt;%</span></span>
<span id="cb88-528"><a href="#cb88-528"></a>  <span class="fu">filter</span>(season_type <span class="sc">==</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb88-529"><a href="#cb88-529"></a>  <span class="fu">select</span>(<span class="sc">-</span>game_id, <span class="sc">-</span>season_type)</span>
<span id="cb88-530"><a href="#cb88-530"></a></span>
<span id="cb88-531"><a href="#cb88-531"></a><span class="co"># model specification</span></span>
<span id="cb88-532"><a href="#cb88-532"></a><span class="fu">set.seed</span>(<span class="dv">212</span>)</span>
<span id="cb88-533"><a href="#cb88-533"></a>model_spec <span class="ot">&lt;-</span> <span class="fu">logistic_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb88-534"><a href="#cb88-534"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb88-535"><a href="#cb88-535"></a>  <span class="fu">set_engine</span>(<span class="st">"glmnet"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb88-536"><a href="#cb88-536"></a>  <span class="fu">set_args</span>(<span class="at">mixture =</span> <span class="dv">1</span>, <span class="at">penalty =</span> <span class="fu">tune</span>())</span>
<span id="cb88-537"><a href="#cb88-537"></a></span>
<span id="cb88-538"><a href="#cb88-538"></a><span class="co"># variable recipe</span></span>
<span id="cb88-539"><a href="#cb88-539"></a>data_rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(team_winner <span class="sc">~</span> . , <span class="at">data =</span> lasso_training) <span class="sc">%&gt;%</span></span>
<span id="cb88-540"><a href="#cb88-540"></a>  <span class="fu">step_novel</span>(<span class="fu">all_nominal_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb88-541"><a href="#cb88-541"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal_predictors</span>())</span>
<span id="cb88-542"><a href="#cb88-542"></a></span>
<span id="cb88-543"><a href="#cb88-543"></a><span class="co"># workflow (algorithm + recipe)</span></span>
<span id="cb88-544"><a href="#cb88-544"></a>model_wf <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb88-545"><a href="#cb88-545"></a>  <span class="fu">add_recipe</span>(data_rec) <span class="sc">%&gt;%</span></span>
<span id="cb88-546"><a href="#cb88-546"></a>  <span class="fu">add_model</span>(model_spec) </span>
<span id="cb88-547"><a href="#cb88-547"></a></span>
<span id="cb88-548"><a href="#cb88-548"></a><span class="co"># estimate 50 LASSO models</span></span>
<span id="cb88-549"><a href="#cb88-549"></a>multiple_models <span class="ot">&lt;-</span> model_wf <span class="sc">%&gt;%</span></span>
<span id="cb88-550"><a href="#cb88-550"></a> <span class="fu">tune_grid</span>(</span>
<span id="cb88-551"><a href="#cb88-551"></a>    <span class="at">grid =</span> <span class="fu">grid_regular</span>(</span>
<span id="cb88-552"><a href="#cb88-552"></a>      <span class="fu">penalty</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">3</span>)),     </span>
<span id="cb88-553"><a href="#cb88-553"></a>      <span class="at">levels =</span> <span class="dv">50</span></span>
<span id="cb88-554"><a href="#cb88-554"></a>    ),</span>
<span id="cb88-555"><a href="#cb88-555"></a>    <span class="at">resamples =</span> <span class="fu">vfold_cv</span>(lasso_training, <span class="at">v =</span> <span class="dv">10</span>),</span>
<span id="cb88-556"><a href="#cb88-556"></a>    <span class="at">metrics =</span> <span class="fu">metric_set</span>(accuracy)</span>
<span id="cb88-557"><a href="#cb88-557"></a> )</span>
<span id="cb88-558"><a href="#cb88-558"></a></span>
<span id="cb88-559"><a href="#cb88-559"></a><span class="co"># determine parsimonious parameter</span></span>
<span id="cb88-560"><a href="#cb88-560"></a>parsimonious_param <span class="ot">&lt;-</span> multiple_models <span class="sc">%&gt;%</span>   </span>
<span id="cb88-561"><a href="#cb88-561"></a>  <span class="fu">select_by_one_std_err</span>(<span class="at">metric =</span> <span class="st">"accuracy"</span>, <span class="fu">desc</span>(penalty))</span>
<span id="cb88-562"><a href="#cb88-562"></a></span>
<span id="cb88-563"><a href="#cb88-563"></a><span class="co"># determine best (highest accuracy) parameter</span></span>
<span id="cb88-564"><a href="#cb88-564"></a>best_param <span class="ot">&lt;-</span> multiple_models <span class="sc">%&gt;%</span>   </span>
<span id="cb88-565"><a href="#cb88-565"></a>  <span class="fu">select_best</span>(<span class="at">metric =</span> <span class="st">"accuracy"</span>)</span>
<span id="cb88-566"><a href="#cb88-566"></a></span>
<span id="cb88-567"><a href="#cb88-567"></a><span class="co"># build final parsimonious model</span></span>
<span id="cb88-568"><a href="#cb88-568"></a>final_model <span class="ot">&lt;-</span> model_wf <span class="sc">%&gt;%</span> </span>
<span id="cb88-569"><a href="#cb88-569"></a>  <span class="fu">finalize_workflow</span>(parsimonious_param) <span class="sc">%&gt;%</span> </span>
<span id="cb88-570"><a href="#cb88-570"></a>  <span class="fu">fit</span>(<span class="at">data =</span> lasso_training)</span>
<span id="cb88-571"><a href="#cb88-571"></a></span>
<span id="cb88-572"><a href="#cb88-572"></a><span class="co"># print coefficients</span></span>
<span id="cb88-573"><a href="#cb88-573"></a>final_model <span class="sc">%&gt;%</span></span>
<span id="cb88-574"><a href="#cb88-574"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span></span>
<span id="cb88-575"><a href="#cb88-575"></a>  <span class="fu">filter</span>(estimate <span class="sc">!=</span> <span class="dv">0</span>)</span>
<span id="cb88-576"><a href="#cb88-576"></a></span>
<span id="cb88-577"><a href="#cb88-577"></a>multiple_models <span class="sc">%&gt;%</span> </span>
<span id="cb88-578"><a href="#cb88-578"></a>  <span class="fu">collect_metrics</span>() <span class="sc">%&gt;%</span></span>
<span id="cb88-579"><a href="#cb88-579"></a>  <span class="fu">filter</span>(penalty <span class="sc">==</span> parsimonious_param<span class="sc">$</span>penalty)</span>
<span id="cb88-580"><a href="#cb88-580"></a></span>
<span id="cb88-581"><a href="#cb88-581"></a>multiple_models <span class="sc">%&gt;%</span></span>
<span id="cb88-582"><a href="#cb88-582"></a>  <span class="fu">autoplot</span>()</span>
<span id="cb88-583"><a href="#cb88-583"></a></span>
<span id="cb88-584"><a href="#cb88-584"></a>test_classifications <span class="ot">&lt;-</span> final_model <span class="sc">%&gt;%</span> <span class="co"># name of your final model</span></span>
<span id="cb88-585"><a href="#cb88-585"></a>  <span class="fu">augment</span>(<span class="at">new_data =</span> lasso_test) </span>
<span id="cb88-586"><a href="#cb88-586"></a></span>
<span id="cb88-587"><a href="#cb88-587"></a>test_confusion <span class="ot">&lt;-</span> final_model <span class="sc">%&gt;%</span></span>
<span id="cb88-588"><a href="#cb88-588"></a>  <span class="fu">augment</span>(<span class="at">new_data =</span> lasso_test) <span class="sc">%&gt;%</span></span>
<span id="cb88-589"><a href="#cb88-589"></a>  <span class="fu">conf_mat</span>(<span class="at">truth =</span> team_winner, <span class="at">estimate =</span> .pred_class)</span>
<span id="cb88-590"><a href="#cb88-590"></a></span>
<span id="cb88-591"><a href="#cb88-591"></a><span class="fu">summary</span>(test_confusion, <span class="at">event_level =</span> <span class="st">"second"</span>)</span>
<span id="cb88-592"><a href="#cb88-592"></a></span>
<span id="cb88-593"><a href="#cb88-593"></a>test_confusion <span class="sc">%&gt;%</span> </span>
<span id="cb88-594"><a href="#cb88-594"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb88-595"><a href="#cb88-595"></a>  <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">rep</span>(<span class="fu">colnames</span>(test_confusion<span class="sc">$</span>table), <span class="fu">ncol</span>(test_confusion<span class="sc">$</span>table))) <span class="sc">+</span> </span>
<span id="cb88-596"><a href="#cb88-596"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb88-597"><a href="#cb88-597"></a><span class="in">```</span></span>
<span id="cb88-598"><a href="#cb88-598"></a></span>
<span id="cb88-599"><a href="#cb88-599"></a></span>
<span id="cb88-602"><a href="#cb88-602"></a><span class="in">```{r}</span></span>
<span id="cb88-603"><a href="#cb88-603"></a><span class="co"># alternative LASSO that combines both teams stats into one row instead of having two rows per game</span></span>
<span id="cb88-604"><a href="#cb88-604"></a>team_lasso <span class="ot">&lt;-</span> wnba_team_box <span class="sc">%&gt;%</span></span>
<span id="cb88-605"><a href="#cb88-605"></a>  <span class="fu">filter</span>(game_id <span class="sc">!=</span> <span class="dv">401781604</span>) <span class="sc">%&gt;%</span></span>
<span id="cb88-606"><a href="#cb88-606"></a>  <span class="fu">select</span>(<span class="sc">-</span>season, <span class="sc">-</span>season_type, <span class="sc">-</span>game_date_time, <span class="sc">-</span>team_id, <span class="sc">-</span>team_uid, <span class="sc">-</span>team_slug, <span class="sc">-</span>team_location, <span class="sc">-</span>team_abbreviation, <span class="sc">-</span>team_display_name, <span class="sc">-</span>team_short_display_name, <span class="sc">-</span>team_color, <span class="sc">-</span>team_alternate_color, <span class="sc">-</span>team_logo, <span class="sc">-</span>team_score, <span class="sc">-</span>opponent_team_id, <span class="sc">-</span>opponent_team_uid, <span class="sc">-</span>opponent_team_slug, <span class="sc">-</span>opponent_team_location, <span class="sc">-</span>opponent_team_name, <span class="sc">-</span>opponent_team_abbreviation, <span class="sc">-</span>opponent_team_display_name, <span class="sc">-</span>opponent_team_short_display_name, <span class="sc">-</span>opponent_team_color, <span class="sc">-</span>opponent_team_alternate_color, <span class="sc">-</span>opponent_team_logo, <span class="sc">-</span>opponent_team_score) <span class="sc">%&gt;%</span></span>
<span id="cb88-607"><a href="#cb88-607"></a>  <span class="fu">mutate</span>(<span class="at">team_winner =</span> <span class="fu">factor</span>(team_winner))</span>
<span id="cb88-608"><a href="#cb88-608"></a></span>
<span id="cb88-609"><a href="#cb88-609"></a>team1_lasso <span class="ot">&lt;-</span> team_lasso <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(game_id) <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb88-610"><a href="#cb88-610"></a>team2_lasso <span class="ot">&lt;-</span> team_lasso <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(game_id) <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">2</span>)</span>
<span id="cb88-611"><a href="#cb88-611"></a></span>
<span id="cb88-612"><a href="#cb88-612"></a>team2_lasso <span class="ot">&lt;-</span> team2_lasso <span class="sc">%&gt;%</span> <span class="fu">rename_with</span>(<span class="sc">~</span><span class="fu">paste0</span>(<span class="st">"opponent_"</span>, .x), <span class="sc">-</span>game_id)</span>
<span id="cb88-613"><a href="#cb88-613"></a></span>
<span id="cb88-614"><a href="#cb88-614"></a>both_teams_lasso <span class="ot">&lt;-</span> <span class="fu">left_join</span>(team1_lasso, team2_lasso, <span class="at">by =</span> <span class="st">"game_id"</span>) </span>
<span id="cb88-615"><a href="#cb88-615"></a></span>
<span id="cb88-616"><a href="#cb88-616"></a>both_teams_lasso <span class="ot">&lt;-</span> both_teams_lasso <span class="sc">%&gt;%</span></span>
<span id="cb88-617"><a href="#cb88-617"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb88-618"><a href="#cb88-618"></a>  <span class="fu">mutate</span>(<span class="at">season_day =</span> <span class="fu">as.numeric</span>(game_date <span class="sc">-</span> <span class="fu">as.Date</span>(<span class="st">"2025-05-16"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb88-619"><a href="#cb88-619"></a>  <span class="fu">select</span>(<span class="sc">-</span>opponent_team_winner, <span class="sc">-</span>game_date, <span class="sc">-</span>opponent_game_date)</span>
<span id="cb88-620"><a href="#cb88-620"></a></span>
<span id="cb88-621"><a href="#cb88-621"></a>lasso_training <span class="ot">&lt;-</span> both_teams_lasso <span class="sc">%&gt;%</span></span>
<span id="cb88-622"><a href="#cb88-622"></a>  <span class="fu">filter</span>(<span class="sc">!</span>game_id<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">"401820329"</span>, <span class="st">"401820326"</span>, <span class="st">"401820325"</span>, <span class="st">"401820322"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb88-623"><a href="#cb88-623"></a>  <span class="fu">select</span>(<span class="sc">-</span>game_id)</span>
<span id="cb88-624"><a href="#cb88-624"></a></span>
<span id="cb88-625"><a href="#cb88-625"></a>lasso_test <span class="ot">&lt;-</span> both_teams_lasso <span class="sc">%&gt;%</span></span>
<span id="cb88-626"><a href="#cb88-626"></a>  <span class="fu">filter</span>(game_id<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">"401820329"</span>, <span class="st">"401820326"</span>, <span class="st">"401820325"</span>, <span class="st">"401820322"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb88-627"><a href="#cb88-627"></a>  <span class="fu">select</span>(<span class="sc">-</span>game_id)</span>
<span id="cb88-628"><a href="#cb88-628"></a></span>
<span id="cb88-629"><a href="#cb88-629"></a><span class="co"># Train</span></span>
<span id="cb88-630"><a href="#cb88-630"></a></span>
<span id="cb88-631"><a href="#cb88-631"></a><span class="co"># model specification</span></span>
<span id="cb88-632"><a href="#cb88-632"></a><span class="fu">set.seed</span>(<span class="dv">212</span>)</span>
<span id="cb88-633"><a href="#cb88-633"></a>model_spec <span class="ot">&lt;-</span> <span class="fu">logistic_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb88-634"><a href="#cb88-634"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb88-635"><a href="#cb88-635"></a>  <span class="fu">set_engine</span>(<span class="st">"glmnet"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb88-636"><a href="#cb88-636"></a>  <span class="fu">set_args</span>(<span class="at">mixture =</span> <span class="dv">1</span>, <span class="at">penalty =</span> <span class="fu">tune</span>())</span>
<span id="cb88-637"><a href="#cb88-637"></a></span>
<span id="cb88-638"><a href="#cb88-638"></a><span class="co"># variable recipe</span></span>
<span id="cb88-639"><a href="#cb88-639"></a>data_rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(team_winner <span class="sc">~</span> . , <span class="at">data =</span> lasso_training) <span class="sc">%&gt;%</span></span>
<span id="cb88-640"><a href="#cb88-640"></a>  <span class="fu">step_novel</span>(<span class="fu">all_nominal_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb88-641"><a href="#cb88-641"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal_predictors</span>())</span>
<span id="cb88-642"><a href="#cb88-642"></a></span>
<span id="cb88-643"><a href="#cb88-643"></a><span class="co"># workflow (algorithm + recipe)</span></span>
<span id="cb88-644"><a href="#cb88-644"></a>model_wf <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb88-645"><a href="#cb88-645"></a>  <span class="fu">add_recipe</span>(data_rec) <span class="sc">%&gt;%</span></span>
<span id="cb88-646"><a href="#cb88-646"></a>  <span class="fu">add_model</span>(model_spec) </span>
<span id="cb88-647"><a href="#cb88-647"></a></span>
<span id="cb88-648"><a href="#cb88-648"></a><span class="co"># estimate 50 LASSO models</span></span>
<span id="cb88-649"><a href="#cb88-649"></a>multiple_models <span class="ot">&lt;-</span> model_wf <span class="sc">%&gt;%</span></span>
<span id="cb88-650"><a href="#cb88-650"></a> <span class="fu">tune_grid</span>(</span>
<span id="cb88-651"><a href="#cb88-651"></a>    <span class="at">grid =</span> <span class="fu">grid_regular</span>(</span>
<span id="cb88-652"><a href="#cb88-652"></a>      <span class="fu">penalty</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">3</span>)),     </span>
<span id="cb88-653"><a href="#cb88-653"></a>      <span class="at">levels =</span> <span class="dv">50</span></span>
<span id="cb88-654"><a href="#cb88-654"></a>    ),</span>
<span id="cb88-655"><a href="#cb88-655"></a>    <span class="at">resamples =</span> <span class="fu">vfold_cv</span>(lasso_training, <span class="at">v =</span> <span class="dv">10</span>),</span>
<span id="cb88-656"><a href="#cb88-656"></a>    <span class="at">metrics =</span> <span class="fu">metric_set</span>(accuracy)</span>
<span id="cb88-657"><a href="#cb88-657"></a> )</span>
<span id="cb88-658"><a href="#cb88-658"></a></span>
<span id="cb88-659"><a href="#cb88-659"></a><span class="co"># determine parsimonious parameter</span></span>
<span id="cb88-660"><a href="#cb88-660"></a>parsimonious_param <span class="ot">&lt;-</span> multiple_models <span class="sc">%&gt;%</span>   </span>
<span id="cb88-661"><a href="#cb88-661"></a>  <span class="fu">select_by_one_std_err</span>(<span class="at">metric =</span> <span class="st">"accuracy"</span>, <span class="fu">desc</span>(penalty))</span>
<span id="cb88-662"><a href="#cb88-662"></a></span>
<span id="cb88-663"><a href="#cb88-663"></a><span class="co"># determine best (highest accuracy) parameter</span></span>
<span id="cb88-664"><a href="#cb88-664"></a>best_param <span class="ot">&lt;-</span> multiple_models <span class="sc">%&gt;%</span>   </span>
<span id="cb88-665"><a href="#cb88-665"></a>  <span class="fu">select_best</span>(<span class="at">metric =</span> <span class="st">"accuracy"</span>)</span>
<span id="cb88-666"><a href="#cb88-666"></a></span>
<span id="cb88-667"><a href="#cb88-667"></a><span class="co"># build final parsimonious model</span></span>
<span id="cb88-668"><a href="#cb88-668"></a>final_model <span class="ot">&lt;-</span> model_wf <span class="sc">%&gt;%</span> </span>
<span id="cb88-669"><a href="#cb88-669"></a>  <span class="fu">finalize_workflow</span>(parsimonious_param) <span class="sc">%&gt;%</span> </span>
<span id="cb88-670"><a href="#cb88-670"></a>  <span class="fu">fit</span>(<span class="at">data =</span> lasso_training)</span>
<span id="cb88-671"><a href="#cb88-671"></a></span>
<span id="cb88-672"><a href="#cb88-672"></a><span class="co"># print coefficients</span></span>
<span id="cb88-673"><a href="#cb88-673"></a>final_model <span class="sc">%&gt;%</span></span>
<span id="cb88-674"><a href="#cb88-674"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span></span>
<span id="cb88-675"><a href="#cb88-675"></a>  <span class="fu">filter</span>(estimate <span class="sc">!=</span> <span class="dv">0</span>)</span>
<span id="cb88-676"><a href="#cb88-676"></a></span>
<span id="cb88-677"><a href="#cb88-677"></a>multiple_models <span class="sc">%&gt;%</span> </span>
<span id="cb88-678"><a href="#cb88-678"></a>  <span class="fu">collect_metrics</span>() <span class="sc">%&gt;%</span></span>
<span id="cb88-679"><a href="#cb88-679"></a>  <span class="fu">filter</span>(penalty <span class="sc">==</span> parsimonious_param<span class="sc">$</span>penalty)</span>
<span id="cb88-680"><a href="#cb88-680"></a></span>
<span id="cb88-681"><a href="#cb88-681"></a>multiple_models <span class="sc">%&gt;%</span></span>
<span id="cb88-682"><a href="#cb88-682"></a>  <span class="fu">autoplot</span>()</span>
<span id="cb88-683"><a href="#cb88-683"></a></span>
<span id="cb88-684"><a href="#cb88-684"></a>final_model <span class="sc">%&gt;%</span> <span class="co"># name of your final model</span></span>
<span id="cb88-685"><a href="#cb88-685"></a>  <span class="fu">augment</span>(<span class="at">new_data =</span> lasso_test) </span>
<span id="cb88-686"><a href="#cb88-686"></a>  </span>
<span id="cb88-687"><a href="#cb88-687"></a>final_model <span class="sc">%&gt;%</span></span>
<span id="cb88-688"><a href="#cb88-688"></a>  <span class="fu">augment</span>(<span class="at">new_data =</span> lasso_test) <span class="sc">%&gt;%</span></span>
<span id="cb88-689"><a href="#cb88-689"></a>  <span class="fu">accuracy</span>(<span class="at">truth =</span> team_winner, <span class="at">estimate =</span> .pred_class)</span>
<span id="cb88-690"><a href="#cb88-690"></a></span>
<span id="cb88-691"><a href="#cb88-691"></a>final_model <span class="sc">%&gt;%</span></span>
<span id="cb88-692"><a href="#cb88-692"></a>  <span class="fu">augment</span>(<span class="at">new_data =</span> lasso_test) <span class="sc">%&gt;%</span></span>
<span id="cb88-693"><a href="#cb88-693"></a>  <span class="fu">conf_mat</span>(<span class="at">truth =</span> team_winner, <span class="at">estimate =</span> .pred_class)</span>
<span id="cb88-694"><a href="#cb88-694"></a><span class="in">```</span></span>
<span id="cb88-695"><a href="#cb88-695"></a></span>
<span id="cb88-696"><a href="#cb88-696"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb88-697"><a href="#cb88-697"></a><span class="in"># predicting teams in the playoffs using random forest</span></span>
<span id="cb88-698"><a href="#cb88-698"></a><span class="in">wnba_team_lasso &lt;- wnba_team_box %&gt;%</span></span>
<span id="cb88-699"><a href="#cb88-699"></a><span class="in">  filter(game_id != 401781604) %&gt;%</span></span>
<span id="cb88-700"><a href="#cb88-700"></a><span class="in">  select(-season, -game_date_time, -team_id, -team_uid, -team_slug, -team_location, -team_abbreviation, -team_display_name, -team_short_display_name, -team_color, -team_alternate_color, -team_logo, -opponent_team_id, -opponent_team_uid, -opponent_team_slug, -opponent_team_location, -opponent_team_abbreviation, -opponent_team_display_name, -opponent_team_short_display_name, -opponent_team_color, -opponent_team_alternate_color, -opponent_team_logo, -opponent_team_name) %&gt;%</span></span>
<span id="cb88-701"><a href="#cb88-701"></a><span class="in">  mutate(</span></span>
<span id="cb88-702"><a href="#cb88-702"></a><span class="in">    team_winner = factor(team_winner),</span></span>
<span id="cb88-703"><a href="#cb88-703"></a><span class="in">    team_name = factor(team_name),</span></span>
<span id="cb88-704"><a href="#cb88-704"></a><span class="in">    largest_lead = as.numeric(largest_lead),</span></span>
<span id="cb88-705"><a href="#cb88-705"></a><span class="in">    fast_break_points = as.numeric(fast_break_points),</span></span>
<span id="cb88-706"><a href="#cb88-706"></a><span class="in">    turnover_points = as.numeric(turnover_points)) %&gt;% </span></span>
<span id="cb88-707"><a href="#cb88-707"></a><span class="in">  mutate(season_day = as.numeric(game_date - as.Date("2025-05-16"))) %&gt;%</span></span>
<span id="cb88-708"><a href="#cb88-708"></a><span class="in">  select(-game_date)</span></span>
<span id="cb88-709"><a href="#cb88-709"></a></span>
<span id="cb88-710"><a href="#cb88-710"></a><span class="in">lasso_training &lt;- wnba_team_lasso %&gt;%</span></span>
<span id="cb88-711"><a href="#cb88-711"></a><span class="in">  filter(season_type != 3) %&gt;%</span></span>
<span id="cb88-712"><a href="#cb88-712"></a><span class="in">  select(-game_id, -season_type)</span></span>
<span id="cb88-713"><a href="#cb88-713"></a></span>
<span id="cb88-714"><a href="#cb88-714"></a><span class="in">lasso_test &lt;- wnba_team_lasso %&gt;%</span></span>
<span id="cb88-715"><a href="#cb88-715"></a><span class="in">  filter(season_type == 3) %&gt;%</span></span>
<span id="cb88-716"><a href="#cb88-716"></a><span class="in">  select(-game_id, -season_type)</span></span>
<span id="cb88-717"><a href="#cb88-717"></a></span>
<span id="cb88-718"><a href="#cb88-718"></a><span class="in"># model specification</span></span>
<span id="cb88-719"><a href="#cb88-719"></a><span class="in">set.seed(212)</span></span>
<span id="cb88-720"><a href="#cb88-720"></a><span class="in"># STEP 1: Model Specification</span></span>
<span id="cb88-721"><a href="#cb88-721"></a><span class="in">rf_spec &lt;- rand_forest()  %&gt;%</span></span>
<span id="cb88-722"><a href="#cb88-722"></a><span class="in">  set_mode("classification") %&gt;%</span></span>
<span id="cb88-723"><a href="#cb88-723"></a><span class="in">  set_engine(engine = "ranger") %&gt;% </span></span>
<span id="cb88-724"><a href="#cb88-724"></a><span class="in">  set_args(</span></span>
<span id="cb88-725"><a href="#cb88-725"></a><span class="in">    mtry = NULL,</span></span>
<span id="cb88-726"><a href="#cb88-726"></a><span class="in">    trees = 500,</span></span>
<span id="cb88-727"><a href="#cb88-727"></a><span class="in">    min_n = 2,</span></span>
<span id="cb88-728"><a href="#cb88-728"></a><span class="in">    probability = FALSE, # give classifications, not probability calculations</span></span>
<span id="cb88-729"><a href="#cb88-729"></a><span class="in">    importance = "impurity" # use Gini index to measure variable importance</span></span>
<span id="cb88-730"><a href="#cb88-730"></a><span class="in">  )</span></span>
<span id="cb88-731"><a href="#cb88-731"></a></span>
<span id="cb88-732"><a href="#cb88-732"></a><span class="in"># STEP 2: Build the forest or bagging model</span></span>
<span id="cb88-733"><a href="#cb88-733"></a><span class="in"># There are no preprocessing steps or tuning, hence no need for a workflow!</span></span>
<span id="cb88-734"><a href="#cb88-734"></a><span class="in">ensemble_model &lt;- rf_spec %&gt;% </span></span>
<span id="cb88-735"><a href="#cb88-735"></a><span class="in">  fit(team_name ~ ., data = lasso_training)</span></span>
<span id="cb88-736"><a href="#cb88-736"></a></span>
<span id="cb88-737"><a href="#cb88-737"></a></span>
<span id="cb88-738"><a href="#cb88-738"></a><span class="in"># Put in a data.frame object with x1 and x2 values (at minimum)</span></span>
<span id="cb88-739"><a href="#cb88-739"></a><span class="in">ensemble_model %&gt;% </span></span>
<span id="cb88-740"><a href="#cb88-740"></a><span class="in">  predict(new_data = lasso_test)  </span></span>
<span id="cb88-741"><a href="#cb88-741"></a></span>
<span id="cb88-742"><a href="#cb88-742"></a><span class="in"># Out-of-bag (OOB) prediction error</span></span>
<span id="cb88-743"><a href="#cb88-743"></a><span class="in">ensemble_model</span></span>
<span id="cb88-744"><a href="#cb88-744"></a></span>
<span id="cb88-745"><a href="#cb88-745"></a><span class="in"># OOB confusion matrix</span></span>
<span id="cb88-746"><a href="#cb88-746"></a><span class="in">ensemble_model %&gt;% </span></span>
<span id="cb88-747"><a href="#cb88-747"></a><span class="in">  extract_fit_engine() %&gt;% </span></span>
<span id="cb88-748"><a href="#cb88-748"></a><span class="in">  pluck("confusion.matrix") %&gt;% </span></span>
<span id="cb88-749"><a href="#cb88-749"></a><span class="in">  t()</span></span>
<span id="cb88-750"><a href="#cb88-750"></a></span>
<span id="cb88-751"><a href="#cb88-751"></a><span class="in">ensemble_model %&gt;% </span></span>
<span id="cb88-752"><a href="#cb88-752"></a><span class="in">  predict(new_data = lasso_test) %&gt;% </span></span>
<span id="cb88-753"><a href="#cb88-753"></a><span class="in">  cbind(lasso_test) %&gt;% </span></span>
<span id="cb88-754"><a href="#cb88-754"></a><span class="in">  conf_mat(</span></span>
<span id="cb88-755"><a href="#cb88-755"></a><span class="in">    truth = team_name,</span></span>
<span id="cb88-756"><a href="#cb88-756"></a><span class="in">    estimate = .pred_class</span></span>
<span id="cb88-757"><a href="#cb88-757"></a><span class="in">  )</span></span>
<span id="cb88-758"><a href="#cb88-758"></a><span class="in">```</span></span>
<span id="cb88-759"><a href="#cb88-759"></a></span>
<span id="cb88-762"><a href="#cb88-762"></a><span class="in">```{r}</span></span>
<span id="cb88-763"><a href="#cb88-763"></a><span class="co"># PCA on player dataset</span></span>
<span id="cb88-764"><a href="#cb88-764"></a>PCA_player <span class="ot">&lt;-</span> wnba_player_box <span class="sc">%&gt;%</span></span>
<span id="cb88-765"><a href="#cb88-765"></a>  <span class="fu">filter</span>(game_id <span class="sc">!=</span> <span class="dv">401781604</span>) <span class="sc">%&gt;%</span></span>
<span id="cb88-766"><a href="#cb88-766"></a>  <span class="fu">group_by</span>(athlete_display_name, team_name) <span class="sc">%&gt;%</span></span>
<span id="cb88-767"><a href="#cb88-767"></a>  <span class="fu">mutate</span>(<span class="at">player_unique =</span> <span class="fu">paste0</span>(athlete_display_name, <span class="st">"_"</span>, team_name)) <span class="sc">%&gt;%</span></span>
<span id="cb88-768"><a href="#cb88-768"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb88-769"><a href="#cb88-769"></a>  <span class="fu">group_by</span>(player_unique, team_name) <span class="sc">%&gt;%</span></span>
<span id="cb88-770"><a href="#cb88-770"></a>  <span class="fu">summarize</span>(</span>
<span id="cb88-771"><a href="#cb88-771"></a>    <span class="at">athlete_display_name =</span> <span class="fu">first</span>(athlete_display_name),</span>
<span id="cb88-772"><a href="#cb88-772"></a>    <span class="at">avg_minutes =</span> <span class="fu">mean</span>(minutes, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb88-773"><a href="#cb88-773"></a>    <span class="at">avg_field_goals_made =</span> <span class="fu">mean</span>(field_goals_made, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb88-774"><a href="#cb88-774"></a>    <span class="at">avg_field_goals_attempted =</span> <span class="fu">mean</span>(field_goals_attempted, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb88-775"><a href="#cb88-775"></a>    <span class="at">avg_threes_made =</span> <span class="fu">mean</span>(three_point_field_goals_made, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb88-776"><a href="#cb88-776"></a>    <span class="at">avg_threes_attempted =</span> <span class="fu">mean</span>(three_point_field_goals_attempted, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb88-777"><a href="#cb88-777"></a>    <span class="at">avg_free_throws_made =</span> <span class="fu">mean</span>(free_throws_made, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb88-778"><a href="#cb88-778"></a>    <span class="at">avg_free_throws_attempted =</span> <span class="fu">mean</span>(free_throws_attempted, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb88-779"><a href="#cb88-779"></a>    <span class="at">avg_free_throws_attempted =</span> <span class="fu">mean</span>(free_throws_attempted, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb88-780"><a href="#cb88-780"></a>    <span class="at">avg_ppg =</span> <span class="fu">mean</span>(points, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb88-781"><a href="#cb88-781"></a>    <span class="at">avg_blocks =</span> <span class="fu">mean</span>(blocks, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb88-782"><a href="#cb88-782"></a>    <span class="at">avg_rebounds =</span> <span class="fu">mean</span>(rebounds, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb88-783"><a href="#cb88-783"></a>    <span class="at">avg_offensive_rebounds =</span> <span class="fu">mean</span>(offensive_rebounds, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb88-784"><a href="#cb88-784"></a>    <span class="at">avg_defensive_rebounds =</span> <span class="fu">mean</span>(offensive_rebounds, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb88-785"><a href="#cb88-785"></a>    <span class="at">avg_assists =</span> <span class="fu">mean</span>(assists, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb88-786"><a href="#cb88-786"></a>    <span class="at">avg_steals =</span> <span class="fu">mean</span>(steals, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb88-787"><a href="#cb88-787"></a>    <span class="at">avg_turnovers =</span> <span class="fu">mean</span>(turnovers, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb88-788"><a href="#cb88-788"></a>    <span class="at">avg_fouls =</span> <span class="fu">mean</span>(fouls, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb88-789"><a href="#cb88-789"></a>    <span class="at">games_started =</span> <span class="fu">sum</span>(starter, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb88-790"><a href="#cb88-790"></a>    <span class="at">games_ejected =</span> <span class="fu">sum</span>(ejected, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb88-791"><a href="#cb88-791"></a>    <span class="at">games_did_not_play =</span> <span class="fu">sum</span>(did_not_play, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb88-792"><a href="#cb88-792"></a>    <span class="at">mean_plus_minus =</span> <span class="fu">mean</span>(<span class="fu">as.numeric</span>(plus_minus), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb88-793"><a href="#cb88-793"></a>    <span class="at">position =</span> <span class="fu">names</span>(<span class="fu">which.max</span>(<span class="fu">table</span>(athlete_position_name, <span class="at">useNA =</span> <span class="st">"no"</span>))),</span>
<span id="cb88-794"><a href="#cb88-794"></a>    <span class="at">wins =</span> <span class="fu">sum</span>(team_winner),</span>
<span id="cb88-795"><a href="#cb88-795"></a>    <span class="at">avg_team_score =</span> <span class="fu">mean</span>(team_score)</span>
<span id="cb88-796"><a href="#cb88-796"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb88-797"><a href="#cb88-797"></a>  <span class="fu">left_join</span>(salary_df, <span class="at">by =</span> <span class="fu">join_by</span>(athlete_display_name <span class="sc">==</span> name, team_name <span class="sc">==</span> team_name)) <span class="sc">%&gt;%</span></span>
<span id="cb88-798"><a href="#cb88-798"></a>  <span class="fu">left_join</span>(PIE, <span class="at">by =</span> <span class="fu">join_by</span>(athlete_display_name <span class="sc">==</span> athlete_display_name, team_name <span class="sc">==</span> team_name)) <span class="sc">%&gt;%</span> </span>
<span id="cb88-799"><a href="#cb88-799"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">ifelse</span>(<span class="fu">is.nan</span>(.), <span class="cn">NA</span>, .))) <span class="sc">%&gt;%</span></span>
<span id="cb88-800"><a href="#cb88-800"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb88-801"><a href="#cb88-801"></a></span>
<span id="cb88-802"><a href="#cb88-802"></a>PCA_player <span class="ot">&lt;-</span> PCA_player[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">21</span>, <span class="dv">30</span>, <span class="dv">41</span>, <span class="dv">47</span>, <span class="dv">49</span>, <span class="dv">72</span>, <span class="dv">76</span>, <span class="dv">78</span>, <span class="dv">79</span>, <span class="dv">98</span>, <span class="dv">99</span>, <span class="dv">116</span>, <span class="dv">117</span>, <span class="dv">138</span>, <span class="dv">165</span>, <span class="dv">189</span>), ] </span>
<span id="cb88-803"><a href="#cb88-803"></a></span>
<span id="cb88-804"><a href="#cb88-804"></a>PCA_player <span class="ot">&lt;-</span> PCA_player <span class="sc">%&gt;%</span></span>
<span id="cb88-805"><a href="#cb88-805"></a>  <span class="fu">select</span>(<span class="sc">-</span>athlete_display_name) <span class="sc">%&gt;%</span></span>
<span id="cb88-806"><a href="#cb88-806"></a>  <span class="fu">column_to_rownames</span>(<span class="st">"player_unique"</span>)</span>
<span id="cb88-807"><a href="#cb88-807"></a></span>
<span id="cb88-808"><a href="#cb88-808"></a>PCA_player_dummy <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">model.matrix</span>(<span class="sc">~</span> . <span class="sc">-</span> <span class="dv">1</span>, PCA_player))</span>
<span id="cb88-809"><a href="#cb88-809"></a></span>
<span id="cb88-810"><a href="#cb88-810"></a>PCA_player_dummy <span class="ot">&lt;-</span> PCA_player_dummy <span class="sc">%&gt;%</span></span>
<span id="cb88-811"><a href="#cb88-811"></a>  <span class="fu">select</span>(<span class="sc">-</span>contractBuyout, <span class="sc">-</span>games_ejected)</span>
<span id="cb88-812"><a href="#cb88-812"></a></span>
<span id="cb88-813"><a href="#cb88-813"></a><span class="co"># scale = TRUE, center = TRUE first standardizes the features</span></span>
<span id="cb88-814"><a href="#cb88-814"></a>pca_results <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(PCA_player_dummy, <span class="at">scale =</span> <span class="cn">TRUE</span>, <span class="at">center =</span> <span class="cn">TRUE</span>)</span>
<span id="cb88-815"><a href="#cb88-815"></a><span class="in">```</span></span>
<span id="cb88-816"><a href="#cb88-816"></a></span>
<span id="cb88-817"><a href="#cb88-817"></a><span class="in">```{r, fig.width=8, fig.height=5}</span></span>
<span id="cb88-818"><a href="#cb88-818"></a><span class="in"># Get the loadings which define the PCs</span></span>
<span id="cb88-819"><a href="#cb88-819"></a><span class="in"># pca_results %&gt;% </span></span>
<span id="cb88-820"><a href="#cb88-820"></a><span class="in">#  pluck("rotation")</span></span>
<span id="cb88-821"><a href="#cb88-821"></a></span>
<span id="cb88-822"><a href="#cb88-822"></a><span class="in">melt(pca_results$rotation) %&gt;%</span></span>
<span id="cb88-823"><a href="#cb88-823"></a><span class="in">  filter(Var2 == "PC1") %&gt;% </span></span>
<span id="cb88-824"><a href="#cb88-824"></a><span class="in">  ggplot(aes(x = Var1, y = value, fill = Var1)) +</span></span>
<span id="cb88-825"><a href="#cb88-825"></a><span class="in">    geom_bar(stat = "identity") +</span></span>
<span id="cb88-826"><a href="#cb88-826"></a><span class="in">    labs(y = "loadings", x = "original features", fill = "original features")</span></span>
<span id="cb88-827"><a href="#cb88-827"></a></span>
<span id="cb88-828"><a href="#cb88-828"></a><span class="in"># Plot loadings for first "k" PCs (you pick k)</span></span>
<span id="cb88-829"><a href="#cb88-829"></a><span class="in">library(reshape2)</span></span>
<span id="cb88-830"><a href="#cb88-830"></a><span class="in">melt(pca_results$rotation[, 1:2]) %&gt;% </span></span>
<span id="cb88-831"><a href="#cb88-831"></a><span class="in">  ggplot(aes(x = Var1, y = value, fill = Var1)) +</span></span>
<span id="cb88-832"><a href="#cb88-832"></a><span class="in">    geom_bar(stat = "identity") +</span></span>
<span id="cb88-833"><a href="#cb88-833"></a><span class="in">    facet_wrap(~ Var2) + </span></span>
<span id="cb88-834"><a href="#cb88-834"></a><span class="in">    labs(y = "loadings", x = "original features", fill = "original features") +</span></span>
<span id="cb88-835"><a href="#cb88-835"></a><span class="in">    theme(legend.position = "none") +</span></span>
<span id="cb88-836"><a href="#cb88-836"></a><span class="in">  theme(axis.text.x = element_text(angle = 90, hjust = 1)) </span></span>
<span id="cb88-837"><a href="#cb88-837"></a><span class="in">```</span></span>
<span id="cb88-838"><a href="#cb88-838"></a></span>
<span id="cb88-839"><a href="#cb88-839"></a><span class="in">```{r, fig.width=7, fig.height=7}</span></span>
<span id="cb88-840"><a href="#cb88-840"></a><span class="in"># Loadings plot for first 2 PCs</span></span>
<span id="cb88-841"><a href="#cb88-841"></a><span class="in">fviz_pca_var(pca_results, repel = TRUE)</span></span>
<span id="cb88-842"><a href="#cb88-842"></a></span>
<span id="cb88-843"><a href="#cb88-843"></a><span class="in"># Numerical summaries: Measure information captured by each PC</span></span>
<span id="cb88-844"><a href="#cb88-844"></a><span class="in">pca_results %&gt;% </span></span>
<span id="cb88-845"><a href="#cb88-845"></a><span class="in">  tidy(matrix = "eigenvalues")</span></span>
<span id="cb88-846"><a href="#cb88-846"></a><span class="in">```</span></span>
<span id="cb88-847"><a href="#cb88-847"></a></span>
<span id="cb88-850"><a href="#cb88-850"></a><span class="in">```{r}</span></span>
<span id="cb88-851"><a href="#cb88-851"></a><span class="co"># Graphical summary 1: SCREE PLOT</span></span>
<span id="cb88-852"><a href="#cb88-852"></a><span class="co"># Plot % of variance explained by each PC</span></span>
<span id="cb88-853"><a href="#cb88-853"></a>pca_results <span class="sc">%&gt;%</span> </span>
<span id="cb88-854"><a href="#cb88-854"></a>  <span class="fu">tidy</span>(<span class="at">matrix =</span> <span class="st">"eigenvalues"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb88-855"><a href="#cb88-855"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> percent, <span class="at">x =</span> PC)) <span class="sc">+</span> </span>
<span id="cb88-856"><a href="#cb88-856"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb88-857"><a href="#cb88-857"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb88-858"><a href="#cb88-858"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"% of variance explained"</span>)</span>
<span id="cb88-859"><a href="#cb88-859"></a></span>
<span id="cb88-860"><a href="#cb88-860"></a><span class="co"># Graphical summary 2: Plot cumulative % of variance explained by each PC</span></span>
<span id="cb88-861"><a href="#cb88-861"></a>pca_results <span class="sc">%&gt;%</span> </span>
<span id="cb88-862"><a href="#cb88-862"></a>  <span class="fu">tidy</span>(<span class="at">matrix =</span> <span class="st">"eigenvalues"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb88-863"><a href="#cb88-863"></a>  <span class="fu">rbind</span>(<span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb88-864"><a href="#cb88-864"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> cumulative, <span class="at">x =</span> PC)) <span class="sc">+</span> </span>
<span id="cb88-865"><a href="#cb88-865"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb88-866"><a href="#cb88-866"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb88-867"><a href="#cb88-867"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"CUMULATIVE % of variance explained"</span>)</span>
<span id="cb88-868"><a href="#cb88-868"></a></span>
<span id="cb88-869"><a href="#cb88-869"></a><span class="co"># Numerical summary: check out the scores</span></span>
<span id="cb88-870"><a href="#cb88-870"></a><span class="co"># pca_results %&gt;% </span></span>
<span id="cb88-871"><a href="#cb88-871"></a><span class="co">#  pluck("x")</span></span>
<span id="cb88-872"><a href="#cb88-872"></a><span class="in">```</span></span>
<span id="cb88-873"><a href="#cb88-873"></a></span>
<span id="cb88-874"><a href="#cb88-874"></a><span class="in">```{r, fig.width=7, fig.height=7}</span></span>
<span id="cb88-875"><a href="#cb88-875"></a><span class="in"># Graphical summary: Score plot</span></span>
<span id="cb88-876"><a href="#cb88-876"></a><span class="in"># Plot PC1 scores (x-axis) vs PC2 scores (y-axis) of all data points</span></span>
<span id="cb88-877"><a href="#cb88-877"></a><span class="in">fviz_pca_ind(</span></span>
<span id="cb88-878"><a href="#cb88-878"></a><span class="in">  pca_results, </span></span>
<span id="cb88-879"><a href="#cb88-879"></a><span class="in">  repel = TRUE, </span></span>
<span id="cb88-880"><a href="#cb88-880"></a><span class="in">  label = "none",</span></span>
<span id="cb88-881"><a href="#cb88-881"></a><span class="in">  col.ind = PCA_player$avg_PIE, </span></span>
<span id="cb88-882"><a href="#cb88-882"></a><span class="in">  gradient.cols = c("lightyellow", "red"),</span></span>
<span id="cb88-883"><a href="#cb88-883"></a><span class="in">  legend.title = "Average PIE",</span></span>
<span id="cb88-884"><a href="#cb88-884"></a><span class="in">  title = "PCA Score Plot"</span></span>
<span id="cb88-885"><a href="#cb88-885"></a><span class="in">  )</span></span>
<span id="cb88-886"><a href="#cb88-886"></a></span>
<span id="cb88-887"><a href="#cb88-887"></a><span class="in">fviz_pca_ind(</span></span>
<span id="cb88-888"><a href="#cb88-888"></a><span class="in">  pca_results, </span></span>
<span id="cb88-889"><a href="#cb88-889"></a><span class="in">  repel = TRUE, </span></span>
<span id="cb88-890"><a href="#cb88-890"></a><span class="in">  label = "none",</span></span>
<span id="cb88-891"><a href="#cb88-891"></a><span class="in">  col.ind = PCA_player$wins, </span></span>
<span id="cb88-892"><a href="#cb88-892"></a><span class="in">  gradient.cols = c("lightyellow", "red"),</span></span>
<span id="cb88-893"><a href="#cb88-893"></a><span class="in">  legend.title = "Number of Wins",</span></span>
<span id="cb88-894"><a href="#cb88-894"></a><span class="in">  title = "PCA Score Plot"</span></span>
<span id="cb88-895"><a href="#cb88-895"></a><span class="in">  )</span></span>
<span id="cb88-896"><a href="#cb88-896"></a></span>
<span id="cb88-897"><a href="#cb88-897"></a><span class="in">fviz_pca_ind(</span></span>
<span id="cb88-898"><a href="#cb88-898"></a><span class="in">  pca_results, </span></span>
<span id="cb88-899"><a href="#cb88-899"></a><span class="in">  repel = TRUE, </span></span>
<span id="cb88-900"><a href="#cb88-900"></a><span class="in">  label = "none",</span></span>
<span id="cb88-901"><a href="#cb88-901"></a><span class="in">  habillage = factor(PCA_player$team_name),</span></span>
<span id="cb88-902"><a href="#cb88-902"></a><span class="in">  geom = "point",</span></span>
<span id="cb88-903"><a href="#cb88-903"></a><span class="in">  pointshape = 19,</span></span>
<span id="cb88-904"><a href="#cb88-904"></a><span class="in">  addEllipses = TRUE, </span></span>
<span id="cb88-905"><a href="#cb88-905"></a><span class="in">  ellipse.level=0.95,</span></span>
<span id="cb88-906"><a href="#cb88-906"></a><span class="in">  legend.title = "Team",</span></span>
<span id="cb88-907"><a href="#cb88-907"></a><span class="in">  title = "PCA Score Plot"</span></span>
<span id="cb88-908"><a href="#cb88-908"></a><span class="in">  )</span></span>
<span id="cb88-909"><a href="#cb88-909"></a></span>
<span id="cb88-910"><a href="#cb88-910"></a><span class="in">fviz_pca_ind(</span></span>
<span id="cb88-911"><a href="#cb88-911"></a><span class="in">  pca_results, </span></span>
<span id="cb88-912"><a href="#cb88-912"></a><span class="in">  repel = TRUE, </span></span>
<span id="cb88-913"><a href="#cb88-913"></a><span class="in">  label = "none",</span></span>
<span id="cb88-914"><a href="#cb88-914"></a><span class="in">  habillage = PCA_player$position,</span></span>
<span id="cb88-915"><a href="#cb88-915"></a><span class="in">  geom = "point",</span></span>
<span id="cb88-916"><a href="#cb88-916"></a><span class="in">  pointshape = 19,</span></span>
<span id="cb88-917"><a href="#cb88-917"></a><span class="in">  addEllipses = TRUE</span></span>
<span id="cb88-918"><a href="#cb88-918"></a><span class="in">  )</span></span>
<span id="cb88-919"><a href="#cb88-919"></a><span class="in">```</span></span>
<span id="cb88-920"><a href="#cb88-920"></a></span>
<span id="cb88-923"><a href="#cb88-923"></a><span class="in">```{r}</span></span>
<span id="cb88-924"><a href="#cb88-924"></a><span class="co"># K Means (from PCA)</span></span>
<span id="cb88-925"><a href="#cb88-925"></a>pca_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pca_results<span class="sc">$</span>x[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb88-926"><a href="#cb88-926"></a></span>
<span id="cb88-927"><a href="#cb88-927"></a><span class="fu">colnames</span>(pca_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"PC1"</span>, <span class="st">"PC2"</span>)</span>
<span id="cb88-928"><a href="#cb88-928"></a></span>
<span id="cb88-929"><a href="#cb88-929"></a><span class="fu">set.seed</span>(<span class="dv">212</span>)</span>
<span id="cb88-930"><a href="#cb88-930"></a>kmeans_pca_model <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(<span class="fu">scale</span>(pca_df), <span class="at">centers =</span> <span class="dv">4</span>)</span>
<span id="cb88-931"><a href="#cb88-931"></a></span>
<span id="cb88-932"><a href="#cb88-932"></a>pca_df <span class="sc">%&gt;%</span> </span>
<span id="cb88-933"><a href="#cb88-933"></a>  <span class="fu">mutate</span>(<span class="at">kmeans_cluster =</span> <span class="fu">as.factor</span>(kmeans_pca_model<span class="sc">$</span>cluster)) <span class="sc">%&gt;%</span></span>
<span id="cb88-934"><a href="#cb88-934"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PC1, <span class="at">y =</span> PC2, <span class="at">color =</span> kmeans_cluster)) <span class="sc">+</span> </span>
<span id="cb88-935"><a href="#cb88-935"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb88-936"><a href="#cb88-936"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb88-937"><a href="#cb88-937"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"K-means with K = 3 (round 2)"</span>) <span class="sc">+</span> </span>
<span id="cb88-938"><a href="#cb88-938"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb88-939"><a href="#cb88-939"></a></span>
<span id="cb88-940"><a href="#cb88-940"></a>k_means_pca_cluster <span class="ot">&lt;-</span> pca_df <span class="sc">%&gt;%</span> </span>
<span id="cb88-941"><a href="#cb88-941"></a>  <span class="fu">mutate</span>(<span class="at">kmean_cluster_k =</span> <span class="fu">as.factor</span>(kmeans_pca_model<span class="sc">$</span>cluster)) <span class="sc">%&gt;%</span></span>
<span id="cb88-942"><a href="#cb88-942"></a>  <span class="fu">group_by</span>(kmean_cluster_k) <span class="sc">%&gt;%</span></span>
<span id="cb88-943"><a href="#cb88-943"></a>  <span class="fu">summarise_all</span>(mean)</span>
<span id="cb88-944"><a href="#cb88-944"></a></span>
<span id="cb88-945"><a href="#cb88-945"></a><span class="fu">head</span>(k_means_pca_cluster)</span>
<span id="cb88-946"><a href="#cb88-946"></a></span>
<span id="cb88-947"><a href="#cb88-947"></a><span class="co"># Get the "the total within- cluster sum of squares"</span></span>
<span id="cb88-948"><a href="#cb88-948"></a><span class="co"># This is the total squared distance of each case from its assigned centroid</span></span>
<span id="cb88-949"><a href="#cb88-949"></a>kmeans_pca_model<span class="sc">$</span>tot.withinss</span>
<span id="cb88-950"><a href="#cb88-950"></a></span>
<span id="cb88-951"><a href="#cb88-951"></a><span class="in">```</span></span>
<span id="cb88-952"><a href="#cb88-952"></a></span>
<span id="cb88-955"><a href="#cb88-955"></a><span class="in">```{r}</span></span>
<span id="cb88-956"><a href="#cb88-956"></a><span class="co"># K Means (OG data)</span></span>
<span id="cb88-957"><a href="#cb88-957"></a><span class="fu">set.seed</span>(<span class="dv">212</span>)</span>
<span id="cb88-958"><a href="#cb88-958"></a>kmeans_model <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(<span class="fu">scale</span>(PCA_player_dummy), <span class="at">centers =</span> <span class="dv">4</span>)</span>
<span id="cb88-959"><a href="#cb88-959"></a></span>
<span id="cb88-960"><a href="#cb88-960"></a>k_means_cluster <span class="ot">&lt;-</span> PCA_player_dummy <span class="sc">%&gt;%</span> </span>
<span id="cb88-961"><a href="#cb88-961"></a>  <span class="fu">mutate</span>(<span class="at">kmean_cluster_k =</span> <span class="fu">as.factor</span>(kmeans_model<span class="sc">$</span>cluster)) <span class="sc">%&gt;%</span></span>
<span id="cb88-962"><a href="#cb88-962"></a>  <span class="fu">group_by</span>(kmean_cluster_k) <span class="sc">%&gt;%</span></span>
<span id="cb88-963"><a href="#cb88-963"></a>  <span class="fu">summarise_all</span>(mean)</span>
<span id="cb88-964"><a href="#cb88-964"></a></span>
<span id="cb88-965"><a href="#cb88-965"></a><span class="fu">head</span>(k_means_cluster)</span>
<span id="cb88-966"><a href="#cb88-966"></a></span>
<span id="cb88-967"><a href="#cb88-967"></a><span class="co"># Get the "the total within- cluster sum of squares"</span></span>
<span id="cb88-968"><a href="#cb88-968"></a><span class="co"># This is the total squared distance of each case from its assigned centroid</span></span>
<span id="cb88-969"><a href="#cb88-969"></a>kmeans_model<span class="sc">$</span>tot.withinss</span>
<span id="cb88-970"><a href="#cb88-970"></a></span>
<span id="cb88-971"><a href="#cb88-971"></a>cluster_data <span class="ot">&lt;-</span> PCA_player_dummy <span class="sc">%&gt;%</span> </span>
<span id="cb88-972"><a href="#cb88-972"></a>  <span class="fu">mutate</span>(<span class="at">kmeans_cluster =</span> kmeans_model<span class="sc">$</span>cluster) <span class="sc">%&gt;%</span></span>
<span id="cb88-973"><a href="#cb88-973"></a>  <span class="fu">mutate</span>(<span class="at">kmeans_cluster =</span> <span class="fu">as.factor</span>(kmeans_model<span class="sc">$</span>cluster))</span>
<span id="cb88-974"><a href="#cb88-974"></a></span>
<span id="cb88-975"><a href="#cb88-975"></a>PCA_player_dummy <span class="sc">%&gt;%</span> </span>
<span id="cb88-976"><a href="#cb88-976"></a>  <span class="fu">mutate</span>(<span class="at">kmeans_cluster =</span> <span class="fu">as.factor</span>(kmeans_model<span class="sc">$</span>cluster)) <span class="sc">%&gt;%</span></span>
<span id="cb88-977"><a href="#cb88-977"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> avg_PIE, <span class="at">y =</span> salary, <span class="at">color =</span> kmeans_cluster)) <span class="sc">+</span> </span>
<span id="cb88-978"><a href="#cb88-978"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb88-979"><a href="#cb88-979"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb88-980"><a href="#cb88-980"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"K-mean"</span>) <span class="sc">+</span> </span>
<span id="cb88-981"><a href="#cb88-981"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb88-982"><a href="#cb88-982"></a></span>
<span id="cb88-983"><a href="#cb88-983"></a><span class="fu">ggplot</span>(cluster_data, <span class="fu">aes</span>(<span class="at">x =</span> avg_PIE, <span class="at">y =</span> salary, <span class="at">color =</span> kmeans_cluster)) <span class="sc">+</span> </span>
<span id="cb88-984"><a href="#cb88-984"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb88-985"><a href="#cb88-985"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb88-986"><a href="#cb88-986"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"K-means results"</span>) <span class="sc">+</span> </span>
<span id="cb88-987"><a href="#cb88-987"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb88-988"><a href="#cb88-988"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">

<div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>